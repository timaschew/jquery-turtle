!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.$||(t.$={})).turtle=e()}}(function(){return function e(t,n,r){function a(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return a(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){t.exports=function(e,t){function n(t,n){if(Fa>5)Da.push({elem:t,qname:n});else{for(Fa+=1,e.dequeue(t,n);Da.length>0;){var r=Da.shift();e.dequeue(r.elem,r.qname),Gn()}Fa-=1}}function r(e,t){function n(){this.constructor=e}for(var r in t)Ea.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e}function a(t){var n,r,a=t.charAt(0).toUpperCase()+t.slice(1),i=["Moz","Webkit","O","ms"],o=document.createElement("div");if(t in o.style)r=t;else for(var s=0;s<i.length;s++)if(n=i[s]+a,n in o.style){r=n;break}return o=null,e.support[t]=r,r}function i(){var e=document.createElement("div"),t="getBoundingClientRect"in e;return e=null,t}function o(t,n){function r(){for(;p.length&&/^\s/.test(p[p.length-1]);)p.pop();for(;p.length&&/^\s/.test(p[0]);)p.shift();1==p.length&&(/^".*"$/.test(p[0])||/^'.*'$/.test(p[0]))?o=p[0].substr(1,p[0].length-2):2==p.length&&"url"==p[0]&&/^(.*)$/.test(p[1])?o=p[1].substr(1,p[1].length-2):(s=p.join(""),o=""==s?s:isNaN(s)?s:Number(s)),!h&&f&&n&&p.length&&(c=n),c&&(u[c]=o)}if("string"!=typeof t){if(null==t)return{};if(e.isPlainObject(t))return t;t=""+t}var a,i,o,s,l=t.match(/[-a-zA-Z_][-\w]*|"[^"]*"|'[^']'|\([^()]*\)|\s+|./g),u={},c=null,h=!1,p=[],f=!0;for(a=0;a<l.length;++a)i=l[a],h||(!c&&/^[a-zA-Z_-]/.test(i)&&(c=i),":"!=i)?";"!=i?p.push(i):(r(),c=null,p.length=0,h=!1,f=!1):(h=!0,p.length=0);return r(),u}function s(e){function t(e){return/[\s;]/.test(e)?e.indexOf('"')<0?'"'+e+'"':"'"+e+"'":e}var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push(r+":"+t(e[r])+";");return n.join(" ")}function l(e){return e}function u(e,t){var n=[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]];return 6==e.length&&(n[0]+=e[4],n[1]+=e[5]),n}function c(e,t){var n=[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3]],r=6==e.length;return 6==t.length?(n.push(e[0]*t[4]+e[2]*t[5]+(r?e[4]:0)),n.push(e[1]*t[4]+e[3]*t[5]+(r?e[5]:0))):r&&(n.push(e[4]),n.push(e[5])),n}function h(e){return Math.abs(e)>1e-12}function p(e){return!(h(e[1])||h(e[2])||h(1-e[0])||h(1-e[3]))}function f(e){if(p(e))return[1,0,0,1];var t=w(e);return h(t[2])?c(g(-t[3]),c(m(1/t[1],1/t[2]),g(-t[0]))):null}function d(e){var t=f(e);if(4==e.length)return t;var n=u(t,[-e[4],-e[5]]);return t.push(n[0]),t.push(n[1]),t}function g(e){var t=Math.cos(e),n=Math.sin(e);return[t,n,-n,t]}function m(e,t){return 1==arguments.length&&(e=t),[e,0,0,t]}function v(e,t){return[e[0]+t[0],e[1]+t[1]]}function y(e,t){return[e[0]-t[0],e[1]-t[1]]}function b(e,t){return[e[0]*t,e[1]*t]}function k(e,t,n){return v(u(e,y(t,n)),n)}function w(e){var t,n,r=e[0]*e[0]+e[1]*e[1],a=e[0]*e[2]+e[1]*e[3],i=e[2]*e[2]+e[3]*e[3],o=-.5*Math.atan2(2*a,r-i),s=Math.cos(o),l=Math.sin(o),u=e[0]*s-e[2]*l,c=e[1]*s-e[3]*l,h=Math.atan2(c,u),p=Math.cos(h),f=Math.sin(h),d=(e[1]*l+e[3]*s)*p-(e[0]*l+e[2]*s)*f,g=(e[0]*s-e[2]*l)*p+(e[1]*s-e[3]*l)*f;return o<-Math.PI/4?(o+=Math.PI/2,n=g,t=d,h-=Math.PI/2):(t=g,n=d),h>Math.PI&&(h-=2*Math.PI),[h,t,n,o]}function x(e,t){var n=(t-e)/2,r=Math.cos(n),a=Math.sin(n),i=r,o=-a,s=1+i*r+o*a,l=i*a-o*r,u=l&&4/3*(Math.sqrt(2*s)-s)/l,c=i-u*o,h=o+u*i,p=c,f=-h,d=n+e,g=Math.cos(d),m=Math.sin(d);return[[c*g-h*m,c*m+h*g],[p*g-f*m,p*m+f*g],[Math.cos(t),Math.sin(t)]]}function M(e){var t=ye(e,!1);if(t)return[t.tx,t.ty];var n=T(e);return n?[n[4],n[5]]:[0,0]}function T(n){var r=t.getComputedStyle?t.getComputedStyle(n)[La]:e.css(n,"transform");if(!r||"none"===r)return null;var a=/^matrix\(([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+)(?:px)?,\s*([\-+.\de]+)(?:px)?\)$/.exec(r);return a?[parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4]),parseFloat(a[5]),parseFloat(a[6])]:A(r)}function _(n,r){var a,i,o,s="none"===e.css(n,"display");if(s){a={position:"absolute",visibility:"hidden",display:"block"},i={};for(o in a)i[o]=n.style[o],n.style[o]=a[o]}var l=t.getComputedStyle?t.getComputedStyle(n):null;if(s)for(o in a)n.style[o]=i[o];var u=l&&l[Wa]||e.css(n,"transformOrigin");if(u&&u.indexOf("%")<0)return e.map(u.split(" "),parseFloat);if(r)return[r[0]/2,r[1]/2];var c=e(n);return[c.width()/2,c.height()/2]}function S(e){for(var t,n=[1,0,0,1];null!==e;)t=T(e),t&&!p(t)&&(n=c(t,n)),e=e.parentElement;return n.slice(0,4)}function A(t){var n=[1,0,0,1],r=[],a=[],i=/(?:^\s*|)(\w*)\s*\(([^)]*)\)\s*/g,o=t.replace(i,function(t){return r.push(t[1].toLowerCase()),a.push(e.map(t[2].split(","),function(e){var t=e.trim().toLowerCase();return{num:parseFloat(t),unit:t.replace(/^[+-.\de]*/,"")}})),""});if(o)return null;for(var s=r.length-1;s>=0;--s){var l,u,h,p=null,f=r[s],d=a[s];if("matrix"==f)d.length>=6&&(p=[d[0].num,d[1].num,d[2].num,d[3].num,d[4].num,d[5].num]);else if("rotate"==f)1==d.length&&(l=Me(d[0]),u=Math.cos(l),h=Math.sin(l),p=[u,-h,u,h]);else if("translate"==f||"translatex"==f||"translatey"==f){var g=0,m=0;if(d.length>=1){if(d[0].unit&&"px"!=d[0].unit)return null;if("translate"==f||"translatex"==f?g=d[0].num:"translatey"==f&&(m=d[0].num),"translate"==f&&d.length>=2){if(d[1].unit&&"px"!=d[1].unit)return null;m=d[1].num}p=[0,0,0,0,g,m]}}else if("scale"==f||"scalex"==f||"scaley"==f){var v=1,y=1;d.length>=1&&("scale"==f||"scalex"==f?v=d[0].num:"scaley"==f&&(y=d[0].num),"scale"==f&&d.length>=2&&(y=d[1].num),p=[v,0,0,y,0,0])}else{if("skew"!=f&&"skewx"!=f&&"skewy"!=f)return null;var b=0,k=0;d.length>=1&&("skew"==f||"skewx"==f?b=Math.tan(Me(d[0])):"skewy"==f&&(k=Math.tan(Me(d[0]))),"skew"==f&&d.length>=2&&(k=Math.tan(Me(d[0]))),p=[1,k,b,1,0,0])}n=c(n,p)}return n}function C(e,t,n){if(0>=n)return e;var r=t.pageX-e.pageX,a=t.pageY-e.pageY,i=r*r+a*a;if(n*n>=i)return t;var o=n/Math.sqrt(i);return{pageX:e.pageX+o*r,pageY:e.pageY+o*a}}function P(e,t,n){if(0>=n)t=e;else if(180>n){var r=Te(t-e);r>n?t=e+n:-n>r&&(t=e-n)}return Te(t)}function q(e,t,n,r){return{pageX:Math.floor(e+n/2),pageY:Math.floor(t+r/2)}}function X(e,t,n,r){var a=e+n,i=t+r;return[{pageX:e,pageY:t},{pageX:e,pageY:i},{pageX:a,pageY:i},{pageX:a,pageY:t}]}function Y(e){if(!/e[\-+]/.exec(e))return e;var t=e.replace(/(?:\d+(?:\.\d*)?|\.\d+)e[\-+]\d+/g,function(e){return be(parseFloat(e))});return t}function N(t,n,r){var a=e.data(t,"turtleData");if(a&&a.quickhomeorigin&&a.down&&a.style&&!r&&t.classList&&t.classList.contains("turtle"))return a.quickhomeorigin;var i,o,s,l="none"===e.css(t,"display"),u=l?{position:"absolute",visibility:"hidden",display:"block"}:{},c=(u[La]=n?"matrix("+e.map(n,be).join(", ")+", 0, 0)":"none",{});for(i in u)c[i]=t.style[i],t.style[i]=u[i];o=D(t),s=_(t,[o.width,o.height]);for(i in u)t.style[i]=Y(c[i]);r&&(r.gbcr=o,r.localorigin=s);var h=v([o.left,o.top],s);return a&&a.down&&a.style&&(a.quickhomeorigin=h),h}function O(){return t.innerHeight||e(t).height()}function E(){return t.innerWidth||e(t).width()}function j(){return document.body?e(document).height():document.height}function R(){return document.body?e(document).width():document.width}function I(e){return e.offsetHeight<=0&&e.offsetWidth<=0}function F(e,t,n,r){return{left:e,top:t,right:e+n,bottom:t+r,width:n,height:r}}function D(n){return ft(n)?F(n.pageX,n.pageY,0,0):e.isWindow(n)?F(e(t).scrollLeft(),e(t).scrollTop(),E(),O()):9===n.nodeType?F(0,0,R(),j()):"getBoundingClientRect"in n?B.apply(n):F(0,0,0,0)}function L(e,t,n){var r=Math.max(0,Math.max(n.top-e.pageY,e.pageY-n.bottom)),a=Math.max(0,Math.max(n.left-e.pageX,e.pageX-n.right));return a*a+r*r>t}function W(e,t,n){var r=Math.max(n.bottom-e.pageY,e.pageY-n.top),a=Math.max(n.right-e.pageX,e.pageX-n.left);return t>a*a+r*r}function H(e,t){return t.right<e.left||e.right<t.left||t.bottom<e.top||e.bottom<t.top}function z(e,t){return t.top>=e.top&&t.bottom<=e.bottom&&t.left>=e.left&&t.right<=e.right}function $(e,t){return 4===e.length&&e[0].pageX===t.left&&e[0].pageY===t.top&&e[1].pageX===t.left&&e[1].pageY===t.bottom&&e[2].pageX===t.right&&e[2].pageY===t.bottom&&e[3].pageX===t.right&&e[3].pageY===t.top}function B(){var e=this.getBoundingClientRect();return{top:e.top+t.pageYOffset,bottom:e.bottom+t.pageYOffset,left:e.left+t.pageXOffset,right:e.right+t.pageXOffset,width:e.width,height:e.height}}function Q(t,n,r,a,i){var o,s,l,c,h=S(t.parentElement),p=f(h),d=N(t,p);if(p){if(e.isNumeric(r)&&(l=M(t),o=v(u(h,l),d),s={pageX:o[0],pageY:o[1]},n=C(s,n,r)),c=u(p,y([n.pageX,n.pageY],d)),a||i){var g=On(t);c[0]+=a*g,c[1]-=i*g}return be(c[0])+" "+be(c[1])}}function U(e){var t=e.offsetParent;return t?t:document}function G(t,n){n||(n=e(U(t)).pagexy());var r=S(t.parentElement),a=f(r),i=N(t,a),o=ye(t,!0),s=a&&u(a,y([n.pageX,n.pageY],i)),l=1/On(t);if(a)return[(o.tx-s[0])*l,(s[1]-o.ty)*l]}function V(t,n){var r,a,i=S(t.parentElement),o=(ye(t,!0),e(U(t)).pagexy()),s=On(t),l=[];for(a=0;a<n.length;a++)r=u(i,[n[a][0]*s,-n[a][1]*s]),l.push({pageX:o.pageX+r[0],pageY:o.pageY+r[1]});return l}function Z(n){if(e.isWindow(n))return q(e(t).scrollLeft(),e(t).scrollTop(),E(),O());if(9===n.nodeType||n==document.body)return q(0,0,R(),j());var r=Le(n);if(r&&r.quickpagexy&&r.down&&r.style)return r.quickpagexy;var a=M(n),i=S(n.parentElement),o=p(i),s=o?null:f(i),l=N(n,s),c=v(u(i,a),l),h={pageX:c[0],pageY:c[1]};return r&&o&&r.down&&r.style&&n.classList&&n.classList.contains("turtle")&&(r.quickpagexy=h),h}function J(t){"CANVAS"!=t.tagName&&"IMG"!=t.tagName&&e(t).find(".turtle").each(function(t,n){var r=e.data(n,"turtleData");r&&(r.quickpagexy=null,r.quickhomeorigin=null)})}function K(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;++r)n.push([e[r].pageX+t[0],e[r].pageY+t[1]]);return n}function ee(n,r){if(e.isWindow(n))return X(e(t).scrollLeft(),e(t).scrollTop(),E(),O());if(9===n.nodeType)return X(0,0,R(),j());var a=T(n)||[1,0,0,1],i=S(n.parentElement),o=c(i,a),s=f(i),l={},u=N(n,s,l),h=l.gbcr,p=K(Le(n).hull,u)||[[h.left,h.top],[h.left,h.bottom],[h.right,h.bottom],[h.right,h.top]];return r?e.map(p,function(e){return{pageX:e[0]-u[0],pageY:e[1]-u[1]}}):e.map(p,function(e){var t=k(o,e,u);return{pageX:t[0],pageY:t[1]}})}function te(e){var t=ye(e,!0),n=Me(Te(t.rot)),r=Math.sin(n),a=Math.cos(n),i=S(e.parentElement),o=u(i,[r,a]),s=Math.atan2(o[0],o[1]);return xe(s)}function ne(n,r){var a=n.pageX,i=n.pageY,o=E()/2,s=O()/2,l=e("body"),u=l.width(),c=l.height(),h=e(t);a>u-o&&(a=u-o),o>a&&(a=o),i>c-s&&(i=c-s),s>i&&(i=s);var p={pageX:a,pageY:i};e.isNumeric(r)&&(p=C(h.origin(),p,r)),h.scrollLeft(p.pageX-o),h.scrollTop(p.pageY-s)}function re(e,t,n){var r=t.pageX-e.pageX,a=t.pageY-e.pageY,i=n.pageX-e.pageX,o=n.pageY-e.pageY;return i*a-r*o}function ae(e,t,n){var r=n.pageX-e.pageX,a=n.pageY-e.pageY;return r*t.pageY-t.pageX*a}function ie(e,t){if(t.length<=0)return!1;if(1==t.length)return t[0].pageX==e.pageX&&t[0].pageY==e.pageY;var n=re(e,t[t.length-1],t[0]);if(0===n)return!0;var r=n>0;if(2==t.length)return!1;for(var a=1;a<t.length;++a){var i=re(e,t[a-1],t[a]);if(0===i)return!0;if(i>0!=r)return!1}return!0}function oe(e,t){return{pageX:e.pageX-t.pageX,pageY:e.pageY-t.pageY}}function se(e,t,n,r){var a,i,o=oe(n,t);for(a=0;a<r.length;++a)if(i=le(ae(t,o,r[a])),!i||i===e)return!1;return!0}function le(e){return e>0?1:0>e?-1:0}function ue(e){if(e.length<=2)return 0;var t=re(e[e.length-1],e[0],e[1]);if(0!==t)return le(t);for(var n=1;n<e.length;++n)if(t=re(e[n-1],e[n],e[(n+1)%e.length]),0!==t)return le(t);return 0}function ce(e,t){var n,r=ue(e);for(n=0;n<e.length;++n)if(se(r,e[n],e[(n+1)%e.length],t))return!1;for(r=ue(t),n=0;n<t.length;++n)if(se(r,t[n],t[(n+1)%t.length],e))return!1;return!0}function he(e,t){for(var n=0;n<t.length;++n)if(!ie(t[n],e))return!1;return!0}function pe(e){function t(e,t){if(!t||!ft(t))return e;for(;e.length>1&&1!=le(re(e[e.length-2],e[e.length-1],t));)e.pop();return e.length&&r(e[e.length-1],t)||e.push(t),e}function n(e,t,n){for(var r=0;r<e.length;++r)t=n(t,e[r]);return t}function r(e,t){return e.pageX===t.pageX&&e.pageY===t.pageY}function a(e,t){return e.pageX<t.pageX?-1:e.pageX>t.pageX?1:e.pageY<t.pageY?-1:e.pageY>t.pageY?1:0}e.sort(a);var i=n(e,[],t),o=n(e.reverse(),[],t);return i.concat(o.slice(1,-1))}function fe(t){if(!t)return null;if(e.isArray(t))return t;for(var n=e.map(t.trim().split(/\s+/),parseFloat),r=[],a=0;a+1<n.length;)r.push({pageX:n[a],pageY:n[a+1]}),a+=2;return r}function de(t){for(var n=0,r=[];n<t.length;++n)r.push(t[n].pageX,t[n].pageY);return r.length?e.map(r,be).join(" "):"none"}function ge(){return{get:function(e,t,n){var r=Le(e).hull;return de(r||ee(e,!0))},set:function(e,t){var n=t&&"auto"!=t?"none"==t?[]:pe(fe(t)):null;Le(e).hull=n}}}function me(e){if("none"===e)return{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0};var t=/^(?:translate\(([\-+.\de]+)(?:px)?,\s*([\-+.\de]+)(?:px)?\)\s*)?(?:rotate\(([\-+.\de]+)(?:deg)?\)\s*)?(?:scale\(([\-+.\de]+)(?:,\s*([\-+.\de]+))?\)\s*)?(?:rotate\(([\-+.\de]+)(?:deg)?\)\s*)?$/.exec(e);if(!t)return null;var n=t[1]?parseFloat(t[1]):0,r=t[2]?parseFloat(t[2]):0,a=t[3]?parseFloat(t[3]):0,i=t[4]?parseFloat(t[4]):1,o=t[5]?parseFloat(t[5]):i,s=t[6]?parseFloat(t[6]):0;return{tx:n,ty:r,rot:a,sx:i,sy:o,twi:s}}function ve(e){var t,n=T(e);return n?(t=w(n),{tx:n[4],ty:n[5],rot:xe(t[0]),sx:t[1],sy:t[2],twi:xe(t[3])}):{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0}}function ye(e,t){return me(e.style[La])||t&&ve(e)}function be(e){var t=e.toString();return~t.indexOf("e")&&(t=Number(e).toFixed(17)),t}function ke(e){var t=[];return(h(e.tx)||h(e.ty))&&t.push("translate("+be(e.tx)+"px, "+be(e.ty)+"px)"),(h(e.rot)||h(e.twi))&&t.push("rotate("+be(e.rot)+"deg)"),(h(1-e.sx)||h(1-e.sy))&&(h(e.sx-e.sy)?t.push("scale("+be(e.sx)+", "+be(e.sy)+")"):t.push("scale("+be(e.sx)+")")),h(e.twi)&&t.push("rotate("+be(e.twi)+"deg)"),t.length?t.join(" "):"none"}function we(e,t){return(+e%(t=+t)+t)%t}function xe(e){var t=180*e/Math.PI;return t>180&&(t-=360),t}function Me(e){return e/180*Math.PI}function Te(e){return Math.abs(e)>180&&(e%=360,e>180?e-=360:-180>=e&&(e+=360)),e}function _e(e){return Math.abs(e)>=720&&(e=e%360+(e>0?360:-360)),e}function Se(){return Ha.field||Ce(),Ha.field}function Ae(){return Ha.surface||Ce(),Ha.surface}function Ce(){var t=document.createElement("samp"),n=document.createElement("samp"),r=Math.floor(E()/2),a=Math.floor(O()/2);e(t).css({position:"absolute",display:"inline-block",top:0,left:0,width:"100%",height:"100%",font:"inherit",zIndex:-1,transformOrigin:r+"px "+a+"px",pointerEvents:"none",overflow:"hidden"}).addClass("turtlefield"),e(n).attr("id","origin").css({position:"absolute",display:"inline-block",top:a,left:r,width:"100%",height:"0",font:"inherit",transformOrigin:"0px 0px",pointerEvents:"all",turtleSpeed:1/0}).appendTo(t),Ha.surface=t,Ha.field=n,Pe(),$t()}function Pe(){document.body?(null==e("html").attr("style")&&e("html").css("min-height","100%"),e(Ha.surface).prependTo("body"),zt()):e(document).ready(Pe)}function qe(e){return e.drawOnCanvas||(e.drawOnCanvas=Ye()),e.drawOnCanvas}function Xe(t){var n=e.data(t,"turtleData");return n?n.drawOnCanvas?n.drawOnCanvas:Ha.canvas:null}function Ye(){if(Ha.canvas)return Ha.canvas;var n=Ae();return Ha.canvas=document.createElement("canvas"),e(Ha.canvas).css({"z-index":-1}),n.insertBefore(Ha.canvas,n.firstChild),je(),Oe(je),e(t).resize(je),Ha.canvas}function Ne(e,t){return Ha.offscreen&&Ha.offscreen.width===e&&Ha.offscreen.height===t?(Ha.offscreen.getContext("2d").clearRect(0,0,e,t),Ha.offscreen):(Ha.offscreen||(Ha.offscreen=document.createElement("canvas")),Ha.offscreen.width=e,Ha.offscreen.height=t,Ha.offscreen)}function Oe(t){var n=e("body"),r=n.width(),a=n.height(),i=function(){(n.width()!=r||n.height()!=a)&&(t(),r=n.width(),a=n.height())};Ha.timer&&clearInterval(Ha.timer),Ha.timer=setInterval(i,250)}function Ee(){var n=e("body");return[Math.max(n.outerWidth(!0),t.innerWidth||e(t).width()),Math.max(n.outerHeight(!0),t.innerHeight||e(t).height())]}function je(){if(Ha.canvas){var t,n=Ee(),r=n[0],a=n[1],i=Ha.canvas.width,o=Ha.canvas.height,s=Math.max(Math.min(2e3,Math.max(200,i)),100*Math.ceil(r/100))*Ha.subpixel,l=Math.max(Math.min(2e3,Math.max(200,i)),100*Math.ceil(a/100))*Ha.subpixel;e(Ha.surface).css({width:r+"px",height:a+"px"}),(i!=s||o!=l)&&(t=document.createElement("canvas"),t.width=Math.min(i,s),t.height=Math.min(o,l),t.getContext("2d").drawImage(Ha.canvas,0,0),Ha.canvas.width=s,Ha.canvas.height=l,Ha.canvas.getContext("2d").drawImage(t,0,0),e(Ha.canvas).css({width:s/Ha.subpixel,height:l/Ha.subpixel}))}}function Re(e,t){if(!e)return null;if(e&&"function"==typeof e&&(e.helpname||e.name)&&(e=e.helpname||e.name),e=String(e),e.trim&&(e=e.trim()),!e||"none"===e)return null;if("path"===e||"fill"===e)return{savePath:!0};var n=!1;/^erase\b/.test(e)&&(e=e.replace(/^erase\b/,"white; globalCompositeOperation:destination-out"),n=!0);var r=o(e,t);return n&&(r.eraseMode=!0),r}function Ie(e){return e?s(e):"none"}function Fe(e){return"down"==e||e===!0?!0:"up"==e||e===!1?!1:void 0}function De(e){return e?"down":"up"}function Le(t){var n=e.data(t,"turtleData");return n||(n=e.data(t,"turtleData",{style:null,corners:[[]],path:[[]],down:!1,speed:"turtle",easing:"swing",turningRadius:0,drawOnCanvas:null,quickpagexy:null,quickhomeorigin:null,oldscale:1,instrument:null,stream:null})),n}function We(t){var n=e.data(t,"turtleData");return n?n.turningRadius:0}function He(){return{get:function(e,t,n){return be(We(e))+"px"},set:function(e,t){var n=parseFloat(t);if(!isNaN(n)&&(Le(e).turningRadius=n,e.style.turtleTurningRadius=""+be(n)+"px",0===n)){var r=ye(e,!1);r&&(r.rot>180||r.rot<=-180)&&(r.rot=Te(r.rot),e.style[La]=ke(r))}}}}function ze(){return{get:function(e,t,n){return Ie(Le(e).style)},set:function(e,t){var n=Re(t,"strokeStyle"),r=Le(e);r.style&&(r.style=null,nt(e,r,!0)),r.style=n,e.style.turtlePenStyle=Ie(n),nt(e,r,!0)}}}function $e(){return{get:function(e,t,n){return De(Le(e).down)},set:function(e,t){var n=Fe(t);if(void 0!==n){var r=Le(e);n!=r.down&&(r.down=n,r.quickpagexy=null,r.quickhomeorigin=null,e.style.turtlePenDown=De(n),nt(e,r,!0))}}}}function Be(e,t){return 0===Math.round(e.pageX-t.pageX)&&0===Math.round(e.pageY-t.pageY)}function Qe(e,t){return 0===Math.round(1e3*(e.pageX-t.pageX))&&0===Math.round(1e3*(e.pageY-t.pageY))}function Ue(e,t){return Be(e,t)&&0===Math.round(e.pageX-t.pageX1)&&0===Math.round(e.pageY-t.pageY1)&&0===Math.round(t.pageX2-t.pageX)&&0===Math.round(t.pageY2-t.pageY)}function Ge(e){var t=1e3*e,n=Math.round(t);return Math.abs(n-t)<Math.abs(5e-15*t)?n/1e3:e}function Ve(e,t,n){n=n||1;var r=t.eraseMode?1:0;if(t&&"strokeStyle"in t||(e.strokeStyle="black"),t&&"lineWidth"in t||(e.lineWidth=1.62*n+r),t&&"lineCap"in t||(e.lineCap="round"),t&&"lineJoin"in t||(e.lineJoin="round"),t)for(var a in t)"savePath"!==a&&"eraseMode"!==a&&(n&&"lineWidth"===a?e[a]=n*t[a]+r:"lineDash"===a?e.setLineDash((""+t[a]).split(/[,\s]/g)):e[a]=t[a])}function Ze(e){if(e){if(e===Ha.canvas)return[Ha.subpixel,0,0,Ha.subpixel];var t,n=S(e.parentElement),r=f(n),a={},i=N(e,r,a),o=a.gbcr,s=[1,0,0,1,-i[0],-i[1]],l=o.width&&o.height&&[e.width/o.width,0,0,e.height/o.height],u=T(e)||[1,0,0,1],h=d(u);if(r&&h&&l)return t=c(c(c(l,h),r),s),t[4]+=a.localorigin[0]*l[0],t[5]+=a.localorigin[1]*l[3],t}}function Je(e,t){if(t===Ha.canvas)e.setTransform(Ha.subpixel,0,0,Ha.subpixel,0,0);else{var n=Ze(t);n&&e.setTransform.apply(e,n)}}function Ke(e,t,n,r,a){var i,o,s,l=e.getContext("2d"),u=t.length;for(l.save(),Je(l,e),l.beginPath(),Ve(l,n,r);u--;)if(t[u].length>1){s=t[u],i=s.length>2&&Be(s[0],s[s.length-1])&&!Be(s[0],s[Math.floor(s.length/2)]),o=i&&!("pageX2"in s[s.length-1]);var c=s[0].pageX,h=s[0].pageY;l.moveTo(c,h);for(var p=1;p<s.length-(o?1:0);++p)"pageX2"in s[p]&&!Ue(s[p-1],s[p])?l.bezierCurveTo(s[p].pageX1,s[p].pageY1,s[p].pageX2,s[p].pageY2,s[p].pageX,s[p].pageY):l.lineTo(s[p].pageX,s[p].pageY);i&&l.closePath()}"fillStyle"in n&&l.fill(),"strokeStyle"in n&&l.stroke(),l.restore(),t.length=1,t[0].splice(0,Math.max(0,t[0].length-a))}function et(e,t,n){e.length&&Be(t,e[e.length-1])||e.push(t);for(var r=0;r<n.length;++r)e.push({pageX1:n[r][0].pageX,pageY1:n[r][0].pageY,pageX2:n[r][1].pageX,pageY2:n[r][1].pageY,pageX:n[r][2].pageX,pageY:n[r][2].pageY})}function tt(e,t){e.length&&(t.corner?Qe(t,e[e.length-1]):Be(t,e[e.length-1]))||e.push(t)}function nt(e,t,n){if(J(e),t){var r=t.path,a=t.style,i=t.corners;if(!a||!t.down)return r.length>1&&(r.length=1),r[0].length&&(r[0].length=0),void(n&&(a?i.length&&i[0].length&&(1==i[0].length?i[0].length=0:i.unshift([])):(i.length>1&&(i.length=1),i[0].length&&(i[0].length=0))));if(n||!a.savePath){var o=Z(e);if(n&&(o.corner=!0,tt(i[0],o)),!a.savePath){tt(r[0],o);var s=In(e);Ke(qe(t),t.path,a,s,2)}}}}function rt(t,n){var r=Le(t);r.style&&(n=e.extend({},r.style,n));var a=In(t);Ke(qe(r),r.corners,n,a,1)}function at(t){if((!t||/\bcanvas\b/.test(t))&&Ha.canvas){var n=Ha.canvas.getContext("2d");n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,Ha.canvas.width,Ha.canvas.height),n.restore()}if((!t||/\bturtles\b/.test(t))&&Ha.surface){var r=e(Ha.surface).find(".turtle").not(".turtlefield");di&&(r=r.not(di)),r.remove()}if((!t||/\blabels\b/.test(t))&&Ha.surface){var r=e(Ha.surface).find(".turtlelabel").not(".turtlefield");r.remove()}(!t||/\btext\b/.test(t))&&e("body").contents().not(".turtlefield").remove()}function it(e,t){if(!e||e.length<1)return null;for(var n=1,r={left:Math.floor(e[0].pageX),top:Math.floor(e[0].pageY),right:Math.ceil(e[0].pageX),bottom:Math.ceil(e[0].pageY)};n<e.length;++n)r.left=Math.min(r.left,Math.floor(e[n].pageX)),r.top=Math.min(r.top,Math.floor(e[n].pageY)),r.right=Math.max(r.right,Math.ceil(e[n].pageX)),r.bottom=Math.max(r.bottom,Math.ceil(e[n].pageY));return t&&(r.left=Math.max(t.left,r.left),r.top=Math.max(t.top,r.top),r.right=Math.min(t.right,r.right),r.bottom=Math.min(t.bottom,r.bottom)),r}function ot(e,t){if(!e||!t)return null;if(4==e.length&&p(e))return t;var n,r,a=[];for(n=0;n<t.length;++n)r=u(e,[t[n].pageX,t[n].pageY]),a.push({pageX:r[0],pageY:r[1]});return a}function st(e,t){if(!e)return!1;var n=or(t),r=Xe(e);if(!r)return n&&0==n[3];var a=Ze(r),i=ee(e),o=ot(a,i),s=it(o,{left:0,top:0,right:r.width,bottom:r.height}),l=s.right-s.left,u=s.bottom-s.top,c=Ne(l,u),h=c.getContext("2d"),p=1;if(!o||o.length<3||!l||!u)return!1;for(h.drawImage(r,s.left,s.top,l,u,0,0,l,u),h.save(),h.beginPath(),h.moveTo(0,0),h.lineTo(l,0),h.lineTo(l,u),h.lineTo(0,u),h.closePath(),h.moveTo(o[0].pageX-s.left,o[0].pageY-s.top);p<o.length;p+=1)h.lineTo(o[p].pageX-s.left,o[p].pageY-s.top);h.closePath(),h.clip(),n&&0==n[3]?h.fillRect(0,0,l,u):h.clearRect(0,0,l,u),h.restore();var f=h.getImageData(0,0,l,u).data;if(n&&0!=n[3]){for(p=0;p<f.length;p+=4)if(Math.abs(f[p+0]-n[0])<=3&&Math.abs(f[p+1]-n[1])<=3&&Math.abs(f[p+2]-n[2])<=3&&f[p+3]<=2*n[3]&&f[p+3]>=n[3]/2)return!0}else{var d=!n;for(p=0;p<f.length;p+=4)if(f[p+3]>0==d)return!0}return!1}function lt(e,t,n){if(t.img)("CANVAS"==e[0].tagName||e[0].tagName==t.img.tagName)&&Rt(t.img,e[0],t.css);else if("IMG"==e[0].tagName||"CANVAS"==e[0].tagName)Ot(e[0],t.url,t.css,n),n=null;else{var r={backgroundImage:"url("+t.url+")",backgroundRepeat:"no-repeat",backgroundPosition:"center"};t.css.width&&t.css.height&&(r.backgroundSize=t.css.width+"px "+t.css.height+"px"),e.css(r)}n&&n()}function ut(t,n,r){var a,i=ye(t,!0),o=i&&Me(i.rot),s=On(t),l=i&&n*s,u=i&&(r||0)*s,c=-Math.cos(o)*l,h=Math.sin(o)*l,p=e.data(t,"turtleData");i&&(r&&(c+=Math.sin(o)*u,h+=Math.cos(o)*u),p&&(a=p.quickpagexy)&&(p.quickpagexy={pageX:a.pageX+h,pageY:a.pageY+c}),i.tx+=h,i.ty+=c,t.style[La]=ke(i),nt(t,p,!0))}function ct(t,n,r){var a,i=ye(t,!0),o=e.data(t,"turtleData");i&&(o&&(a=o.quickpagexy)&&(o.quickpagexy={pageX:a.pageX+n,pageY:a.pageY-r}),i.tx+=n,i.ty-=r,t.style[La]=ke(i),nt(t,o,!0))}function ht(e,t){var n=ye(e,!0);n&&(n.rot+=t,e.style[La]=ke(n))}function pt(e,t,n){var r=ye(e,!0);if(r){var a=On(e),i=Me(r.rot),o=t*a,s=(n||0)*a,l=-Math.cos(i)*o,u=Math.sin(i)*o;return s&&(l+=Math.sin(i)*s,u+=Math.cos(i)*s),be(r.tx+u)+" "+be(r.ty+l)}}function ft(t){return t&&e.isNumeric(t.pageX)&&e.isNumeric(t.pageY)}function dt(){return{get:function(e,t,n){return Le(e).speed},set:function(t,n){(e.isNumeric(n)&&!(0>=n)||n in e.fx.speeds||""+n=="Infinity")&&(Le(t).speed=""+n)}}}function gt(){return{get:function(e,t,n){return Le(e).easing},set:function(t,n){n in e.easing&&(Le(t).easing=n)}}}function mt(t,n){var r=e.data(t,"turtleData");return n=n||Ci,r?e.isNumeric(r.speed)||"Infinity"==r.speed?1e3/r.speed:"turtle"==r.speed&&n?0:r.speed:n?0:"turtle"}function vt(t){var n=e.data(t,"turtleData");return n?n.easing:null}function yt(){return{get:function(e,t,n){var r=ye(e,t),a=_(e);if(r){var i=Me(r.rot),o=Math.cos(i),s=Math.sin(i),l=On(e);return be(((r.tx+a[0])*s-(r.ty+a[1])*o)/l)+"px"}},set:function(t,n){var r,a=ye(t,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},i=_(t),o=On(t),s=parseFloat(n)*o,l=Me(a.rot),u=Math.cos(l),c=Math.sin(l),h=(a.tx+i[0])*u+(a.ty+i[1])*c,p=h*u+s*c-i[0],f=h*c-s*u-i[1],d=e.data(t,"turtleData");d&&(r=d.quickpagexy)&&(d.quickpagexy={pageX:r.pageX+(p-a.tx),pageY:r.pageY+(f-a.ty)}),a.tx=p,a.ty=f,t.style[La]=ke(a),nt(t,d)}}}function bt(t,n,r,a){return{get:function(e,n,a){var i=ye(e,n);return i?i[t]+r:void 0},set:function(r,i){var o,s=ye(r,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},l={displace:a},u=e.data(r,"turtleData"),c=s.tx,h=s.ty;s[t]=n(i,r,s,l),r.style[La]=ke(s),l.displace?(u&&(o=u.quickpagexy)&&(u.quickpagexy={pageX:o.pageX+(s.tx-c),pageY:o.pageY+(s.ty-h)}),nt(r,u)):J(r)}}}function kt(e,t,n){var r=_e(t-e),a=r>0?n:-n,i=Me(e),o=[Math.cos(i)*a,Math.sin(i)*a],s=Me(t);return{delta:r,sradius:a,dc:o,dx:o[0]-Math.cos(s)*a,dy:o[1]-Math.sin(s)*a}}function wt(e,t,n,r,a,i){var o,s,l,c,h,p,f,d,g,m,y,k=kt(n,r,a),w=k.sradius,M=k.dc;for(f=1,d=k.delta,g=Math.abs(k.delta),g>45&&(f=Math.ceil(g/45),d=k.delta/f),m=[];--f>=0;)o=0===f?r:n+d,s=Me(n+180),l=Me(o+180),m.push.apply(m,x(s,l)),n=o;for(y=[],c=0;c<m.length;c++)h=u(i,v(b(m[c],w),M)),y.push({pageX:h[0]+t.pageX,pageY:h[1]+t.pageY});for(p=[],c=0;c<y.length;c+=3)p.push(y.slice(c,c+3));return et(e,t,p),k}function xt(t,n,r,a){t=parseFloat(t);var i=e.data(n,"turtleData"),o=i?i.turningRadius:0;if(0===o||r.rot==t)return a.displace=!1,0===o?Te(t):t;var s,l=i&&i.style&&i.down,u=i&&i.oldscale?r.sy:1,c=o*u;return s=l?wt(i.path[0],Z(n),r.rot,t,c,S(n.parentElement)):kt(r.rot,t,c),r.tx+=s.dx,r.ty+=s.dy,a.displace=!0,t}function Mt(t){return function(n){n.delta||(n.delta=_e(n.end-n.start),n.start=n.end-n.delta),e.cssHooks[t].set(n.elem,n.start+n.delta*n.pos)}}function Tt(t,n){t.length&&"_"===t[0]&&(t=t.substring(1));for(var r=e.map((""+t).split(/\s+/),parseFloat);r.length<2;)r.push(n?r.length?r[r.length-1]:1:0);return r}function _t(t,n){return function(r){if(!r.delta){var a=Tt(r.end,!n);r.start=Tt(r.start,!n),r.delta=[a[0]-r.start[0],a[1]-r.start[1]]}e.cssHooks[t].set(r.elem,[r.start[0]+r.delta[0]*r.pos,r.start[1]+r.delta[1]*r.pos].join(" "))}}function St(t,n,r,a){return{get:function(e,t,i){var o=ye(e,t);return o?a||o[n]!=o[r]?(""===i?"_":"")+o[n]+" "+o[r]:""+o[n]:void 0},set:function(t,i,o){var s,l=ye(t,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},u="string"==typeof i?i.split(/\s+/):[i],c=e.data(t,"turtleData"),h=l.tx,p=l.ty;u.length<1||u.length>2||(u.length>=1&&(l[n]=parseFloat(u[0])),u.length>=2?l[r]=parseFloat(u[1]):a?l[r]=0:l[r]=l[n],t.style[La]=ke(l),a?(c&&(s=c.quickpagexy)&&(c.quickpagexy={pageX:s.pageX+(l.tx-h),pageY:s.pageY+(l.ty-p)}),nt(t,c)):J(t))}}}function At(e){return za.href=e,za}function Ct(e){return At(e).href}function Pt(e){return/(?:^|\.)pencil(?:code)?\./i.test(e)}function qt(e){var t=At(null==e?"":e).hostname,n=/^(\w+)\.pencil(?:code)?\./i.exec(t);return n?n[1]:null}function Xt(e,n){var r=At(null==e?"":e),a=r.href;return Pt(r.hostname)?/^\/(?:edit|home|code|load|save)(?:\/|$)/.test(r.pathname)&&(a=r.protocol+"//"+r.host+"/"+n+"/"+r.pathname.replace(/\/[^\/]*(?:\/|$)/,"")+r.search+r.hash):Pt(t.location.hostname)&&(a="/proxy/"+a),a}function Yt(e){return/\//.test(e)?e:(e="/img/"+e,Pt(t.location.hostname)?e:"//pencilcode.net"+e)}function Nt(){if(!document.cookie)return null;for(var e=document.cookie.split(/;\s*/),t=0;t<e.length;++t)if(/^login=/.test(e[t])){var n=unescape(e[t].substr(6)).split(":");if(n&&2==n.length)return{user:n[0],key:n[1]}}return null}function Ot(e,t,n,r){function a(e,t,n,r){t.getAttribute("data-loading")==e.src&&(t.removeAttribute("data-loading"),Rt(e,t,n)),r&&r()}var i,o=At(t);t=o.href,e.setAttribute("data-loading",t),t in $a?(i=$a[t],null===i.queue?a(i.img,e,n,r):(i.queue.push({elem:e,css:n,cb:r}),jt(t,e,n))):($a[t]=i={img:new Image,queue:[{elem:e,css:n,cb:r}]},Pt(o.hostname)&&(i.img.crossOrigin="Anonymous"),jt(t,e,n),Et(i.img,t,function(){var e,t=i.queue;if(i.queue=null,t)for(e=0;e<t.length;++e)a(i.img,t[e].elem,t[e].css,t[e].cb)}))}function Et(e,t,n){function r(i){i||e.complete||e.src!=t?(e.removeEventListener("load",r),e.removeEventListener("error",r),clearTimeout(a),n()):a=setTimeout(r,100)}if(null==t&&(t=e.src),t==e.src&&(!t||e.complete))return void n();var a=null;e.addEventListener("load",r),e.addEventListener("error",r),e.src=t,r()}function jt(e,t,n){/^data:/.test(e)&&n.width&&n.height&&Rt(null,t,n)}function Rt(t,n,r){var a,i=_(n),o=e(n),s="CANVAS"==n.tagName;if(s||(n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),o.css({backgroundImage:"none",height:"",width:"",turtleHull:"",transformOrigin:""}),t)if("VIDEO"==t.tagName)n.width=e(t).width(),n.height=e(t).height(),s&&(a=n.getContext("2d"),a.clearRect(0,0,n.width,n.height),a.drawImage(t,0,0,t.videoWidth,t.videoHeight,0,0,n.width,n.height));else if(n.width=t.width,n.height=t.height,s){if(t.width>0&&t.height>0)try{a=n.getContext("2d"),a.clearRect(0,0,t.width,t.height),a.drawImage(t,0,0)}catch(l){}}else n.src=t.src;r&&o.css(r);var u=_(n);if(t&&!r.turtleHull)try{var c=Xa(t);Oa(c,parseFloat(o.css("width"))/t.width,parseFloat(o.css("height"))/t.height,-u[0],-u[1]),o.css("turtleHull",c)}catch(l){}It(n,i,u)}function It(t,n,r){var a=e(t);if(a.hasClass("turtle")&&(r[0]!=n[0]||r[1]!=n[1]))if("absolute"==a.css("position")&&/px$/.test(a.css("left"))&&/px$/.test(a.css("top")))a.css("left",parseFloat(a.css("left"))+n[0]-r[0]),a.css("top",parseFloat(a.css("top"))+n[1]-r[1]);else{var i=ye(t,!0);i.tx+=n[0]-r[0],i.ty+=n[1]-r[1],t.style[La]=ke(i)}}function Ft(t,n,r,a,i){var o,s,l,u,c;return void 0===a&&void 0===i?(o=e(r),o.length?(s=o[0],l=D(s),$(ee(s),l)?t.filter(function(){var t=D(this);return n===(z(l,t)||!H(l,t)&&e(this).inside(s))}):t.filter(function(){return n===e(this).inside(s)})):[]):(u=e.isNumeric(a)&&e.isNumeric(i)?[a,i]:a,e.isArray(u)&&(u=V(t[0]||document.body,[u])[0]),"touch"===r?ft(u)?t.filter(function(){return n===e(this).touches(u)}):(o=e(u),l=D(o[0]),$(ee(o[0]),l)?t.filter(function(){var e=D(this);return n===(!H(l,e)&&(z(l,e)||o.touches(this)))}):t.filter(function(){return n===o.touches(this)})):(c=r*r,t.filter(function(){var e=D(this);if(L(u,c,e))return!n;if(W(u,c,e))return n;var t=Z(this),r=u.pageX-t.pageX,a=u.pageY-t.pageY;return n===c>=r*r+a*a})))}function Dt(){if(!Za){Za=!0;try{t.parent.document.activeElement.blur()}catch(e){}t.focus()}}function Lt(t,n,r,a,i){for(var o=a.split(/\s+/),s=0;s<o.length;++s){a=o[s];var l=t[a];l||(l=t[a]=e.extend({},r)),"function"!=typeof l[n]?l[n]=i:l[n]!=i&&(l[n].hooklist?l[n].hooklist.indexOf(i)<0&&l[n].hooklist.push(i):!function(){var e=[l[n],i];(l[n]=function(t,n){for(var r=t,a=0;a<e.length;++a)r=e[a](r,n)||r;return r}).hooklist=e}())}}function Wt(t,n){if(Ha.field&&"pageX"in t&&"pageY"in t){var r=e(Ha.field).offset();r&&(t.x=t.pageX-r.left,t.y=r.top-t.pageY)}return t}function Ht(e,t,n){return(Ha.field&&!Ha.fieldMouse&&this.parentElement===Ha.field||/(?:^|\s)turtle(?:\s|$)/.test(this["class"]))&&(Ha.fieldMouse=!0,
zt()),!1}function zt(){Ha.fieldHook||Ha.surface&&Ha.fieldMouse&&(Ha.fieldHook=!0,setTimeout(function(){e("body").on("click.turtle dblclick.turtle mouseup.turtle mousedown.turtle mousemove.turtle",function(t){if(t.target===this&&!t.isTrigger){var n=e.turtle.nowarn;e.turtle.nowarn=!0;var r=e(Ha.surface).find(".turtle,.turtlelabel").within("touch",t).eq(0);if(e.turtle.nowarn=n,1===r.length)return t.target=null,t.relatedTarget=null,t.fromElement=null,t.toElement=null,r.trigger(t),!1}})},0))}function $t(){var t="mousedown mouseup mousemove click dblclick";Lt(e.event.fixHooks,"filter",e.event.mouseHooks,t,Wt),Lt(e.event.special,"setup",{},t,Ht)}function Bt(e,t){var n=e.which;n||(n=(t||e.originalEvent).whichSynth);var r=Ja[n];return!r&&n&&(r=String.fromCharCode(n)),e.key=r,e}function Qt(e,t){null!=e.charCode&&(e.key=String.fromCharCode(e.charCode))}function Ut(e){if("string"==typeof e.data){var t=e.data.replace(/\s/g,"").toLowerCase().split(","),n=e.handler,r=function(e){return t.indexOf(e.key)<0?void 0:n.apply(this,arguments)};n.guid&&(r.guid=n.guid),e.handler=r}}function Gt(){Lt(e.event.fixHooks,"filter",e.event.keyHooks,"keydown keyup",Bt),Lt(e.event.fixHooks,"filter",e.event.keyHooks,"keypress",Qt),Lt(e.event.special,"add",{},"keydown keyup keypress",Ut)}function Vt(){return{get:function(e,t,n){return s(Jt(e).getTimbre())},set:function(e,t){Jt(e).setTimbre(o(t,"wave"))}}}function Zt(){return{get:function(e,t,n){return Jt(e).getVolume()},set:function(e,t){Jt(e).setVolume(parseFloat(t))}}}function Jt(t){var n=Le(t);if(n.instrument)return n.instrument;n.instrument=new ai("piano");var r=e(t);return n.instrument.on("noteon",function(t){var n=e.Event("noteon");n.midi=t.midi,r.trigger(n)}),n.instrument.on("noteoff",function(t){var n=e.Event("noteoff");n.midi=t.midi,r.trigger(n)}),n.instrument}function Kt(){return ei||(ei=new ai),ei}function en(){return!(!t.AudioContext&&!t.webkitAudioContext)}function tn(){if(tn.audioTop)return tn.audioTop;if(!en())return null;var e=new(t.AudioContext||t.webkitAudioContext);return tn.audioTop={ac:e,wavetable:hn(e),out:null,currentStart:null},nn(),tn.audioTop}function nn(){if(tn.audioTop){var e=tn.audioTop;e.out&&(e.out.disconnect(),e.out=null,e.currentStart=null);try{var t=e.ac.createDynamicsCompressor();t.ratio=16,t.attack=5e-4,t.connect(e.ac.destination),e.out=t}catch(n){tn.audioTop=null}}}function rn(){var e=tn();return null!=e.currentStart?e.currentStart:(e.currentStart=Math.max(.25,e.ac.currentTime),setTimeout(function(){e.currentStart=null},0),e.currentStart)}function an(e){return 440*Math.pow(2,(e-69)/12)}function on(e){return Math.round(69+12*Math.log(e/440)/Math.LN2)}function sn(e){var t=/^(\^+|_+|=|)([A-Ga-g])([,']*)$/.exec(e);if(!t)return null;var n=t[3].replace(/,/g,"").length-t[3].replace(/'/g,"").length,r=ti[t[2]]+ni[t[1].charAt(0)]*t[1].length+12*n;return r+60}function ln(e){var t=(e-72)%12;(e>60||0!=t)&&(t+=12);for(var n=Math.round((e-t-60)/12),r=ri[t];0!=n;)r+=n>0?"'":",",n+=n>0?-1:1;return r}function un(e){return an(sn(e))}function cn(e){function t(e,t){switch(e){case"V":S!==_&&n(t.split(" ")[0]);break;case"M":i(t,S);break;case"L":o(t,S);break;case"Q":s(t,S)}S.hasOwnProperty(e)?S[e]+="\n"+t:S[e]=t,"K"==e&&(A=c(t),S===_&&n(r()))}function n(e){e=e||"",(e||S===_)&&(_.voice||(_.voice={}),_.voice.hasOwnProperty(e)?(S=_.voice[e],C=S.accent):(S={id:e,accent:{slurred:0}},_.voice[e]=S,C=S.accent))}function r(){return _.V?_.V.split(/\s+/)[0]:""}function a(e){var a,i=e.match(oi),o=null,s=0,l=0,u=null;if(!i)return null;for(;s<i.length;)if(/^[\s%]/.test(i[s]))s++;else if(/^\[[A-Za-z]:[^\]]*\]$/.test(i[s]))t(i[s].substring(1,2),i[s].substring(3,i[s].length-1).trim()),s++;else if(/</.test(i[s]))l=-i[s++].length;else if(/>/.test(i[s]))l=i[s++].length;else if(/^\(\d+(?::\d+)*/.test(i[s]))u=d(i[s++]);else if(/^[!+].*[!+]$/.test(i[s]))g(i[s++],C);else if(/^.?".*"$/.test(i[s]))s++;else if(/^[()]$/.test(i[s]))"("==i[s++]?C.slurred+=1:(C.slurred-=1,C.slurred<=0&&(C.slurred=0,S.stems&&S.stems.length>=1&&p(S.stems[S.stems.length-1],!1)));else if(/\|/.test(i[s])){for(a in C)1==a.length&&delete C[a];s++}else o=m(i,s,A,C),null!==o?(u&&(f(o.stem,u.time),u.count-=1,u.count||(u=null)),l&&S.stems&&S.stems.length&&(a=l>0?(1-Math.pow(.5,l))*o.stem.time:(Math.pow(.5,-l)-1)*S.stems[S.stems.length-1].time,h(S.stems[S.stems.length-1],a),h(o.stem,-a)),l=0,C.slurred&&p(o.stem,!0),S===_&&n(r()),"stems"in S||(S.stems=[]),S.stems.push(o.stem),s=o.index):s++}function i(e,t){var n=/^C/.test(e)?1:b(e);n&&(t.unitnote||(.75>n?t.unitnote=1/16:t.unitnote=1/8))}function o(e,t){var n=b(e);n&&(t.unitnote=n)}function s(e,t){var n,r=e.split(/\s+|=/),a=null,i=null;for(n=0;n<r.length;++n)r[n].indexOf("/")>=0||/^[1-4]$/.test(r[n])?a=a||b(r[n]):i=i||Number(r[n]);a&&(t.unitbeat=a),i&&(t.tempo=i)}function l(e){var t,n,r,a,i,o={};for(n=0;n<e.length;++n){for(t={},r=0;r<e[n].notes.length;++r)i=a=e[n].notes[r],o.hasOwnProperty(a.pitch)&&(i=o[a.pitch],i.time+=a.time,a.holdover=!0),a.tie&&(t[a.pitch]=i);o=t}}function u(e){var t,n="FCGDAEB",r={};if(!e)return r;if(e>0)for(t=0;e>t&&7>t;++t)r[n.charAt(t)]="^";else for(t=0;t>e&&t>-7;--t)r[n.charAt(6+t)]="_";return r}function c(e){if(!e)return{};var t,n={"c#":7,"f#":6,b:5,e:4,a:3,d:2,g:1,c:0,f:-1,bb:-2,eb:-3,ab:-4,db:-5,gb:-6,cb:-7,"a#m":7,"d#m":6,"g#m":5,"c#m":4,"f#m":3,bm:2,em:1,am:0,dm:-1,gm:-2,cm:-3,fm:-4,bbm:-5,ebm:-6,abm:-7,"g#mix":7,"c#mix":6,"f#mix":5,bmix:4,emix:3,amix:2,dmix:1,gmix:0,cmix:-1,fmix:-2,bbmix:-3,ebmix:-4,abmix:-5,dbmix:-6,gbmix:-7,"d#dor":7,"g#dor":6,"c#dor":5,"f#dor":4,bdor:3,edor:2,ador:1,ddor:0,gdor:-1,cdor:-2,fdor:-3,bbdor:-4,ebdor:-5,abdor:-6,dbdor:-7,"e#phr":7,"a#phr":6,"d#phr":5,"g#phr":4,"c#phr":3,"f#phr":2,bphr:1,ephr:0,aphr:-1,dphr:-2,gphr:-3,cphr:-4,fphr:-5,bbphr:-6,ebphr:-7,"f#lyd":7,blyd:6,elyd:5,alyd:4,dlyd:3,glyd:2,clyd:1,flyd:0,bblyd:-1,eblyd:-2,ablyd:-3,dblyd:-4,gblyd:-5,cblyd:-6,fblyd:-7,"b#loc":7,"e#loc":6,"a#loc":5,"d#loc":4,"g#loc":3,"c#loc":2,"f#loc":1,bloc:0,eloc:-1,aloc:-2,dloc:-3,gloc:-4,cloc:-5,floc:-6,bbloc:-7},r=e.replace(/\s+/g,"").toLowerCase().substr(0,5),a=r.match(/maj|min|mix|dor|phr|lyd|loc|m/);t=a?"maj"==a?r.substr(0,a.index):"min"==a?r.substr(0,a.index+1):r.substr(0,a.index+a[0].length):/^[a-g][#b]?/.exec(r)||"";var i=u(n[t]),o=e.substr(t.length).match(/(_+|=|\^+)[a-g]/gi);if(o)for(var s=0;s<o.length;++s){var l=o[s].charAt(o[s].length-1).toUpperCase();"="==o[s].charAt(0)?delete i[l]:i[l]=o[s].substr(0,o[s].length-1)}return i}function h(e,t){var n,r,a=e.time,i=a+t;for(e.time=i,n=0;n<e.notes.length;++n)r=e.notes[n],r.time==a&&(r.time=i)}function p(e,t){var n,r;for(n=0;n<e.notes.length;++n)r=e.notes[n],t?r.slurred=!0:r.slurred&&delete r.slurred}function f(e,t){var n;for(e.time*=t,n=0;n<e.notes.length;++n)e.notes[n].time*=t}function d(e){var t=/^\((\d+)(?::(\d+)(?::(\d+))?)?$/.exec(e);if(!t)return null;var n=Number(t[1]),r=Number(t[2])||2,a=Number(t[3])||n;return{time:r/n,count:a}}function g(e,t){if(!(e.length<2))switch(e=e.substring(1,e.length-1)){case"pppp":case"ppp":t.dynamics=.2;break;case"pp":t.dynamics=.4;break;case"p":t.dynamics=.6;break;case"mp":t.dynamics=.8;break;case"mf":t.dynamics=1;break;case"f":t.dynamics=1.2;break;case"ff":t.dynamics=1.4;break;case"fff":case"ffff":t.dynamics=1.5}}function m(e,t,n,r){var a,i,o,s,l=[],u="",c=!1,h=null,p=1/0;if(t<e.length&&"."==e[t]&&(c=!0,t++),t<e.length&&"["==e[t]){for(t++;t<e.length;)if(/^[\s%]/.test(e[t]))t++;else{if(/[A-Ga-g]/.test(e[t]))h={pitch:y(e[t++],n,r),tie:!1},h.frequency=un(h.pitch),l.push(h);else{if(!/[xzXZ]/.test(e[t])){if("."==e[t]){c=!0,t++;continue}break}h=null,t++}t<e.length&&/^(?![\s%!]).*[\d\/]/.test(e[t])?(a=e[t++],i=b(a)):(a="",i=1),h&&(h.duration=a,h.time=i),i&&p>i&&(u=a,p=i),t<e.length&&"-"==e[t]&&(h&&(l[l.length-1].tie=!0),t++)}if("]"!=e[t])return null;t++}else if(t<e.length&&/[A-Ga-g]/.test(e[t]))h={pitch:y(e[t++],n,r),tie:!1,duration:"",time:1},h.frequency=un(h.pitch),l.push(h);else{if(!(t<e.length&&/^[xzXZ]$/.test(e[t])))return null;t++}if(t<e.length&&/^(?![\s%!]).*[\d\/]/.test(e[t]))for(u=e[t++],i=b(u),s=0;s<l.length;++s)l[s].duration=u,l[s].time=i;if(t<e.length&&"-"==e[t])for(t++,s=0;s<l.length;++s)l[s].tie=!0;if(r.dynamics)for(o=r.dynamics,s=0;s<l.length;++s)l[s].velocity=o;return{index:t,stem:{notes:l,duration:u,staccato:c,time:b(u)}}}function v(e){return e.length>0&&"="==e.charAt(0)?e.substr(1):e}function y(e,t,n){var r,a=/^(\^+|_+|=|)([A-Ga-g])(.*)$/.exec(e);return a?(r=a[2].toUpperCase(),a[1].length>0?(n[r]=a[1],v(e)):v(n.hasOwnProperty(r)?n[r]+a[2]+a[3]:t.hasOwnProperty(r)?t[r]+a[2]+a[3]:e)):e}function b(e){var t,n,r,a=/^(\d*)(?:\/(\d*))?$|^(\/+)$/.exec(e),i=0;if(a){if(a[3])return Math.pow(.5,a[3].length);if(n=a[2]?parseFloat(a[2]):/\//.test(e)?2:1,r=0,t=a[1]?parseFloat(a[1]):1,a[2])for(;r+1<a[1].length&&t>n;)r+=1,i=parseFloat(a[1].substring(0,r)),t=parseFloat(a[1].substring(r));return i+t/n}}var k,w,x,M,T=e.split("\n"),_={},S=_,A={},C={slurred:0};for(k=0;k<T.length;++k)if(x=ii.exec(T[k]))t(x[1],x[2].trim());else{if(/^\s*(?:%.*)?$/.test(T[k]))continue;a(T[k])}var P=["unitnote","unitbeat","tempo"];if(_.voice){M=[];for(k in _.voice)if(_.voice[k].stems&&_.voice[k].stems.length){for(l(_.voice[k].stems),w=0;w<P.length;++w)!(P[w]in _)&&P[w]in _.voice[k]&&(_[P[w]]=_.voice[k][P[w]]);delete _.voice[k].accent}else M.push(k);for(k=0;k<M.length;++k)delete _.voice[M[k]]}return _}function hn(e){return function(t){function n(t){var n,r=t.real.length,a=new Float32Array(r),i=new Float32Array(r);for(n=0;r>n;++n)a[n]=t.real[n],i[n]=t.imag[n];try{return e.createPeriodicWave(a,i)}catch(o){}try{return e.createWaveTable(a,i)}catch(o){}return null}function r(e,t,n){var r,a,i={real:[],imag:[]},o=e.real.length;for(r=0;o>r;++r)a=Math.log(t[Math.min(r,t.length-1)]),i.real.push(e.real[r]*Math.exp(n*a)),i.imag.push(e.imag[r]*Math.exp(n*a));return i}var a,i,o,s,l,u,c={};for(a in t)if(i=t[a],u=n(i)){if(l={wave:u},i.mult)for(s=t[a].freq,l.freq={},o=0;o<s.length;++o)u=n(r(i,i.mult,(o+1)/s.length)),u&&(l.freq[s[o]]=u);i.defs&&(l.defs=i.defs),c[a]=l}return c}({piano:{real:[0,0,-.203569,.5,-.401676,.137128,-.104117,.115965,-.004413,.067884,-.00888,.0793,-.038756,.011882,-.030883,.027608,-.013429,.00393,-.014029,.00972,-.007653,.007866,-.032029,.046127,-.024155,.023095,-.005522,.004511,-.003593,.011248,-.004919,.008505],imag:[0,.147621,0,7e-6,-1e-5,5e-6,-6e-6,9e-6,0,8e-6,-1e-6,14e-6,-8e-6,3e-6,-9e-6,9e-6,-5e-6,2e-6,-7e-6,5e-6,-5e-6,5e-6,-23e-6,37e-6,-21e-6,22e-6,-6e-6,5e-6,-4e-6,14e-6,-7e-6,12e-6],mult:[1,1,.18,.016,.01,.01,.01,.004,.014,.02,.014,.004,.002,1e-5],freq:[65,80,100,135,180,240,620,1360],defs:{wave:"piano",gain:.5,attack:.002,decay:.25,sustain:.03,release:.1,decayfollow:.7,cutoff:800,cutfollow:.1,resonance:1,detune:.9994}}})}function pn(t){var n,r,a=[],i=t.length;for(i&&e.isFunction(t[i-1])&&(r=t[--i]),n=0;i>n;++n)t[n]&&(t[n].constructor===e?a.push.apply(a,t[n].toArray()):e.isArray(t[n])?a.push.apply(a,t[n]):a.push(t[n]));return{elts:e.unique(a),completion:r}}function fn(){function t(){var e,t=o;for(o=null,i&&i(),e=0;e<t.length;++e)t[e]()}var n,r=pn(arguments),a=r.elts,i=r.completion,o=[];if(a.length>1)for(n=0;n<a.length;++n)Un(a[n]),e(a[n]).queue(function(e){o&&(o.push(e),o.length==a.length&&t())})}function dn(){var t,n=pn(arguments),r=n.elts,a=n.completion,i=r.length;for(t=0;t<r.length;++t)e(r[t]).queue(function(t){e(this).remove(),i-=1,a&&0==i&&a(),t()})}function gn(e){Hi.html('<aside style="line-height:133%;word-break:normal;white-space:normal">'+e+"</aside>")}function mn(n){var r,a,i=e.extend({},vi,si,yi);if(n&&!e.isArray(n.helptext)&&n in i&&(n=i[n]),n&&e.isArray(n.helptext)&&n.helptext.length){for(a=0;a<n.helptext.length;++a){var o=n.helptext[a];gn(o.replace(/<(u)>/g,'<$1 style="border:1px solid black;text-decoration:none;word-break:keep-all;white-space:nowrap">').replace(/<(mark)>/g,'<$1 style="border:1px solid blue;color:blue;text-decoration:none;word-break:keep-all;white-space:nowrap;cursor:pointer;" onclick="see.enter($(this).text())">'))}return ki}if("number"==typeof n)return gn("Equal to the number "+n+"."),ki;if("boolean"==typeof n)return gn("Equal to the boolean value "+n+"."),ki;if(null===n)return gn("The special null value represents the absence of a value."),ki;if(void 0===n)return gn("This is an unassigned value."),ki;if(n===t)return gn("The global window object represents the browser window."),ki;if(n===document)return gn("The HTML document running the program."),ki;if(n===jQuery)return gn('The jQuery function.  Read about it at <a href="http://learn.jquery.com/" target="_blank">jquery.com</a>.'),ki;if(n&&n!=mn)return gn("No help available for "+n),ki;r=[];for(var s in i)!i[s].helptext||!i[s].helptext.length||s in t&&"function"!=typeof t[s]||r.push(s);return r.sort(function(e,t){return e.length!=t.length?e.length-t.length:t>e?-1:e>t?1:0}),gn("help available for: "+r.map(function(e){return'<mark style="border:1px solid blue;color:blue;text-decoration:none;word-break:keep-all;white-space:nowrap;cursor:pointer;" onclick="see.enter($(this).text())">'+e+"</mark>"}).join(" ")),ki}function vn(e){return 1==e.length&&yn(e[0])&&e[0]}function yn(t){var n;return t&&0==e.queue(t).length&&(!t.parentElement||!t.parentElement.style.transform)&&(0===(n=mt(t))||0===e.fx.speeds[n])}function bn(t,n){var r;if(null==n){if(yn(t))return;r=mt(t)}else r=1e3*n;var a=e(t);r>0&&a.delay(r)}function kn(e,t){if(t=t||0,e.length<=t)return null;var n=e[e.length-1];return"function"!=typeof n||n.helpname?null:n}function wn(t,n,r,a){function i(r,a){if(null!=r){var i=t&&t[r];a&&i&&nt(i,e.data(i,"turtleData"),!0),Yi.reportEvent("resolve",[n,p,u,r,i])}0==--c&&s&&(h?(Ia+=1,setTimeout(function(){Ia-=1,s()},0)):s())}function o(e){null!=e&&Yi.reportEvent("appear",[n,p,u,e,t&&t[e],l])}var s=kn(r,a),l=s?Array.prototype.slice.call(r,0,r.length-1):r,u=t?t.length||0:0,c=u+1,h=!0,p=Yi.nextId();return Yi.reportEvent("enter",[n,p,u,l]),{name:n,args:l,appear:o,resolve:i,resolver:function(e,t){return function(){i(e,t)}},exit:function(){Yi.reportEvent("exit",[n,p,u,l]),i(null),h=!1}}}function xn(t,n,r,a){var i=function(){if(Gn(t),Ra)throw new Error(t+" interrupted");var r,i=wn(this,t,arguments,n),o=[i].concat(e.makeArray(i.args));try{r=a.apply(this,o)}finally{i.exit()}return r};return An(t,r,i)}function Mn(e,t,n){var r=function(){if(Gn(e),Ra)throw new Error(e+" interrupted");return Vn(e,this),n.apply(this,arguments)};return An(e,t,r)}function Tn(t,n,r,a){var i=function(){if(Gn(t),Ra)throw new Error(t+" interrupted");var n=null,i=0,o=di;if(a&&(n=a.apply(null,arguments),i=arguments.length,o=Jn()),o){var s=e(di).eq(0),l=arguments,u=wn(s,t,arguments,i);s.plan(function(e,t){u.appear(e),r.apply(n,l),this.plan(u.resolver(e))}),u.exit()}else u=wn(null,t,arguments,i),r.apply(n,arguments),u.exit();return n?(n.result&&n.result.constructor===jQuery&&di&&fn(di,n.result),n.result):void 0};return An(t,n,i)}function _n(n,r){return An(n,r,function(r,a){var i=/^key/.test(n),o=/^mouse|click$/.test(n),s=o?"input,button":i?"textarea,input:not([type]),input[type=text],input[type=password]":null;i&&Dt(),null==a&&"function"==typeof r&&(a=r,r=null),e(t).on(n+".turtleevent",null,r,s?function(t){return Ra||e(t.target).closest(s).length?void 0:a.apply(this,arguments)}:a)})}function Sn(){var n=e._data(t,"events");if(!n)return!1;for(var r in n)for(var a=n[r],i=0;i<a.length;++i)if("turtleevent"==a[i].namespace)return!0;return!1}function An(e,t,n){return n.helpname=e,n.helptext=t,n}function Cn(e,t,n){t=null==t?90:_e(t);var r,a="lt"===e.name,i=Ci;if((r=vn(this))&&(0===n||null==n&&0===We(r)))return e.appear(0),ht(r,a?-t:t),e.resolve(0),this;var o=a?"-=":"+=";return null==n?(this.plan(function(n,r){e.appear(n),this.animate({turtleRotation:o+be(t||0)+"deg"},mt(r,i),vt(r),e.resolver(n))}),this):(this.plan(function(r,s){e.appear(r);var l=Le(s),u=l.turningRadius,c=0>t?-n:n,h=null;l.style&&l.down&&(h=function(){var e=Z(s),n=ye(s,!0),r=S(s.parentElement);return function(){wt(l.corners[0],e,n.rot,n.rot+(a?-t:t),c*(l.oldscale?n.sy:1),r)}}()),l.turningRadius=c,this.animate({turtleRotation:o+be(t)+"deg"},mt(s,i),vt(s)),this.plan(function(){h&&h(),l.turningRadius=u,e.resolve(r,!0)})}),this)}function Pn(e,t){null==t&&(t=100),"bk"===e.name&&(t=-t);var n,r=Ci;return(n=vn(this))?(e.appear(0),ut(n,t,0),e.resolve(0,!0),this):(this.plan(function(n,a){e.appear(n),this.animate({turtleForward:"+="+be(t||0)+"px"},mt(a,r),vt(a),e.resolver(n,!0))}),this)}function qn(t,n,r){e.isArray(n)&&(r=n[1],n=n[0]),r||(r=0),n||(n=0);var a=Ci;return this.plan(function(e,i){t&&t.appear(e),this.animate({turtlePosition:pt(i,r,n)},mt(i,a),vt(i),t&&t.resolver(e,!0))}),this}function Xn(t,n,r){e.isArray(n)&&(r=n[1],n=n[0]),r||(r=0),n||(n=0);var a,i=Ci;return(a=vn(this))?(t&&t.appear(0),ct(a,n,r),t&&t.resolve(0),this):(this.plan(function(e,a){t&&t.appear(e);var o=M(a);this.animate({turtlePosition:be(o[0]+n)+" "+be(o[1]-r)},mt(a,i),vt(a),t&&t.resolver(e,!0))}),this)}function Yn(t,n,r){var a=n,i=0,o=0,s=null,l=Ci;return e.isNumeric(a)&&e.isNumeric(r)?(i=parseFloat(a),o=parseFloat(r),a=null,s=null):e.isArray(a)?(i=a[0],o=a[1],a=null,s=r):e.isNumeric(r)&&(s=r),this.plan(function(n,r){var u=a;if(null===u&&(u=e(U(r)).pagexy()),u&&!ft(u))try{u=e(u).pagexy()}catch(c){return}return u&&ft(u)?e.isWindow(r)?(t&&t.appear(n),ne(u,s),void(t&&t.resolve(n))):void(9!==r.nodeType&&(t&&t.appear(n),this.animate({turtlePosition:Q(r,u,s,i,o)},mt(r,l),vt(r),t&&t.resolver(n,!0)))):void 0}),this}function Nn(e){return function(t,n,r){return this.plan(function(a,i){t.appear(a);var o=this.css("turtlePenDown");this.css({turtlePenDown:"up"}),e.call(this,null,n,r),this.plan(function(){this.css({turtlePenDown:o}),t.resolve(a,!0)})}),this}}function On(t){var n=e.data(t,"turtleData");return n&&null!=n.oldscale?n.oldscale:1}function En(e,t,n){Rn.call(this,!0,e,t,n)}function jn(e,t,n){Rn.call(this,!1,e,t,n)}function Rn(t,n,r,a){void 0===a&&(a=r),r&&a||(r=a=1);var i=Ci;return this.plan(function(o,s){if(t&&(Le(s).oldscale*=a),n.appear(o),e.isWindow(s)||9===s.nodeType)return void n.resolve(o);var l=e.map(e.css(s,"turtleScale").split(" "),parseFloat);1===l.length&&l.push(l[0]),l[0]*=r,l[1]*=a,this.animate({turtleScale:e.map(l,be).join(" ")},mt(s,i),vt(s),n.resolver(o))}),this}function In(e,t){var n=S(e.parentElement),r=p(n),a=r?1:w(n)[1];return a*On(e)}function Fn(t){var n=Ci;return function(r,a,i){if(e.isNumeric(a)){var o=a;a=i,i=o}return null==i&&(i=8.8),this.plan(function(o,s){var l=Le(s),u=l.style;a||(a=u&&(u.fillStyle||u.strokeStyle)||"black"),r.appear(o);var c=this.pagexy(),h=ye(s,!0),p=Re(a,"fillStyle"),f=qe(l),d=In(s),g=i*d,m=Math.max(0,g-2),v=g+(p.eraseMode?2:0),y=/rgba|hsla/.test(p.fillStyle);null==p.lineWidth&&u&&u.lineWidth&&(p.lineWidth=u.lineWidth),vn(this)?(t(f,c,v,h.rot,p,!0),r.resolve(o)):this.queue(function(a){e({radius:0}).animate({radius:m},{duration:mt(s,n),step:function(){y||t(f,c,this.radius,h.rot,p,!1)},complete:function(){t(f,c,v,h.rot,p,!0),r.resolve(o),a()}})})}),this}}function Dn(e,t,n,r,a){var i=e.getContext("2d");i.save(),Ve(i,a),n===1/0?(i.setTransform(1,0,0,1,0,0),i.fillRect(0,0,e.width,e.height)):(Je(i,e),i.beginPath(),i.arc(t.pageX,t.pageY,n/2,0,2*Math.PI,!1),i.closePath(),i.fill(),a.strokeStyle&&i.stroke()),i.restore()}function Ln(e,t,n,r,a){var i=e.getContext("2d");if(i.save(),Ve(i,a),n===1/0)i.setTransform(1,0,0,1,0,0),i.fillRect(0,0,e.width,e.height);else{var o=Math.sin((r+45)/180*Math.PI),s=Math.cos((r+45)/180*Math.PI),l=n*s/Math.SQRT2,u=n*o/Math.SQRT2;Je(i,e),i.beginPath(),i.moveTo(t.pageX-l,t.pageY-u),i.lineTo(t.pageX-u,t.pageY+l),i.lineTo(t.pageX+l,t.pageY+u),i.lineTo(t.pageX+u,t.pageY-l),i.closePath(),i.fill(),a.strokeStyle&&i.stroke()}i.restore()}function Wn(e,t,n,r,a,i){var o=e.getContext("2d");if(o.save(),Ve(o,a),!a.strokeStyle&&a.fillStyle&&(o.strokeStyle=a.fillStyle),n!==1/0){var s=Math.sin(r/180*Math.PI),l=-Math.cos(r/180*Math.PI),u=a.lineWidth||1.62,c=t.pageX+n*s,h=t.pageY+n*l,p=Hn(u,c,h,s,l),f=n-p.hs,d=f*s,g=f*l;Je(o,e),f>0&&(o.beginPath(),o.moveTo(t.pageX,t.pageY),o.lineTo(t.pageX+d,t.pageY+g),o.stroke()),i&&zn(o,p)}o.restore()}function Hn(e,t,n,r,a){var i=Math.max(1.25*e,e+2),o=2*i,s=o-i/2;return{hs:s,x1:t,y1:n,xm:t-r*s,ym:n-a*s,x2:t-a*i-r*o,y2:n+r*i-a*o,x3:t+a*i-r*o,y3:n-r*i-a*o}}function zn(e,t){e.beginPath(),e.moveTo(t.x2,t.y2),e.lineTo(t.x1,t.y1),e.lineTo(t.x3,t.y3),e.quadraticCurveTo(t.xm,t.ym,t.x2,t.y2),e.closePath(),e.fill()}function $n(e,t,n,r,a,i){var o=a-n,s=i-r,l=Math.sqrt(o*o+s*s),u=o/l,c=s/l,h=Hn(t,a,i,u,c);l>h.hs&&(e.beginPath(),e.moveTo(n,r),e.lineTo(h.xm,h.ym),e.lineWidth=t,e.stroke()),zn(e,h)}function Bn(e,n){function r(){a&&clearInterval(a),n&&n()}var a=null;if(!t.speechSynthesis)return console.log("No speech synthesis: "+e),void r();try{var i=new t.SpeechSynthesisUtterance(e);i.addEventListener("end",r),i.addEventListener("error",r),i.lang=navigator.language||"en-GB",t.speechSynthesis.speak(i),a=setInterval(function(){t.speechSynthesis.pending||t.speechSynthesis.speaking||r()},250)}catch(o){t.console&&t.console.log(o),r()}}function Qn(){e.each(["toggle","show","hide"],function(t,n){var r=e.fn[n];e.fn[n]=function(t,n,a){var i=arguments;!i.length&&this.hasClass("turtle")&&(this.length>1||!e._data(this[0],"fxshow"))&&(i=[0]),r.apply(this,i)}})}function Un(t,r){if(r||(r="fx"),"IMG"==t.tagName&&t.src&&!t.complete){var a=e.queue(t,r);0==a.length&&(e.queue(t,r,function(e){Et(t,null,e)}),n(t,r))}}function Gn(t){if(!(e.turtle.hangtime==1/0||ui++<100)){ui=0;var n=(new Date).getTime();return hi?void(n-hi>e.turtle.hangtime&&(Hi.visible()&&Hi.html('<span style="color:red">Oops: program interrupted because it was hanging the browser. Try reducing the number of repetitions.  Or try using <b style="background:yellow">await done defer()</b> or <b style="background:yellow">tick</b> to make an animation.</span>'),e.turtle.interrupt("hung"))):(hi=n,clearTimeout(ci),void(ci=setTimeout(function(){clearTimeout(ci),ci=null,hi=null},0)))}}function Vn(t,n){if(!e.turtle.nowarn){var r,a=!0;for(r=0;a&&r<n.length;++r)e.queue(n[r]).length>=100&&(a=!1);a||(li[t]||(li[t]=1,Hi.visible()?Hi.html('<span style="color:red">Oops: '+t+' may not return useful results when motion is queued. Try <b style="background:yellow">speed Infinity</b></span> or <b style="background:yellow">await done defer()</b> first.'):console.warn(t+' may not return useful results when motion is queued.  Try "speed Infinity" or "await done defer()".')),n.finish())}}function Zn(e,t,n){e[t]=function(){return t in li||(Hi.html('<span style="color:red;">'+t+" deprecated.  Use "+n+".</span>"),li[t]=1),e[n].apply(this,arguments)},e[n].__super__&&r(e[t],e[n])}function Jn(){return di&&e.queue(di).length>0}function Kn(e){if(null===bi.pollTimer){var t=bi.sent[e],n=bi.waiting[e];n&&n.length&&t&&t.length&&(bi.pollTimer=setTimeout(function(){bi.pollTimer=null,n&&n.length&&t&&t.length&&(n.shift().apply(null,t.shift()),Kn(e))},0))}}function er(e,t){if("function"!=typeof t&&"undefined"!=typeof t||!/^\w+\s*$/.test(e)){if("undefined"==typeof t&&/^help\s+\S+$/.test(e))return mn(/^help\s+(\S+)$/.exec(e)[1]),!0}else{if(t&&t.helptext)return mn(t),!0;if(e in yi)return mn(e),!0}return!1}function tr(e,t,n,r){return e.helptext?r.helptext=e.helptext:t in n&&(r.helptext=n[t].helptext),r.method=e,r.helpname=t,r}function nr(e,n){var r=[];for(var a in n)!n.hasOwnProperty(a)||a in t||(r.push(a),t[a]=function(t){var n=e[t],r=e;return tr(n,t,yi,function(){return n.apply(r,arguments)})}(a));return r}function rr(){di=null;for(var e=0;e<gi.length;++e)delete t[gi[e]];gi.length=0}function ar(e){return null!==or(e)}function ir(e){if(!/^[a-z]+$/.test(e))return!1;for(var t=0;t<wi.length;++t)if(wi[t]==e)return!0;return!1}function or(t){if(t in xi)return xi[t];if(!t||!ir(t)&&!/^(?:rgb|hsl)a?\([^)]*\)$|^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/i.test(t))return null;var n,r=document.createElement("div"),a=r.style.color,i=null;return r.style.color=t,a!==r.style.color&&(n=/rgba?\s*\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*([.\d]+))?\s*\)/.exec(e(r).css({position:"absolute",top:0,left:0}).appendTo("body").css("color")),n?i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3]),Math.round(255*(n[4]?parseFloat(n[4]):1))]:"transparent"==t&&(i=[0,0,0,0]),e(r).remove()),xi[t]=i,i}function sr(e){var t=Ne(40,48),n=t.getContext("2d"),r=20,a=26;n.beginPath(),n.arc(r,a,16,0,2*Math.PI,!1),n.closePath(),n.fillStyle=e,n.fill(),n.beginPath();for(var i=[[[5,-14],[3,-11]],[[3,-11],[7,-8],[4,-4]],[[4,-4],[7,0],[4,4]],[[4,4],[7,8],[3,11]],[[7,-8],[12,-9],null],[[7,0],[15,0],null],[[7,8],[12,9],null],[[3,11],[1,15],null]],o=0;o<i.length;o++){var s=i[o];n.moveTo(r+s[0][0],a+s[0][1]);for(var l=1;l<s.length;l++)null!==s[l]&&n.lineTo(r+s[l][0],a+s[l][1]);for(var l=s.length-1;l>=0;l--)null===s[l]?(l--,n.moveTo(r-s[l][0],a+s[l][1])):n.lineTo(r-s[l][0],a+s[l][1])}return n.lineWidth=1.1,n.strokeStyle="rgba(255,255,255,0.75)",n.stroke(),n.beginPath(),n.arc(r,a,15.5,0,2*Math.PI,!1),n.closePath(),n.strokeStyle="rgba(0,0,0,0.4)",n.stroke(),t.toDataURL()}function lr(e){var t=Ne(40,48),n=t.getContext("2d");return n.beginPath(),n.moveTo(0,48),n.lineTo(20,0),n.lineTo(40,48),n.lineTo(20,36),n.closePath(),n.fillStyle=e,n.fill(),t.toDataURL()}function ur(e){var t=Ne(40,40),n=t.getContext("2d");return n.beginPath(),n.arc(20,20,18,-5*Math.PI/2,-Math.PI/2),n.closePath(),n.lineTo(20,20),n.stroke(),n.strokeStyle=e,n.lineWidth=4,n.stroke(),t.toDataURL()}function cr(e,t){t=t||12;var n=Ne(t,t),r=n.getContext("2d"),a=t/2;return r.beginPath(),r.arc(a,a,a,0,2*Math.PI),r.closePath(),r.fillStyle=e,r.fill(),n.toDataURL()}function hr(e){function t(){a.moveTo(19.5,43),a.lineTo(20.5,43),a.lineTo(21.5,43.5),a.lineTo(25.5,36.2),a.lineTo(24,35.5),a.lineTo(23,35.5),a.lineTo(20.5,36.5),a.lineTo(19.5,36.5),a.lineTo(17,35.5),a.lineTo(16,35.5),a.lineTo(14.5,36.2),a.lineTo(18.5,43.5),a.closePath()}function n(){a.moveTo(25.5,12),a.lineTo(25.5,8),a.lineTo(14.5,8),a.lineTo(14.5,12),a.closePath()}var r=Ne(40,48),a=r.getContext("2d");return a.beginPath(),t(),a.fillStyle="#ffcb6b",a.fill(),a.beginPath(),n(),a.fillStyle="#d1ebff",a.fill(),a.beginPath(),a.moveTo(19.5,48),a.lineTo(13,36),a.lineTo(13,1),a.lineTo(14,0),a.lineTo(26,0),a.lineTo(27,1),a.lineTo(27,36),a.lineTo(20.5,48),a.closePath(),t(),a.moveTo(25.5,12),a.lineTo(25.5,8),a.lineTo(14.5,8),a.lineTo(14.5,12),a.closePath(),a.fillStyle=e,a.fill(),r.toDataURL()}function pr(e,t,n){return n||(n=1),function(r){var a=document.createElement("canvas");a.width=e,a.height=t;var i=a.getContext("2d");r||(r="rgba(128,128,128,0.125)"),"transparent"!=r&&(i.fillStyle=r,i.fillRect(0,0,e,t));var o=e/n,s=t/n,l={width:o,height:s,transformOrigin:o/2+"px + "+s/2+"px",opacity:1};return 1>n&&(l.imageRendering="pixelated"),{img:a,css:l}}}function fr(e){if(!e)return null;if(e in Mi)return Mi[e];var t=e.match(/^(\d+)x(\d+)(?:\/(\d+))?$/);return t?pr(parseFloat(t[1]),parseFloat(t[2]),t[3]&&parseFloat(t[3])):null}function dr(e,t){var n=e.width||e.height||256,r=e.height||e.width||256,a=e.subpixel||1/(e.scale||1),i=e.color||"transparent",o=pr(n,r,a);return o(i)}function gr(n,r){if(!n)return null;if(e.isPlainObject(n))return dr(n,r);if(e.isFunction(n)&&(n.helpname||n.name)&&(n=n.helpname||n.name),n.constructor===jQuery){if(!n.length)return null;n=n.get(0)}if(n.tagName)return"CANVAS"!=n.tagName&&"IMG"!=n.tagName&&"VIDEO"!=n.tagName?null:{img:n,css:{opacity:1}};var a=n.toString().trim().split(/\s+/),i=null,o=null;if(a.length&&(o=fr(a[a.length-1]),o&&a.pop()),a.length&&ar(a.join(" "))&&(i=a.join(" "),a.length=0),!o&&i&&(o=fr(r)),o)return o(i);if(/\//.test(n)||(n=Yt(n)),/\//.test(n)){var s=At(n).hostname;return!Pt(s)&&Pt(t.location.hostname)&&(n=t.location.protocol+"//"+t.location.host+"/proxy/"+Ct(n)),{url:n,css:{transformOrigin:"50% 50%",opacity:1}}}return null}function mr(e){return null==e?"":String(e).replace(/[&<>"]/g,function(e){return Ti[e]})}function vr(n,r,a){var i=n&&/^[a-zA-Z]\w*$/.exec(n),o=n&&/^<.*>$/.exec(n),s=gr(n,a)||null==n&&gr(a);i&&e("#"+n).length&&(i=!1);var l;s?(l=e("<canvas>"),lt(l,s)):l=e(o?n:"<div>"+mr(n)+"</div>"),n&&"object"==typeof n&&("id"in n&&l.attr("id",n.id),"class"in n&&l.addClass(n["class"])),l.css({position:"absolute",display:"table",top:0,left:0}),(!r||9==r.nodeType||e.isWindow(r))&&(r=Se()),l.appendTo(r);var u=_(l[0]);return l.css({top:-u[1],left:-u[0]}),l.css({turtlePosition:Q(l[0],e(r).pagexy(),null,0,0),turtleRotation:0,turtleScale:1}),l.addClass("turtle"),i&&(l.attr("id",n),mi&&!t.hasOwnProperty(n)&&(t[n]=l)),l}function yr(e,t){if("number"==typeof e)return e=Math.ceil(e),"number"==typeof t?(t=Math.ceil(t),Math.floor(Math.random()*(t-e)+e)):Math.floor(Math.random()*e);if("object"==typeof e&&e&&e.length&&e.slice)return e[Math.floor(Math.random()*e.length)];if("normal"==e){var n,r,a,i,o;do n=Math.random(),r=1.7156*(Math.random()-.5),a=n-.449871,i=Math.abs(r)+.386595,o=a*a+i*(.196*i-.25472*a);while(o>.27597&&(o>.27846||r*r>-4*Math.log(n)*n*n));return r/n}return"position"==e?{pageX:yr(R()+1),pageY:yr(j()+1)}:"color"==e?"hsl("+Math.floor(360*Math.random())+",100%,50%)":"gray"==e?"hsl(0,0,"+Math.floor(100*Math.random())+"%)":e===!0?Math.random()>=.5:Math.random()}function br(t,n){n||"function"!=typeof t||(n=t,t=30);var r=null,a=Math.max(Math.floor(1e3/Math.max(1/86400,t)),0);if(Jn()){var i=e(di);i.plan(function(){r=n})}else r=n;var o={fn:n,timer:setInterval(function(){if(r)try{Ci++,Si.push(o),r()}finally{Ci--,Si.pop(o)}},a)};return _i.push(o),o.timer}function kr(e){for(var t=[],n=0;n<_i.length;++n){var r=_i[n];null==e||e==r.timer||e==r.fn?clearInterval(_i[n].timer):t.push(_i[n])}_i=t}function wr(e){null==e&&Si.length&&(e=Si[Si.length-1].timer),kr(e)}function xr(n,r){void 0===r&&e.isFunction(n)&&(r=n,n=1),Ai&&(t.clearInterval(Ai),Ai=null),r&&n&&(Ai=t.setInterval(function(){try{Ci++,r()}finally{Ci--}},1e3/n))}function Mr(t){return void 0===t?1e3/e.fx.speeds.turtle:void(e.fx.speeds.turtle=t>0?1e3/t:0)}function Tr(n){void 0===n&&(n=""),e("[id]").each(function(r,a){t[n+a.id]=e("#"+a.id)}),mi=!0}function _r(n){if(void 0===n&&(n="last"),Pi&&e(t).off(e.map(fi,function(e,t){return t}).join(" "),Pi),n||""===n){Pi=function(e){var r,a=[n+e.type];for((e.originalEvent||e)instanceof MouseEvent&&a.push(n+"mouse"),r=0;r<a.length;++r){var i,o=a[r],s=t[o];if(s&&s.__proto__===e.__proto__){for(i in s)s.hasOwnProperty(i)&&delete s[i];for(i in e)e.hasOwnProperty(i)&&(s[i]=e[i])}else t[o]=e}},t[n+"mouse"]=new e.Event;for(var r in fi)t[n+r]=new e.Event;e(t).on(e.map(fi,function(e,t){return t}).join(" "),Pi)}}function Sr(n){var r=10,a=Ar(),i=e(t).height()+e(t).scrollTop()+r>=e("html").outerHeight(!0);if(n(),i){var o=e(t).scrollTop(),s=Math.min(a,e("html").outerHeight(!0)-e(t).height());s>o&&e(t).scrollTop(s)}}function Ar(){if(!qi.timer){qi.timer=setTimeout(function(){qi.timer=null},0);var n=e("body").offset(),r=n?n.top:8;qi.bottomSeen=Math.min(e(t).height()+e(t).scrollTop(),e("body").height()+r)}return qi.bottomSeen}function Cr(n){var r=e(t).scrollTop();n(),e(t).scrollTop(r)}function Pr(){var e=document.body.lastChild;return e&&"PRE"==e.tagName||(e=document.createElement("pre"),document.body.appendChild(e)),e}function qr(){var e=arguments;Sr(function(){for(var t=Pr(),n=0;n<e.length;n++)t.appendChild(document.createTextNode(String(e[n])))})}function Xr(t,n){var r=e("<div>").css({display:"inline-block",verticalAlign:"top",textAlign:"center",height:"1.2em",width:"1.2em",maxWidth:"1.2em",overflow:"hidden"}).appendTo(Pr()),a=function(){null!=t&&r.css({background:t}),null!=n&&r.text(n)};if(di){var i=e(di);Yn.call(i,null,r),i.eq(0).plan(a)}else a()}function Yr(){var e=this;Sr(function(){e.result.appendTo("body"),e.setup&&e.setup()})}function Nr(t,n){var r="<"+n+' style="display:table">',a="</"+n+">";if(void 0===t||null===t)return{result:e(r+"<br>"+a)};if(t.jquery||t instanceof Element&&(t=e(t)))return{result:t};var i=null;return t=""+t,/^\s*<.*>\s*$/.test(t)&&(i=e(t)),(null==i||1!=i.length||1!=i[0].nodeType)&&(i=e(r+t+a)),{result:i}}function Or(t,n){function r(t){return function(r){u||p&&"change"==r.type||(u=!0,e(this).prop("checked",!0),l.find("input[type=radio]").prop("disabled",!0),n(t))}}function a(e){return function(){u||(h=e,i())}}function i(e){e||(p+=1,setTimeout(function(){p-=1},0),l.find("input").eq(h).prop("checked",!0)),
l.find("input").eq(h).focus()}function o(t,n){e.isFunction(t)&&(t=(c+1).toString());var i=e.isFunction(n)||null==n?t:n,o=e('<input type="radio" name="menu" class="turtleinput">').attr("value",i).on("change click",r(n)),s=e('<label style="display:table">').append(o).append(t).on("click",r(n)).on("mousedown",a(c)),u=t&&t.toString().substr(0,1).toUpperCase();!u||u in f||(f[u]=c),c+=1,l.append(s)}var s,l=e("<form>").css({display:"table",marginLeft:"20px"}).submit(function(){return!1}),u=!1,c=0,h=0,p=0,f={};if(n||(n=function(t){e.isFunction(t)&&t.call(null)}),e.isArray(t))for(var d=0;d<t.length;++d)o(t[d],t[d]);else if(e.isPlainObject(t))for(s in t)o(s,t[s]);else o(t,t);return l.on("keydown",function(e){if(e.which>=37&&e.which<=40||32==e.which){var t=l.find("input").index(l.find(":checked"));return h=t>=0&&h!=t?t:0>t?0:e.which>=39||32==e.which?(h+1)%c:(h+c-1)%c,i(),!1}13==e.which?l.find(":checked").click():String.fromCharCode(e.which)in f&&(h=f[String.fromCharCode(e.which)],i())}),{result:l,setup:function(){Cr(function(){i(!0)})}}}function Er(t,n){e.isFunction(t)&&void 0===n&&(n=t,t=null),(null===t||void 0===t)&&(t="button");var r=e('<button class="turtleinput">'+mr(t)+"</button>");return n&&r.click(n),{result:r}}function jr(n,r,a){function i(){p||(p=setTimeout(function(){p=null},1e3))}function o(){if(!s())return!1;var t=u.val();p&&f==t||(i(),f=t,u.remove(),c.remove(),h.append(t).css({display:"table"}),("number"==a||"auto"==a&&e.isNumeric(t)&&""+parseFloat(t)==t)&&(t=parseFloat(t)),h.prop("value",t),r&&setTimeout(function(){r.call(h,t)},0))}function s(){if("numeric"!=a)return!0;var t=u.val(),n=t.replace(/[^0-9\.]/g,"");return t==n&&e.isNumeric(n)?!0:(u.val(n),!1)}function l(e){if(13==e.which){if(!s())return!1;o()}return"voice"==a&&d&&(d.abort(),d=null),"numeric"==a&&e.which>=32&&e.which<=127&&(e.which<"0".charCodeAt(0)||e.which>"9".charCodeAt(0))&&(e.which!=".".charCodeAt(0)||~u.val().indexOf("."))?!1:void 0}e.isFunction(n)&&!r&&(r=n,n=null),a||(a="auto"),n=e.isNumeric(n)||n?n:"&rArr;";var u=e('<input class="turtleinput">').css({margin:0,padding:0}),c=e("<button>Submit</button>").css({marginLeft:4}),h=e('<label style="display:table">'+n+"&nbsp;</label>").append(u).append(c),p=null,f=u.val(),d=null;return u.on("keypress keydown",l),c.on("click",o),{result:h,setup:function(){if(i(),"text"==a||"voice"==a){var e=h.parent().width(),n=e+h.offset().left-u.offset().left,r=Math.max(256,e/2),s=r>n?e:n,l=u.outerWidth(!0)-u.width();u.width(s-l)}if("number"==a&&u.attr("type","number"),"voice"==a){c.css({display:"none"});var p=t.SpeechRecognition||t.webkitSpeechRecognition;if("function"==typeof p)try{d=new p,d.continuous=!1,d.interimResults=!0,u.css({backgroundColor:"lightyellow",color:"gray",backgroundImage:"url("+Xi+")",backgroundRepeat:"no-repeat",backgroundPosition:"center"}),d.onspeechstart=function(){u.css({background:"lightgreen"})},d.onend=function(){u.css({color:"",backgroundColor:"",backgroundImage:"",backgroundRepeat:"",backgroundPosition:""}),u.val(f),o()},d.onresult=function(e){var t=e.results[0][0].transcript,n=e.results[0][0].confidence,r=128-128*n;e.results[0].isFinal&&(r=0,f=t),u.css({color:Fr("rgb",r,r,r)}),u.val(t)},d.start()}catch(g){console.log(g)}}Cr(function(){u.focus()})}}}function Rr(t,n){e.isNumeric(n)&&(n={height:n});var r=e("<img>");return t&&r.attr("src",Yt(t)),n&&r.css(n),{result:r}}function Ir(t,n,r,a){var i,o,s=null;if(e.isArray(t))for(a=r,r=n,s=t,t=s.length,n=0,i=0;t>i;i++)n=e.isArray(s[i])?Math.max(n,s[i].length):Math.max(n,1);var l=["<table>"];for(i=0;t>i;i++){for(l.push("<tr>"),o=0;n>o;o++)s?e.isArray(s[i])&&o<s[i].length?l.push("<td>"+mr(s[i][o])+"</td>"):e.isArray(s[i])||0!=o?l.push("<td></td>"):l.push("<td>"+mr(s[i])+"</td>"):l.push("<td></td>");l.push("</tr>")}l.push("</table>");var u=e(l.join("")),c={borderCollapse:"collapse",width:"35px",height:"35px",border:"1px solid black",tableLayout:"fixed",textAlign:"center",margin:"0",padding:"0"};return u.css(e.extend({},c,{width:"auto",height:"auto",maxWidth:"auto",border:"none"},a)),u.find("td").css(e.extend({},c,r)),{result:u}}function Fr(e,t){return e+"("+Array.prototype.join.call(t,",")+")"}function Dr(e,t,n){var r=0,a=[],i={};for(var o in n){var s=n[o];for(r=t;r<e.length;++r)if(!~a.indexOf(r)){if("*"==s)break;if(s instanceof RegExp&&s.test(e[r]))break;if(s instanceof Function&&s(e[r]))break;if(s==typeof e[r])break}r<e.length&&(a.push(r),i[o]=e[r])}if(a.length+t<e.length){var l=[];for(r=t;r<e.length;++r)~a.indexOf(r)||l.push(e[r]);i.extra=l}return i}function Lr(t){if(0===arguments.length)t={};else if(2==arguments.length){var n={};n[arguments[0]]=arguments[1],t=n}else 1==arguments.length&&"function"==typeof arguments[0]&&(t={eval:arguments[0]});return"jQuery"in t&&(e=t.jQuery),"eval"in t&&(Vi[""].e=t.eval),"this"in t&&(Vi[""].t=t["this"]),"element"in t&&(Di=t.element),"autoscroll"in t&&(Fi=t.autoscroll),"linestyle"in t&&(Ri=t.linestyle),"depth"in t&&(Ii=t.depth),"panel"in t&&(Li=t.panel),"height"in t&&(Ui=t.height),"title"in t&&($i=t.title),"console"in t&&(Bi=t.console),"history"in t&&(Qi=t.history),"coffee"in t&&(Zi=t.coffee),"abbreviate"in t&&(uo=t.abbreviate),"consolehook"in t&&(co=t.consolehook),"consolelog"in t&&(zi=t.consolelog),"noconflict"in t&&Ur(t.noconflict),Li&&(Di="#_testlog",Fi="#_testscroll",Li===!0&&Pa()),zi===!0&&Ca(),Wr()}function Wr(e,t,n){return arguments.length<=1?(arguments.length||(e=""),Oi+".scope("+ta(e)+","+Ji+",this)"):void(Vi[e]={e:t,t:n})}function Hr(e,t){1==arguments.length&&(t=e,e="");var n=Vi[""].e,r=Vi[""].t;return Vi.hasOwnProperty(e)&&(Vi[e].e&&(n=Vi[e].e),Vi[e].t&&(r=Vi[e].t)),Yi.reportEvent("seeeval",[e,t]),n.call(r,t)}function zr(e){var n=Zi||t.CoffeeScript,r=n.compile(e,{bare:1});return r&&(r=r.replace(eo,"")),r}function $r(){Hi.repr=fa,Hi.html=Vr,Hi.noconflict=Ur,Hi.init=Lr,Hi.scope=Wr,Hi.eval=Hr,Hi.barecs=zr,Hi.here="eval("+Oi+".init())",Hi.clear=wa,Hi.hide=va,Hi.show=ya,Hi.visible=ba,Hi.enter=ka,Hi.js=Ji,Hi.cs="(function(){return eval("+Oi+".barecs(arguments[0]));})",Hi.version=Ei,t[Oi]=Hi}function Br(e){return{name:e,has:t.hasOwnProperty(e),value:t[e]}}function Qr(e){e.has?t[e.name]=e.value:delete t[e.name]}function Ur(e){return e&&"string"==typeof e||(e="see"+(1+Math.random()+"").substr(2)),ji&&Qr(ji),Oi=e,ji=Br(e),$r(),Hi}function Gr(t){function n(e,t){function n(e,t){e.onload=e.onreadystatechange=t}var r=document.createElement("script"),a=document.getElementsByTagName("head")[0],i=1;n(r,function(){!i||r.readyState&&!{loaded:1,complete:1}[r.readyState]||(i=0,t(),n(r,null),a.removeChild(r))}),r.src=e,a.appendChild(r)}return!Ni||e&&e.fn&&e.fn.jquery?void t():void n("//ajax.googleapis.com/ajax/libs/jquery/"+Ni+"/jquery.min.js",function(){e=jQuery.noConflict(!0),t()})}function Vr(e){io.push('<samp class="_log">'),io.push(e),io.push("</samp>"),ma()}function Zr(e){var t=Object.prototype.toString.call(e),n=t.substring(8,t.length-1);if("Object"==n){if("length"in e&&"slice"in e&&"number"==typeof e.length)return"Array";if("originalEvent"in e&&"target"in e&&"type"in e)return Zr(e.originalEvent)}return n}function Jr(e){switch(e){case"String":case"Number":case"Boolean":case"Undefined":case"Date":case"RegExp":case"Null":return!0}return!1}function Kr(e){return e&&e.nodeType&&e.nodeName&&"function"==typeof e.cloneNode}function ea(e,t){return t&&t>3&&e.length>t?e.substring(0,Math.floor(t/2)-1)+"..."+e.substring(e.length-(Math.ceil(t/2)-2)):e}function ta(e,t){function n(e){if(ro.hasOwnProperty(e))return ro[e];var t="0"+e.charCodeAt(0).toString(16);return"\\x"+t.substring(t.length-2)}return-1==e.indexOf('"')||-1!=e.indexOf("'")?ea('"'+ua(e.replace(/[\0-\x1f\x7f-\x9f"\\]/g,n))+'"',t):ea("'"+ua(e.replace(/[\0-\x1f\x7f-\x9f'\\]/g,n))+"'",t)}function na(e,t){var n=Zr(e);if("String"==n)return ta(e,t);if("Undefined"==n||"Null"==n)return n.toLowerCase();if(Jr(n))return""+e;if("Array"==n&&0===e.length)return"[]";if("Object"==n&&ia(e))return"{}";if(Kr(e)&&1==e.nodeType){if(e.hasAttribute("id"))return e.tagName.toLowerCase()+"#"+ua(e.getAttribute("id"));if(e.hasAttribute("class")){var r=e.getAttribute("class").split(" ")[0];if(r)return e.tagName.toLowerCase()+"."+ua(r)}return e.tagName.toLowerCase()}return n}function ra(e){return 3!=e.nodeType||/[^\s]/.exec(e.textContent)}function aa(e){return e.replace(/^\s*\n/,"")}function ia(e,t,n){var r=Zr(e);if(Jr(r))return!0;if(!t&&"Array"==r)return!n||e.length<=n;if(Kr(e))return 9==e.nodeType||11==e.nodeType?!1:1==e.nodeType?null===e.firstChild||null===e.firstChild.nextSibling&&3==e.firstChild.nodeType&&e.firstChild.textContent.length<=n:!0;if("Function"==r){var a=e.toString();return a.length-a.indexOf("{")<=n}if("Error"==r)return!!e.stack;var i=0;for(var o in e)if(e.hasOwnProperty(o)){if(i+=1,t&&!Jr(Zr(e[o])))return!1;if(n&&i>n)return!1}return!0}function oa(e,t){var n;if("outerHTML"in e){n=ia(e,!0,t);var r=e.cloneNode(n).outerHTML,a=null;if(!n){var i=/^(.*)(<\/[^\s]*>$)/.exec(r);i&&(a=i[2],r=i[1])}return[ua(r),a&&ua(a)]}if(1==e.nodeType){for(var o=["<"+e.tagName],s=0;s<e.attributes.length;++s)o.push(oa(e.attributes[s],t)[0]);return n=ia(e,!0,t),n&&e.firstChild?[ua(o.join(" ")+">"+e.firstChild.textContent+"</"+e.tagName+">"),null]:[ua(o.join(" ")+(e.firstChild?">":"/>")),e.firstChild?ua("</"+e.tagName+">"):null]}return 2==e.nodeType?[ua(e.name+'="'+ua(ea(e.value,t),'"')+'"'),null]:3==e.nodeType?[ua(aa(e.textContent)),null]:4==e.nodeType?["<![CDATA["+ua(ea(e.textContent,t))+"]]>",null]:8==e.nodeType?["<!--"+ua(ea(e.textContent,t))+"-->",null]:10==e.nodeType?["<!DOCTYPE "+ua(e.nodeName)+">",null]:[e.nodeName,null]}function sa(e,t){var n=Zr(e);if(Jr(n))return na(e,t);if(Kr(e)){var r=oa(e,t);return r[0]+(r[1]?"..."+r[1]:"")}if("Function"==n){var a=e.toString();return a.length-a.indexOf("{")>t&&(a=a.replace(/\{(?:.|\n)*$/,"").trim()),a}if(("Error"==n||"ErrorEvent"==n)&&"message"in e)return e.message;var i=[];if("Array"==n&&e.length<t){for(var o=e.length>=5,s=o&&e[0],l=0;l<e.length;++l)o&&e[l]!==s&&(o=!1),i.push(na(e[l],t));return o?"["+na(s,t)+"]  "+e.length:"["+i.join(", ")+"]"}if(ia(e,!1,t)){for(var u in e)e.hasOwnProperty(u)&&i.push(la(u)+": "+na(e[u],t));return("Object"==n?"{":n+"{")+i.join(", ")+"}"}return"Array"==n?"Array("+e.length+")":n}function la(e){return/^\w+$/.exec(e)?e:ta(e)}function ua(e,t){var n=/[<>&]/g;return t&&(n=new RegExp("[<>&"+t+"]","g")),e.replace(n,function(e){return"<"==e?"&lt;":">"==e?"&gt;":"&"==e?"&amp;":'"'==e?"&quot;":"&#"+e.charCodeAt(0)+";"})}function ca(e){e=e.replace(/^\s*\n/,"");var t=e.match(/^\s*\S/gm),n=t.length&&t[0].length-1,r=1;for(t.length>1&&"{"==t[0].trim()&&(n=t[1].length-1,r=2);r<t.length;++r)if(n=Math.min(t[r].length-1,n),0>=n)return e;var a=new RegExp("^\\s{"+n+"}","mg");return e.replace(a,"")}function ha(e,t,n,r){if(r.push('<label class="_log"><input type="checkbox"><span>'),e&&r.push(e),Kr(t)){var a=oa(t,10);r.push(a[0]),r.push("</span><ul>");for(var i=t.firstChild;i;i=i.nextSibling)ra(i)&&(3==i.nodeType?(r.push("<li><samp>"),r.push(ca(i.textContent)),r.push("</samp></li>")):ia(i,!0,20)||1>=n?r.push("<li>"+sa(i,20)+"</li>"):ha("",i,n-1,r));r.push("</ul>"),a[1]&&(r.push("<span>"),r.push(a[1]),r.push("</span>")),r.push("</label>")}else{r.push(sa(t,10)),r.push("</span><ul>");var o=Zr(t);if("Function"==o){var s=t.toString(),l=/\{(?:.|\n)*$/.exec(s);l&&(s=l[0]),r.push("<li><samp>"),r.push(ua(ca(s))),r.push("</samp></li>")}else if("Error"==o)r.push("<li><samp>"),r.push(ua(t.stack)),r.push("</samp></li>");else if("Array"==o){for(var u=0;u<Math.min(100,t.length);++u){try{f=t[u]}catch(c){f=c}ia(f,!0,20)||1>=n||"global"==Zr(f)?r.push("<li>"+u+": "+sa(f,100)+"</li>"):ha(u+": ",f,n-1,r)}t.length>100&&r.push("<li>length="+t.length+" ...</li>")}else{var h=0;for(var p in t)if(t.hasOwnProperty(p)){if(h+=1,h>100)continue;var f;try{f=t[p]}catch(c){f=c}ia(f,!0,20)||1>=n||"global"==Zr(f)?(r.push("<li>"),r.push(la(p)),r.push(": "),r.push(sa(f,100)),r.push("</li>")):ha(la(p)+": ",f,n-1,r)}h>100&&r.push("<li>"+h+" properties total...</li>")}r.push("</ul></label>")}}function pa(){if(!no&&!t.document.getElementById("_logcss")){var e=t.document.createElement("style");e.id="_logcss",e.innerHTML=(Ri?"samp._log{"+Ri+"}":"")+to,t.document.head.appendChild(e),no=!0}}function fa(e,t,n){t=t||3;var r=n||[],a=Zr(e);return"Error"==a||"ErrorEvent"==a?(r.push('<span style="color:red;">'),ha("",e,t,r),r.push("</span>")):Jr(a)?r.push(na(e)):ia(e,!0,100)||0>=t?r.push(sa(e,100)):ha("",e,t,r),n?void 0:r.join("")}function da(t,n){switch(typeof t){case"string":return"body"==t?document.body:document.querySelector?document.querySelector(t):e?e(t)[0]:null;case"undefined":return n;case"boolean":return t?n:null;default:return t}}function ga(){var e=!1,t=da(Fi,null);return t&&(e=t.scrollHeight-t.scrollTop-10<=t.clientHeight),e?function(){t.scrollTop=t.scrollHeight-t.clientHeight}:function(){}}function ma(){var e,n=da(Di,null);if(n&&n.appendChild&&io.length){pa();var r=t.document.createElement("samp");r.innerHTML=io.join(""),io.length=0;for(var a=ga();e=r.firstChild;)n.appendChild(e);a()}!ao&&io.length?("auto"==Li&&Pa(),ao=setTimeout(function(){ao=null,ma()},100)):ao&&!io.length&&(clearTimeout(ao),ao=null)}function va(){e("#_testpanel").hide()}function ya(){e("#_testpanel").show()}function ba(){return e("#_testpanel").is(":visible")}function ka(t){e("#_testinput").val(t)}function wa(){oo&&e("#_testlog").find("._log").not("#_testpaneltitle").remove()}function xa(e){return'<samp class="_logcaret" style="color:'+e+';"></samp>'}function Ma(){return t.getSelection?t.getSelection().toString():document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:void 0}function Ta(e){return'<samp class="_log" id="_testpaneltitle" style="font-weight:bold;">'+e+"</samp>"}function _a(){if(Qi){var n,r={height:Ui,history:[]};try{n=t.JSON.parse(t.localStorage[Qi])}catch(a){n=ho||{}}return n&&n.slice&&n.length?(r.history=n,r):(e.extend(r,n),r)}}function Sa(e){if(Qi){var n=_a(),r=!1;if("history"in e&&e.history.length&&(!n.history.length||n.history[n.history.length-1]!==e.history[e.history.length-1])&&(n.history.push(e.history[e.history.length-1]),r=!0),"height"in e&&e.height!==n.height&&(n.height=e.height,r=!0),r)try{t.localStorage[Qi]=t.JSON.stringify(n)}catch(a){ho=n}}}function Aa(){return t.innerHeight||e(t).height()}function Ca(){try{if(zi&&t.console&&!t.console._log&&"function"==typeof t.console.log){var e=t.console._log=t.console.log;t.console.log=function(){e.apply(this,arguments),Hi.apply(this,arguments)};var n=t.console._debug=t.console.debug;t.console.debug=function(){n.apply(this,arguments),Hi.apply(this,arguments)}}}catch(r){}}function Pa(){so||(so=!0,Gr(qa))}function qa(){if(oo)$i&&(e("#_testpaneltitle").length?e("#_testpaneltitle").html($i):e("#_testlog").prepend(Ta($i))),e("#_testpanel").show();else if(!t.document.getElementById("_testlog")&&t.document.body){Ca(),pa();var n=_a(),r=$i?Ta($i):"";n.height>Aa()-50&&(n.height=Math.min(Aa(),Math.max(10,Aa()-50))),e("body").prepend('<samp id="_testpanel" class="turtlefield" style="overflow:hidden;z-index:99;position:fixed;bottom:0;left:0;width:100%;height:'+n.height+'px;background:rgba(240,240,240,0.8);font:10pt monospace;-webkit-transform:translateZ(0);"><samp id="_testdrag" style="cursor:row-resize;height:6px;width:100%;display:block;background:lightgray"></samp><samp id="_testscroll" style="overflow-y:scroll;overflow-x:hidden;display:block;width:100%;height:'+(n.height-6)+'px;"><samp id="_testlog" style="display:block">'+r+'</samp><samp class="_log" style="position:relative;display:block;">'+xa("blue")+'<input id="_testinput" class="_log" style="width:100%;margin:0;border:0;font:inherit;background:rgba(255,255,255,0.8);"></samp></samp>'),oo=!0,ma();var a=0,i={};e("#_testinput").on("keydown",function(t){if(13==t.which){var r=e(this).val();if(e(this).val(""),!r.trim().length||n.history.length&&n.history[n.history.length-1]===r||(n.history.push(r),Sa({history:[r]})),i={},a=0,Vr('<samp class="_log" style="margin-left:-1em;">'+xa("lightgray")+ua(r)+"</samp>"),e(this).select(),r.trim().length&&":"==r.trim()[0]){var o=r.trim().substring(1).trim();if(!o||Vi.hasOwnProperty(o)){Gi=o;var s=o?"scope "+o:"default scope";Vr('<span style="color:blue">switched to '+s+"</span>")}else Vr('<span style="color:red">no scope '+o+"</span>");return}e.turtle.interrupt("reset");var l=!1;try{var u;try{u=Hr(Gi,r)}finally{if(co&&co(r,u))l=!0;else{for(var c=uo.length-1;c>=0&&u!==uo[c];--c);0>c&&Vr(fa(u))}}}catch(t){l||Hi(t)}}else if(38==t.which||40==t.which){i[a]=e(this).val(),a+=38==t.which?1:-1,a=Math.max(0,Math.min(n.history.length,a));var h=i[a]||n.history[n.history.length-a];"undefined"==typeof h&&(h=""),e(this).val(h),this.selectionStart=this.selectionEnd=h.length,t.preventDefault()}}),e("#_testdrag").on("mousedown",function(r){var a,i=this,o=e("#_testpanel").height()+r.pageY,s=e("#_testdrag").height(),l=r.which;return i.setCapture&&i.setCapture(!0),a=function(r){if("blur"!=r.type&&r.which==l){var i=Aa(),u=Math.max(s,Math.min(i,o-r.pageY)),c=ga();e("#_testpanel").height(u),e("#_testscroll").height(u-s),c()}("mouseup"==r.type||"blur"==r.type||"mousemove"==r.type&&r.which!=l)&&(e(t).off("mousemove mouseup blur",a),document.releaseCapture&&document.releaseCapture(),e("#_testpanel").height()!=n.height&&(n.height=e("#_testpanel").height(),Sa({height:n.height})))},e(t).on("mousemove mouseup blur",a),!1}),e("#_testpanel").on("mouseup",function(t){if(!Ma()){var n=e("#_testscroll").scrollTop();e("#_testinput").focus(),e("#_testscroll").scrollTop(n)}})}lo&&oo?clearTimeout(lo):oo||lo||(lo=setTimeout(qa,100))}function Xa(e,t){var n=document.createElement("canvas");t||(t=0),n.width=e.width,n.height=e.height;var r=n.getContext("2d");return r.drawImage(e,0,0),Ya(n,t)}function Ya(e,t){for(var n,r,a=e.getContext("2d"),i=a.getImageData(0,0,e.width,e.height).data,o=[],s=256*t,l=1/0,u=-1,c=0;c<e.height;++c){n=1/0,r=-1;for(var h=0;h<e.width;++h)i[4*c*e.width+4*h+3]>s&&(0>r&&(n=h),r=h);(r>=0||u>=0)&&(o.push({pageX:Math.min(n,l),pageY:c}),o.push({pageX:Math.max(r,u)+1,pageY:c})),l=n,u=r}return u>=0&&(o.push({pageX:l,pageY:e.height}),o.push({pageX:u+1,pageY:e.height})),pe(o)}function Na(e,t){var n=e.getContext("2d"),r=e.width,a=e.height,i=0;if(n.save(),n.beginPath(),n.moveTo(0,0),n.lineTo(r,0),n.lineTo(r,a),n.lineTo(0,a),n.closePath(),t.length)for(n.moveTo(t[0].pageX,t[0].pageY);i<t.length;i+=1)n.lineTo(t[i].pageX,t[i].pageY);n.closePath(),n.clip(),n.clearRect(0,0,r,a),n.restore()}function Oa(e,t,n,r,a){for(var i=0;i<e.length;i++)e[i].pageX=e[i].pageX*t+r,e[i].pageY=e[i].pageY*n+a}"undefined"==typeof globale&&(t=window);var Ea={}.hasOwnProperty,ja=e(function(){}),Ra=!1,Ia=0,Fa=0,Da=[];if(!e.cssHooks)throw"jQuery 1.4.3+ is needed for jQuery-turtle to work";var La=a("transform"),Wa=a("transformOrigin");if(La&&i()){var Ha={attached:!1,surface:null,field:null,ctx:null,canvas:null,timer:null,fieldMouse:!1,fieldHook:!1,subpixel:1},za=document.createElement("a"),$a={},Ba=function(t){function n(t,n){this.constructor=jQuery,this.constructor.prototype=Object.getPrototypeOf(this),(!t||"string"==typeof t||e.isPlainObject(t)||"number"==typeof t)&&(t=vr(t,n,"256x256")),jQuery.fn.init.call(this,t,n,ja)}return r(n,t),n.prototype.pushStack=function(){var e,t,n;for(t=jQuery.fn.pushStack.apply(this,arguments),e=t.length,n=e===this.length;n&&e--;)n=n&&this[e]===t[e];return n?this:t},n}(jQuery.fn.init),Qa=function(t){function n(t){t&&t.jquery&&e.isFunction(t.canvas)&&(t=t.canvas()),!t||"CANVAS"==t.tagName&&"function"==typeof t.getContext||(t=e(t).filter("canvas").get(0)),t&&"CANVAS"==t.tagName&&"function"==typeof t.getContext||(t=null);var r=t?t.parentElement:null,a={width:0,height:0,color:"transparent"};n.__super__.constructor.call(this,a,r),this.each(function(){var e=Le(this);e.speed=1/0,e.drawOnCanvas=t,this.style.display="none",t&&(this.style[La]=ke(ye(t,!0)))})}return r(n,t),n}(Ba),Ua=function(e){function t(e,n){t.__super__.constructor.call(this,vr(e,n,"turtle"))}return r(t,e),t}(Ba),Ga=function(n){function a(t,n){var r="",i=!1,o=!1,s=!1;if(e.isPlainObject(t)){for(var l in t)r+=" "+l+'="'+mr(t[l])+'"';i="src"in t,o="autoplay"in t,s="width"in t||"height"in t,!s||"height"in t||(r+=" height="+Math.round(3*t.width/4)),!s||"width"in t||(r+=" width="+Math.round(4*t.height/3))}o||(r+=" autoplay"),s||(r+=" width=320 height=240"),a.__super__.constructor.call(this,"<video"+r+">"),i||this.capture()}return r(a,n),a.prototype.capture=function(){return this.queue(function(n){var r=this,a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return a?void a.call(navigator,{video:!0},function(a){if(a){var i=Le(r),o=(""+Math.random()).substr(2);i.stream&&i.stream.stop(),i.stream=a,e(r).on("play.capture"+o,function(){e(r).off("play.capture"+o),n()}),r.src=t.URL.createObjectURL(a)}},function(){n()}):void n()})},a.prototype.cut=function(){return this.plan(function(){var e=this.data("turtleData");e.stream&&(e.stream.stop(),e.stream=null),this.attr("src","")})},a}(Ba),Va=function(e){function t(e){var r,l,u,c,h,p,f,d,g,m,v,y=null,b=this;e=o(e,"keys"),m=ai.pitchToMidi(e.lowest),v=ai.pitchToMidi(e.highest);var k=this._geom={};if(k.lineWidth="lineWidth"in e?e.lineWidth:1.5,k.color="color"in e?e.color:"white",k.blackColor="blackColor"in e?e.blackColor:"black",k.lineColor="lineColor"in e?e.lineColor:"black",u=Math.ceil(k.lineWidth),l=422,r=4.2,null!=m&&null!=v?y=a(v)-a(m)+1:"keys"in e&&(y=Math.ceil(e.keys/12*7)),y&&(r=y/5,l=Math.sqrt(42e3*r)+u),p="width"in e?e.width:"height"in e?Math.round((e.height-u)*r+u):l,h="height"in e?e.height:Math.round((p-u)/r+u),y||(y=Math.max(1,Math.round((p-u)/(h-u)*5))),f=Math.min(a(108),Math.ceil(42+(y-1)/2)),k.highest=null!=v?v:null!=m&&"keys"in e?m+e.keys-1:i(null!=m?a(m)+y-1:f),k.lowest=null!=m?m:"keys"in e?k.highest-e.keys+1:Math.min(k.highest,i(a(k.highest)-y+1)),c=a(k.lowest),f=a(k.highest),s(k.highest)&&(f+=1),y=f-c+1,k.kw=(p-u)/y,k.kh=("height"in e?e.height-u:5*k.kw)+(u-k.lineWidth),k.bkw=4*k.kw/7,k.bkh=3*k.kh/5,k.halfex=u/2,k.leftpx=c*k.kw,k.rightpx=(f+1)*k.kw,k.ckw=(3*k.kw-2*k.bkw)/3,k.fkw=(4*k.kw-3*k.bkw)/4,t.__super__.constructor.call(this,{width:Math.ceil(k.rightpx-k.leftpx+u),height:Math.ceil(k.kh+u)}),"timbre"in e)g=e.timbre;else for(d in ai.defaultTimbre)d in e&&(g||(g={}),g[d]=e[d]);return g||(g="piano"),this.css({turtleTimbre:g}),this.on("noteon",function(e){b.drawkey(e.midi,n(e.midi))}),this.on("noteoff",function(e){b.drawkey(e.midi)}),this.draw(),this}function n(e){return c[(e%12+12)%12]}function a(e){return Math.floor((e+7)/12*7)}function i(e){return Math.ceil(e/7*12)-7}function s(e){return l(e)>=8}function l(e){return[1,8,2,9,3,4,10,5,11,6,12,7][(e%12+12)%12]}function u(e,t,n){var r,i,o,u,c,h,p;switch(h=t.halfex+t.kw*a(n)-t.leftpx,p=t.halfex,r=l(n),o=n===t.lowest,c=n===t.highest,i=0,u=0,r){case 1:u=t.kw-t.ckw;break;case 2:u=i=(t.kw-t.ckw)/2;break;case 3:i=t.kw-t.ckw;break;case 4:u=t.kw-t.fkw;break;case 5:i=t.fkw+t.bkw-t.kw,u=2*t.kw-2*t.fkw-t.bkw;break;case 6:i=2*t.kw-2*t.fkw-t.bkw,u=t.fkw+t.bkw-t.kw;break;case 7:i=t.kw-t.fkw;break;case 8:h+=t.ckw;break;case 9:h+=2*t.ckw+t.bkw-t.kw;break;case 10:h+=t.fkw;break;case 11:h+=2*t.fkw+t.bkw-t.kw;break;case 12:h+=3*t.fkw+2*t.bkw-2*t.kw}return o&&(i=0),c&&(u=0),s(n)?(e.moveTo(h,p+t.bkh),e.lineTo(h+t.bkw,p+t.bkh),e.lineTo(h+t.bkw,p),e.lineTo(h,p),e.closePath()):(e.moveTo(h,p+t.kh),e.lineTo(h+t.kw,p+t.kh),e.lineTo(h+t.kw,p+t.bkh),e.lineTo(h+t.kw-u,p+t.bkh),e.lineTo(h+t.kw-u,p),e.lineTo(h+i,p),e.lineTo(h+i,p+t.bkh),e.lineTo(h,p+t.bkh),e.closePath())}r(t,e),t.prototype.drawkey=function(e,t){var n,r=this._geom;if(r.lowest<=e&&e<=r.highest)return null==t&&(t=s(e)?r.blackColor:r.color),n=this.canvas().getContext("2d"),n.save(),n.beginPath(),u(n,r,e),n.fillStyle=t,n.strokeStyle=r.lineColor,n.lineWidth=r.lineWidth,n.fill(),n.stroke(),n.restore()},t.prototype.draw=function(){for(var e=this._geom.lowest;e<=this._geom.highest;++e)this.drawkey(e)};var c=["#db4437","#ff5722","#f4b400","#ffeb3b","#cddc39","#0f9d58","#00bcd4","#03a9f4","#4285f4","#673ab7","#9c27b0","#e91e63"];return t}(Ba),Za=!1,Ja=function(){for(var e="undefined"!=typeof t?t.navigator.userAgent:"",n=/OS X/.test(e),r=/Opera/.test(e),a=!/like Gecko/.test(e)&&!r,i={0:"null",1:"mouse1",2:"mouse2",3:"break",4:"mouse3",5:"mouse4",6:"mouse5",8:"backspace",9:"tab",12:"clear",13:"enter",16:"shift",17:"control",18:"alt",19:"pause",20:"capslock",21:"hangulmode",23:"junjamode",24:"finalmode",25:"kanjimode",27:"escape",28:"convert",29:"nonconvert",30:"accept",31:"modechange",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",41:"select",42:"print",43:"execute",44:"snapshot",45:"insert",46:"delete",47:"help",91:"meta",92:"meta",93:n?"meta":"menu",95:"sleep",106:"numpad*",107:"numpad+",108:"numpadenter",109:"numpad-",110:"numpad.",111:"numpad/",144:"numlock",145:"scrolllock",160:"shiftleft",161:"shiftright",162:"controlleft",163:"controlright",164:"altleft",165:"altright",166:"browserback",167:"browserforward",168:"browserrefresh",169:"browserstop",170:"browsersearch",171:"browserfavorites",172:"browserhome",173:n&&a?"-":"volumemute",174:"volumedown",175:"volumeup",176:"mediatracknext",177:"mediatrackprev",178:"mediastop",179:"mediaplaypause",180:"launchmail",181:"launchmediaplayer",182:"launchapp1",183:"launchapp2",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"meta",224:"meta",226:"altgraph",229:"process",231:r?"`":"unicode",246:"attention",247:"crsel",248:"exsel",249:"eraseeof",250:"play",251:"zoom",252:"noname",253:"pa1",254:"clear"},o=48;91>o;++o)i[o]=String.fromCharCode(o).toLowerCase();for(o=96;106>o;++o)i[o]="numpad"+(o-96);for(o=112;136>o;++o)i[o]="f"+(o-111);return i}(),Ka=function(){function e(e,t){return function(r){var a,i=r.which;e?a="mouse"+i:(!i&&r.whichSynth&&(i=r.whichSynth),a=Ja[i],i>=160&&165>=i&&n(a.replace(/(?:left|right)$/,""),t)),n(a,t)}}function n(e,t){null!=e&&(t?l[e]=!0:delete l[e])}function r(){for(var e in l)delete l[e]}function a(e){r();for(var n in s)e?t.addEventListener(n,s[n],!0):t.removeEventListener(n,s[n])}function i(){var e,t=[];for(e in l)l[e]&&t.push(e);return t}function o(e){return Dt(),e?(e=e.replace(/\s/g,"").toLowerCase(),l[e]?!0:!1):i()}var s={mousedown:e(1,1),mouseup:e(1,0),keydown:e(0,1),keyup:e(0,0),blur:r},l={};return o.enable=a,o.list=i,o}(),ei=null,ti={C:0,D:2,E:4,F:5,G:7,A:9,B:11,c:12,d:14,e:16,f:17,g:19,a:21,b:23},ni={"^":1,"":0,"=":0,_:-1},ri=["C","^C","D","_E","E","F","^F","G","_A","A","_B","B","c","^c","d","_e","e","f","^f","g","_a","a","_b","b"],ai=function(){function e(e){this._atop=tn(),this._timbre=t(e,this._atop),this._queue=[],this._minQueueTime=1/0,this._maxScheduledTime=0,this._unsortedQueue=!1,this._startSet=[],this._finishSet={},this._cleanupSet=[],this._callbackSet=[],this._handlers={},this._now=null,en()&&this.silence()}function t(e,t){e||(e={}),"string"==typeof e&&(e={wave:e});var n,r={},i=t&&t.wavetable&&t.wavetable[e.wave];for(n in a)e.hasOwnProperty(n)?r[n]=e[n]:i&&i.defs&&i.defs.hasOwnProperty(n)?r[n]=i.defs[n]:r[n]=a[n];return r}function n(){for(var e=tn().ac,t=2*e.sampleRate,n=e.createBuffer(1,t,e.sampleRate),r=n.getChannelData(0),a=0;t>a;a++)r[a]=2*Math.random()-1;return n}function r(e,t,r){if("noise"==t){var a=e.ac.createBufferSource();return a.buffer=n(),a.loop=!0,a}var i,o,s,l,u=e.wavetable,c=e.ac.createOscillator();try{if(u.hasOwnProperty(t)){if(o=u[t].wave,u[t].freq){s=0;for(i in u[t].freq)l=Number(i),r>l&&l>s&&(s=l,o=u[t].freq[s])}!c.setPeriodicWave&&c.setWaveTable?c.setWaveTable(o):c.setPeriodicWave(o)}else c.type=t}catch(h){window.console&&window.console.log(h),c.type="square"}return c.frequency.value=r,c}e.timeOffset=.0625,e.dequeueTime=.5,e.bufferSecs=2,e.toneLength=1,e.cleanupDelay=.1,e.prototype.setTimbre=function(e){this._timbre=t(e,this._atop)},e.prototype.getTimbre=function(e){return t(this._timbre,this._atop)},e.prototype.setVolume=function(e){this._out&&(isNaN(e)||(this._out.gain.value=e))},e.prototype.getVolume=function(e){return this._out?this._out.gain.value:0},e.prototype.silence=function(){var e,t,n,r=1;this._queue.length=0,this._minQueueTime=1/0,this._maxScheduledTime=0,this._startSet.length=0,t=this._finishSet,this._finishSet={},n=this._callbackSet,this._callbackSet=[],this._out&&(this._out.disconnect(),r=this._out.gain.value),this._atop=tn(),this._out=this._atop.ac.createGain(),this._out.gain.value=r,this._out.connect(this._atop.out);for(e in t)this._trigger("noteoff",t[e]);for(e=0;e<n.length;++e)n[e].callback()},e.prototype.now=function(){return null!=this._now?this._now:(this._startPollTimer(!0),this._now)},e.prototype.on=function(e,t){this._handlers.hasOwnProperty(e)||(this._handlers[e]=[]),this._handlers[e].push(t)},e.prototype.off=function(e,t){if(this._handlers.hasOwnProperty(e))if(t){var n,r=this._handlers[e];for(n=0;n<r.length;++n)r[n]===t&&(r.splice(n,1),n-=1)}else this._handlers[e]=[]},e.prototype._trigger=function(e,t){var n,r=this._handlers[e];if(r){if(1==r.length)return void r[0](t);for(r=r.slice(),n=0;n<r.length;++n)r[n](t)}},e.prototype._makeSound=function(t){var n,a,i,o,s=t.timbre||this._timbre,l=t.time+e.timeOffset,u=l+t.duration,c=Math.min(u,l+s.attack),h=s.decay*Math.pow(440/t.frequency,s.decayfollow),p=c,f=u+s.release,d=s.detune&&1!=s.detune,g=s.gain*t.velocity*(d?.5:1),m=this._atop.ac;if(t.duration>0&&t.velocity>0){for(n=m.createGain(),n.gain.setValueAtTime(0,l),n.gain.linearRampToValueAtTime(g,c);c+1/32>p&&u>p+1/256;)p+=1/256,n.gain.linearRampToValueAtTime(g*(s.sustain+(1-s.sustain)*Math.exp((c-p)/h)),p);n.gain.setTargetAtTime(g*s.sustain,p,h),n.gain.setValueAtTime(g*(s.sustain+(1-s.sustain)*Math.exp((c-u)/h)),u),n.gain.linearRampToValueAtTime(0,f),n.connect(this._out),!s.cutoff&&!s.cutfollow||s.cutoff==1/0?a=n:(a=m.createBiquadFilter(),a.frequency.value=s.cutoff+t.frequency*s.cutfollow,a.Q.value=s.resonance,a.connect(n)),i=r(this._atop,s.wave,t.frequency),i.connect(a),i.start(l),i.stop(f),d&&(o=r(this._atop,s.wave,t.frequency*s.detune),o.connect(a),o.start(l),o.stop(f)),t.gainNode=n,t.oscillators=[i],d&&t.oscillators.push(o),t.cleanuptime=f}else t.duration=0;this._startSet.push(t)},e.prototype._truncateSound=function(t,n){if(n<t.time+t.duration&&(t.duration=Math.max(0,n-t.time),t.gainNode)){var r,a=t.timbre||this._timbre,i=t.time+e.timeOffset,o=n+e.timeOffset,s=Math.min(o,i+a.attack),l=a.decay*Math.pow(440/t.frequency,a.decayfollow),u=o+a.release,c=u+e.cleanupDelay,h=a.detune&&1!=a.detune,p=a.gain*t.velocity*(h?.5:1),f=t.gainNode;if(f.gain.cancelScheduledValues(o),i>=o?f.gain.setValueAtTime(0,o):s>=o?f.gain.linearRampToValueAtTime(p*(o-i)/(s-i)):f.gain.setValueAtTime(p*(a.sustain+(1-a.sustain)*Math.exp((s-o)/l)),o),f.gain.linearRampToValueAtTime(0,u),t.oscillators)for(r=0;r<t.oscillators.length;++r)t.oscillators[r].stop(u);t.cleanuptime=c}},e.prototype._doPoll=function(){if(this._pollTimer=null,this._now=null,Ra)return void this.silence();var t,n,r,a,i,o,s,l,u=this._atop.ac.currentTime+5e-4,c=[];if(this._minQueueTime-u<=e.bufferSecs){for(this._unsortedQueue&&(this._queue.sort(function(e,t){return e.time!=t.time?e.time-t.time:e.duration!=t.duration?e.duration-t.duration:e.frequency-t.frequency}),this._unsortedQueue=!1),t=0;t<this._queue.length&&!(this._queue[t].time-u>e.bufferSecs);++t);if(t>0){for(n=this._queue.splice(0,t),t=0;t<n.length;++t)this._makeSound(n[t]);this._minQueueTime=this._queue.length>0?this._queue[0].time:1/0}}for(t=0;t<this._cleanupSet.length;++t)i=this._cleanupSet[t],i.cleanuptime<u&&(i.gainNode&&(i.gainNode.disconnect(),i.gainNode=null),this._cleanupSet.splice(t,1),t-=1);for(a in this._finishSet)i=this._finishSet[a],r=i.time+i.duration,u>=r&&(c.push({order:[r,0],f:this._trigger,t:this,a:["noteoff",i]}),i.cleanuptime!=1/0&&this._cleanupSet.push(i),delete this._finishSet[a]);for(t=0;t<this._callbackSet.length;++t)l=this._callbackSet[t],r=l.time,u>=r&&(c.push({order:[r,1],f:l.callback,t:null,a:[]}),this._callbackSet.splice(t,1),t-=1);for(t=0;t<this._startSet.length;++t)this._startSet[t].time<=u&&(s=i=this._startSet[t],a=i.frequency,o=null,this._finishSet.hasOwnProperty(a)&&(o=this._finishSet[a],
o.time<i.time||o.time==i.time&&o.duration<i.duration?(this._truncateSound(o,i.time),c.push({order:[i.time,0],f:this._trigger,t:this,a:["noteoff",o]}),delete this._finishSet[a]):(this._truncateSound(i,o.time),o=i)),this._startSet.splice(t,1),t-=1,i.duration>0&&i.velocity>0&&o!==i&&(this._finishSet[a]=i,c.push({order:[i.time,2],f:this._trigger,t:this,a:["noteon",i]})));for(this._startPollTimer(),c.sort(function(e,t){return e.order[0]!=t.order[0]?e.order[0]-t.order[0]:e.order[1]-t.order[1]}),t=0;t<c.length;++t)l=c[t],l.f.apply(l.t,l.a)},e.prototype._startPollTimer=function(t){if(!this._pollTimer||null==this._now){var n,r,a=this,i=function(){a._doPoll()},o=1/0;if(this._pollTimer&&(clearTimeout(this._pollTimer),this._pollTimer=null),t)return this._now=rn(),void(this._pollTimer=setTimeout(i,0));for(n=0;n<this._startSet.length;++n)o=Math.min(o,this._startSet[n].time);for(n in this._finishSet)o=Math.min(o,this._finishSet[n].time+this._finishSet[n].duration);for(n=0;n<this._callbackSet.length;++n)o=Math.min(o,this._callbackSet[n].time);this._cleanupSet.length>0&&(o=Math.min(o,this._cleanupSet[0].cleanuptime+1)),o=Math.min(o,this._minQueueTime-e.dequeueTime),r=Math.max(.001,o-this._atop.ac.currentTime),isNaN(r)||r==1/0||(this._pollTimer=setTimeout(i,Math.round(1e3*r)))}},e.prototype.tone=function(t,n,r,i,o,s){if(this._atop){"object"==typeof t&&(null==r&&(r=t.velocity),null==n&&(n=t.duration),null==i&&(i=t.delay),null==o&&(o=t.timbre),null==s&&(s=t.origin),t=t.pitch);var l,u;if(t||(t="C"),isNaN(t)?(l=sn(t),u=an(l)):(u=Number(t),0>u?(l=-u,u=an(l)):l=on(u)),o||(o=this._timbre),o!==this._timbre){var c,h=o;o={};for(c in a)c in h?o[c]=h[c]:o[c]=a[c]}var p=(this._atop.ac,this.now()),f=p+(i||0),d={time:f,on:!1,frequency:u,midi:l,velocity:null==r?1:r,duration:null==n?e.toneLength:n,timbre:o,instrument:this,gainNode:null,oscillators:null,cleanuptime:1/0,origin:s};f<p+e.bufferSecs?this._makeSound(d):(!this._unsortedQueue&&this._queue.length&&f<this._queue[this._queue.length-1].time&&(this._unsortedQueue=!0),this._queue.push(d),this._minQueueTime=Math.min(this._minQueueTime,d.time))}},e.prototype.schedule=function(e,t){this._callbackSet.push({time:this.now()+e,callback:t})},e.prototype.play=function(e){var n,r,a,i,o,s,l,u,c,h,p,f,d,g,m,v,y=Array.prototype.slice.call(arguments),b=null,k={},w=0,x=[];if(y.length&&"function"==typeof y[y.length-1]&&(b=y.pop()),!this._atop)return void(b&&b());if(a=0,"object"==typeof y[0]){for(o in y[0])y[0].hasOwnProperty(o)&&(k[o]=y[0][o]);a=1,k.song&&y.push(k.song)}for(;a<y.length;++a)for(n=y[a].split(/\n(?=X:)/),o=0;o<n.length;++o)r=cn(n[o]),r&&(!k.tempo&&r.tempo&&(k.tempo=r.tempo,r.unitbeat&&(k.tempo*=r.unitbeat/(r.unitnote||1))),r.voice&&x.push(r));for(k.tempo||(k.tempo=120),null==k.volume&&(k.volume=1),g=60/k.tempo,o=0;o<x.length;++o){r=x[o];for(h in r.voice)if(i=t(k.timbre||r.voice[h].timbre||r.timbre||this._timbre,this._atop),u=r.voice[h].stems){for(s=0,c=0;c<u.length;++c){for(f=u[c],l=1/Math.sqrt(f.notes.length),p=0;p<f.notes.length;++p)d=f.notes[p],d.holdover||(m=(d.time||f.time)*g,f.staccato?m=Math.min(Math.min(m,g/16),i.attack+i.decay):!d.slurred&&m>=1/8&&(m-=1/32),v=(d.velocity||1)*l*k.volume,this.tone(d.pitch,m,v,s,i,d));s+=f.time*g}w=Math.max(s,w)}}this._maxScheduledTime=Math.max(this._maxScheduledTime,this.now()+w),b&&this.schedule(w,b)};var a=e.defaultTimbre={wave:"square",gain:.1,attack:.002,decay:.4,decayfollow:0,sustain:0,release:.1,cutoff:0,cutfollow:0,resonance:0,detune:0};return e.pitchToMidi=function(e){return"string"==typeof e?sn(e):e},e.midiToPitch=function(e){return"number"==typeof e?ln(e):e},e}(),ii=/^([A-Za-z]):\s*(.*)$/,oi=/(?:\[[A-Za-z]:[^\]]*\])|\s+|%[^\n]*|![^\s!:|\[\]]*!|\+[^+|!]*\+|[_<>@^]?"[^"]*"|\[|\]|>+|<+|(?:(?:\^+|_+|=|)[A-Ga-g](?:,+|'+|))|\(\d+(?::\d+){0,2}|\d*\/\d+|\d+\/?|\/+|[xzXZ]|\[?\|\]?|:?\|:?|::|./g;e.extend(!0,e,{cssHooks:{turtlePenStyle:ze(),turtlePenDown:$e(),turtleSpeed:dt(),turtleEasing:gt(),turtleForward:yt(),turtleTurningRadius:He(),turtlePosition:St("turtlePosition","tx","ty",!0),turtlePositionX:bt("tx",parseFloat,"px",!0),turtlePositionY:bt("ty",parseFloat,"px",!0),turtleRotation:bt("rot",xt,"deg",!0),turtleScale:St("turtleScale","sx","sy",!1),turtleScaleX:bt("sx",l,"",!1),turtleScaleY:bt("sy",l,"",!1),turtleTwist:bt("twi",Te,"deg",!1),turtleHull:ge(),turtleTimbre:Vt(),turtleVolume:Zt()},cssNumber:{turtleRotation:!0,turtleSpeed:!0,turtleScale:!0,turtleScaleX:!0,turtleScaleY:!0,turtleTwist:!0},support:{turtle:!0}}),e.extend(!0,e.fx,{step:{turtlePosition:_t("turtlePosition",!0),turtleRotation:Mt("turtleRotation"),turtleScale:_t("turtleScale",!1),turtleTwist:Mt("turtleTwist")},speeds:{turtle:0}}),mn.helptext=[];var si={rt:xn("rt",1,["<u>rt(degrees)</u> Right turn. Pivots clockwise by some degrees: <mark>rt 90</mark>","<u>rt(degrees, radius)</u> Right arc. Pivots with a turning radius: <mark>rt 90, 50</mark>"],Cn),lt:xn("lt",1,["<u>lt(degrees)</u> Left turn. Pivots counterclockwise by some degrees: <mark>lt 90</mark>","<u>lt(degrees, radius)</u> Left arc. Pivots with a turning radius: <mark>lt 90, 50</mark>"],Cn),fd:xn("fd",1,["<u>fd(pixels)</u> Forward. Moves ahead by some pixels: <mark>fd 100</mark>"],Pn),bk:xn("bk",1,["<u>bk(pixels)</u> Back. Moves in reverse by some pixels: <mark>bk 100</mark>"],Pn),slide:xn("slide",1,["<u>move(x, y)</u> Slides right x and forward y pixels without turning: <mark>slide 50, 100</mark>"],qn),movexy:xn("movexy",1,["<u>movexy(x, y)</u> Changes graphing coordinates by x and y: <mark>movexy 50, 100</mark>"],Xn),moveto:xn("moveto",1,["<u>moveto(x, y)</u> Move to graphing coordinates (see <u>getxy</u>): <mark>moveto 50, 100</mark>","<u>moveto(obj)</u> Move to page coordinates or an object on the page (see <u>pagexy</u>): <mark>moveto lastmousemove</mark>"],Yn),jump:xn("jump",1,["<u>jump(x, y)</u> Move without drawing (compare to <u>slide</u>): <mark>jump 0, 50</mark>"],Nn(qn)),jumpxy:xn("jumpxy",1,["<u>jumpxy(x, y)</u> Move without drawing (compare to <u>movexy</u>): <mark>jump 0, 50</mark>"],Nn(Xn)),jumpto:xn("jumpto",1,["<u>jumpto(x, y)</u> Move without drawing (compare to <u>moveto</u>): <mark>jumpto 50, 100</mark>"],Nn(Yn)),turnto:xn("turnto",1,["<u>turnto(degrees)</u> Turn to a direction. North is 0, East is 90: <mark>turnto 270</turnto>","<u>turnto(x, y)</u> Turn to graphing coordinates: <mark>turnto 50, 100</mark>","<u>turnto(obj)</u> Turn to page coordinates or an object on the page: <mark>turnto lastmousemove</mark>"],function(t,n,r){e.isNumeric(r)&&e.isNumeric(n)&&(n=[n,r],r=null);var a=Ci;return this.plan(function(i,o){if(t.appear(i),e.isWindow(o)||9===o.nodeType)return void t.resolve(i);var s,l,u,c=null,h=null,p=null;if(e.isNumeric(n))l=Me(n),u=Z(o),h={pageX:u.pageX+1024*Math.sin(l),pageY:u.pageY-1024*Math.cos(l)},c=r;else if(e.isArray(n))p=G(o),p[0]-=n[0],p[1]-=n[1];else if(ft(n))h=n;else try{h=e(n).pagexy()}catch(f){return void t.resolve(i)}p||(p=G(o,h));var d=xe(Math.atan2(-p[0],-p[1]));s=ye(o,!0),null!==c&&(l=Me(s.rot),d=P(s.rot,d,null===c?360:c)),d=s.rot+Te(d-s.rot);var g=this.css("turtleTurningRadius");this.css({turtleTurningRadius:0}),this.animate({turtleRotation:d},mt(o,a),vt(o)),this.plan(function(){this.css({turtleTurningRadius:g}),t.resolve(i)})}),this}),home:xn("home",0,["<u>home()</u> Goes home. Jumps to the center without drawing: <mark>do home</mark>"],function(t,n){return this.plan(function(r,a){t.appear(r);var i=this.css("turtlePenDown"),o=this.css("turtleTurningRadius"),s=n||U(a);this.css({turtlePenDown:"up",turtleTurningRadius:0}),this.css({turtlePosition:Q(a,e(s).pagexy(),null,0,0),turtleRotation:0,turtleScale:1}),this.css({turtlePenDown:i,turtleTurningRadius:o}),t.resolve(r)}),this}),copy:xn("copy",0,["<u>copy()</u> makes a new turtle that is a copy of this turtle."],function(t){var n=this.clone().insertAfter(this);return n.hide(),this.plan(function(r,a){t.appear(r);var i=Le(this),o=Le(n);for(var s in i)o[s]=i[s];n.attr("style",this.attr("style"));for(var l in e.cssHooks){var u=this.css(l);n.css(l,u)}var c=this.prop("attributes");for(var h in c)n.attr(c[h].name,c[h].value);var p=n.canvas(),f=this.canvas();if(p&&f){p.width=f.width,p.height=f.height;var d=p.getContext("2d");d.drawImage(f,0,0)}n.show(),t.resolve(r)}),fn(n,this),n}),pen:xn("pen",1,["<u>pen(color, size)</u> Selects a pen. Chooses a color and/or size for the pen: <mark>pen red</mark>; <mark>pen 0</mark>; <mark>pen erase</mark>; <mark>pen blue, 5</mark>.","<u>pen(on-or-off)</u> Turns the pen on or off: <mark>pen off</mark>; <mark>pen on</mark>."],function(t,n,r){var a=Dr(arguments,1,{lineCap:/^(?:butt|square|round)$/,lineJoin:/^(?:bevel|round|miter)$/,lineWidth:e.isNumeric,penStyle:"*"});n=a.penStyle,n&&"function"==typeof n&&(n.helpname||n.name)&&(n=n.helpname||n.name),0===a.lineWidth||null===n?n="none":void 0===n?n="black":e.isPlainObject(n)&&(n=Ie(n));var i=Ci;return this.plan(function(e,r){t.appear(e);var o=!I(r)&&!vn(this),s=o&&Re(this.css("turtlePenStyle")),l=s&&"down"==this.css("turtlePenDown"),u=!1;if(n===!1||n===!0||"down"==n||"up"==n?(this.css("turtlePenDown",n),u=!0):(a.lineWidth&&(n+=";lineWidth:"+a.lineWidth),a.lineCap&&(n+=";lineCap:"+a.lineCap),a.lineJoin&&(n+=";lineJoin:"+a.lineJoin),this.css("turtlePenStyle",n),this.css("turtlePenDown","none"==n?"up":"down")),o){var c=Re(this.css("turtlePenStyle")),h=c&&(c.strokeStyle||c.savePath&&"gray")||s&&s.strokeStyle||"gray",p={},f=c&&"down"==this.css("turtlePenDown"),d=new Ua(h+" pencil",this.parent()),g=this.height();d.css({zIndex:1,turtlePosition:Q(d.get(0),this.pagexy(),null,0,0),turtleRotation:this.css("turtleRotation"),turtleSpeed:1/0}),l?f||(p.turtleForward="+="+g,p.opacity=0):(d.css({turtleForward:"+="+g,opacity:0}),f&&(p.turtleForward="-="+g,p.opacity=1)),s&&!c&&"down"==l?(p.turtleForward="+="+g,p.opacity=0):s==c||s&&c&&s.strokeStyle==c.strokeStyle||(d.css({opacity:0}),p.opacity=1),d.animate(p,mt(r,i)),this.queue(function(e){d.done(function(){d.remove(),e()})})}this.plan(function(){t.resolve(e)})}),this}),fill:xn("fill",0,["<u>fill(color)</u> Fills a path traced using <u>pen path</u>: <mark>pen path; rt 100, 90; fill blue</mark>"],function(t,n){n?e.isPlainObject(n)&&(n=Ie(n)):n="none";var r=Re(n,"fillStyle");return this.plan(function(e,n){t.appear(e),rt(n,r),t.resolve(e)}),this}),dot:xn("dot",0,["<u>dot(color, diameter)</u> Draws a dot. Color and diameter are optional: <mark>dot blue</mark>"],Fn(Dn)),box:xn("box",0,["<u>box(color, size)</u> Draws a box. Color and size are optional: <mark>dot blue</mark>"],Fn(Ln)),arrow:xn("arrow",0,["<u>arrow(color, size)</u> Draws an arrow. <mark>arrow red, 100</mark>"],Fn(Wn)),mirror:xn("mirror",1,["<u>mirror(flipped)</u> Mirrors the turtle across its main axis, or unmirrors if flipped if false. <mark>mirror(true)</mark>"],function(t,n){return this.plan(function(r,a){t.appear(r);var i=e.map(e.css(a,"turtleScale").split(" "),parseFloat);1===i.length&&i.push(i[0]),i[0]*i[1]<0==!n&&(i[0]=-i[0],this.css("turtleScale",i.join(" "))),t.resolve(r)}),this}),twist:xn("twist",1,["<u>twist(degrees)</u> Set the primary direction of the turtle. Allows use of images that face a different direction than 'up': <mark>twist(-90)</mark>"],function(t,n){return this.plan(function(r,a){t.appear(r),e.isWindow(a)||9===a.nodeType||(this.css("turtleTwist",n),t.resolve(r))}),this}),scale:xn("scale",1,["<u>scale(factor)</u> Scales all motion up or down by a factor. To double all drawing: <mark>scale(2)</mark>"],En),grow:xn("grow",1,["<u>grow(factor)</u> Changes the size of the element by a factor. To double the size: <mark>grow(2)</mark>"],jn),pause:xn("pause",1,["<u>pause(seconds)</u> Pauses some seconds before proceeding. <mark>fd 100; pause 2.5; bk 100</mark>","<u>pause(turtle)</u> Waits for other turtles to be done before proceeding. <mark>t = new Turtle().fd 100; pause t; bk 100</mark>"],function(t,n){var r=null,a=null;return n&&e.isFunction(n.done)?(r=n,a=n.done):e.isFunction(n)&&(a=n),a?this.queue(function(){var t=this;a.call(r,function(){var n=t;t=null,n&&e.dequeue(n)})}):this.plan(function(e,r){t.appear(e),bn(r,n),this.plan(t.resolver(e))}),this}),st:xn("st",0,["<u>st()</u> Show turtle. The reverse of <u>ht()</u>. <mark>do st</mark>"],function(e){return this.plan(function(t){e.appear(t),this.show(),e.resolve(t)}),this}),ht:xn("ht",0,["<u>ht()</u> Hide turtle. The turtle can be shown again with <u>st()</u>. <mark>do ht</mark>"],function(e){return this.plan(function(t){e.appear(t),this.hide(),e.resolve(t)}),this}),pu:function(){return this.pen(!1,kn(arguments,0))},pd:function(){return this.pen(!0,kn(arguments,0))},pe:function(){return this.pen("erase",kn(arguments,0))},pf:function(){return this.pen("path",kn(arguments,0))},clip:xn("clip",1,["<u>Clips tranparent bits out of the image of the sprite, and sets the hit region."],function(t,n){return null==n&&(n=.125),this.plan(function(r,a){if(t.appear(r),"CANVAS"==a.tagName){var i=Xa(a,n),o=e(a),s=_(a);Na(a,i),Oa(i,parseFloat(o.css("width"))/a.width,parseFloat(o.css("height"))/a.height,-s[0],-s[1]),o.css("turtleHull",i)}t.resolve(r)})}),say:xn("say",1,['<u>say(words)</u> Say something. Use English words.<mark>say "Let\'s go!"</mark>'],function(e,t){return this.plan(function(n,r){e.appear(n),this.queue(function(r){Bn(t,function(){e.resolve(n),r()})})}),this}),play:xn("play",1,['<u>play(notes)</u> Play notes. Notes are specified in <a href="http://abcnotation.com/" target="_blank">ABC notation</a>.  <mark>play "de[dBFA]2[cGEC]4"</mark>'],function(t,n){return this.plan(function(n,r){t.appear(n),this.queue(function(a){var i=Jt(r),o=e.makeArray(t.args),s=!0,l=function(){t.resolve(n),a()};o.length>0&&e.isPlainObject(o[0])&&o[0].hasOwnProperty("wait")&&(s=o[0].wait),s&&o.push(l),i.play.apply(i,o),s||l()})}),this}),tone:An("tone",["<u>tone(freq)</u> Immediately sound a tone. <u>tone(freq, 0)</u> Stop sounding the tone. <u>tone(freq, v, secs)</u> Play a tone with a volume and duration. Frequency may be a number in Hz or a letter pitch. <mark>tone 440, 5</mark>"],function(e,t){var n=arguments;return this.each(function(e,t){var r=Jt(t);r.tone.apply(r,n)})}),silence:An("silence",["<u>silence()</u> immediately silences sound from play() or tone()."],function(){return this.each(function(e,t){var n=Jt(t);n.silence()})}),speed:xn("speed",1,["<u>speed(persec)</u> Set one turtle's speed in moves per second: <mark>turtle.speed 60</mark>"],function(e,t){return this.plan(function(n,r){e.appear(n),this.css("turtleSpeed",t),this.plan(function(){e.resolve(n)})}),this}),wear:xn("wear",1,["<u>wear(color)</u> Sets the turtle shell color: <mark>wear turquoise</mark>","<u>wear(url)</u> Sets the turtle image url: <mark>wear 'http://bit.ly/1bgrQ0p'</mark>"],function(t,n,r){if(("object"==typeof n||"number"==typeof n)&&"string"==typeof r){var a=r;r=n,n=a}"number"==typeof r&&(r={height:r});var i=gr(n,"turtle"),o=Ci;return i?(r&&e.extend(i.css,r),this.plan(function(e,n){t.appear(e),this.css({backgroundImage:"none"});var r=!1,a=null;lt(this,i,function(){r=!0;var e=a;e&&(a=null,e())}),vn(this)||this.delay(mt(n,o)),r||this.pause({done:function(e){r?e():a=e}}),this.plan(function(){t.resolve(e)})}),this):this}),saveimg:xn("saveimg",1,["<u>saveimg(filename)</u> Saves the turtle's image as a file. <mark>t.saveimg 'mypicture.png'</mark>"],function(e,t){return this.plan(function(n,r){e.appear(n);var a=!1;t||(t="img");var i=this.canvas();if(i){var o=i.toDataURL(),s=/^data:image\/(\w+);base64,(.*)$/i.exec(o);s?(s[1]&&t.toLowerCase().lastIndexOf("."+s[1].toLowerCase())!=Math.max(0,t.length-s[1].length-1)&&(t+="."+s[1]),a=!0,vi.save(t,atob(s[2]),function(){e.resolve(n)})):Hi.html('<span style="color:red">Cannot saveimg: canvas toDataURL did not work as expected.</span>')}else Hi.html('<span style="color:red">Cannot saveimg: not a canvas</span>');a||e.resolve(n)})}),drawon:xn("drawon",1,["<u>drawon(canvas)</u> Switches to drawing on the specified canvas. <mark>A = new Sprite('100x100'); drawon A; pen red; fd 50; done -> A.rt 360</mark>"],function(n,r){return this.each(function(){var e=Le(this);e.drawOnCanvasSync&&fn(this,e.drawOnCanvasSync),e.drawOnCanvasSync=r}),fn(r,this),this.plan(function(a,i){n.appear(a);var o=Le(i);r&&r!==t?r.jquery&&e.isFunction(r.canvas)?o.drawOnCanvas=r.canvas():r.tagName&&"CANVAS"==r.tagName?o.drawOnCanvas=r:(1==r.nodeType||9==r.nodeType)&&(o.drawOnCanvas=e(r).canvas()):o.drawOnCanvas=null,n.resolve(a)})}),label:xn("label",1,["<u>label(text)</u> Labels the current position with HTML: <mark>label 'remember'</mark>","<u>label(text, styles, labelsite)</u> Optional position specifies 'top', 'bottom', 'left', 'right', and optional styles is a size or CSS object: <mark>label 'big', { color: red, fontSize: 100 }, 'bottom'</mark>"],function(t,n,r,a){if((!a||"string"==typeof a)&&(e.isNumeric(r)||e.isPlainObject(r))){var i=a;a=r,r=i}e.isNumeric(a)&&(a={fontSize:a}),null==r&&(r=a&&"labelSide"in a?a.labelSide:a&&"label-side"in a?a["label-side"]:r="rotated scaled");var o=Ci;return this.plan(function(i,s){t.appear(i);for(var l={},u=this.prop("style"),c=0;c<u.length;++c){var h=u[c];/^(?:width|height|opacity|background-image|background-size)$/.test(h)||/transform/.test(h)||(l[e.camelCase(h)]=u[h])}e.extend(l,{position:"absolute",display:"table",top:0,left:0},a);var p=Nr(n,"label").result.css(l).addClass("turtlelabel").appendTo(Se());(p.hasClass("turtleinput")||p.find(".turtleinput").length)&&Ht.apply(p.get(0)),a&&"id"in a&&p.attr("id",a.id),a&&"class"in a&&p.addClass(a["class"]);var f=/\brotated\b/.test(r),d=/\bscaled\b/.test(r);p.css({turtlePosition:Q(p.get(0),this.pagexy(),null,0,0),turtleRotation:f?this.css("turtleRotation"):0,turtleScale:d?this.css("turtleScale"):1});var g=p.get(0).getBoundingClientRect();/\b(?:top|bottom)\b/.test(r)&&(l.top=(/\btop\b/.test(r)?-1:1)*g.height/2),/\b(?:left|right)\b/.test(r)&&(l.left=(/\bleft\b/.test(r)?-1:1)*g.width/2),p.css(l),vn(this)||this.delay(mt(s,o)),this.plan(function(){t.resolve(i)})})}),reload:xn("reload",0,["<u>reload()</u> Does a reload, recycling content (cycling animated gifs)."],function(n){return this.plan(function(r,a){if(n.appear(r),e.isWindow(a)||9===a.nodeType)return t.location.reload(),void n.resolve(r);if(a.src){var i=a.src;a.src="",a.src=i}n.resolve(r)}),this}),hatch:function(t,n){if(this.length){void 0!==n||e.isNumeric(t)||(n=t,t=1);var r=this[0];if(e.isWindow(r)||9===r.nodeType?r=Se():/^(?:br|img|input|hr|canvas)$/i.test(r.tagName)&&(r=r.parentElement),1===t)return vr("function"==typeof n?n(0):n,r,"turtle");for(var a=0,i=[];t>a;++a)i.push(vr("function"==typeof n?n(a):n,r,"turtle")[0]);return e(i)}},pagexy:Mn("pagexy",["<u>pagexy()</u> Page coordinates {pageX:, pageY}, top-left based: <mark>c = pagexy(); fd 500; moveto c</mark>"],function(){if(this.length){var e=Z(this[0]);return{pageX:e.pageX,pageY:e.pageY}}}),getxy:Mn("getxy",["<u>getxy()</u> Graphing coordinates [x, y], center-based: <mark>v = getxy(); move -v[0], -v[1]</mark>"],function(){return this.length?G(this[0]):void 0}),direction:Mn("direction",["<u>direction()</u> Current turtle direction. North is 0; East is 90: <mark>direction()</mark>","<u>direction(obj)</u> <u>direction(x, y)</u> Returns the direction from the turtle towards an object or coordinate. Also see <u>turnto</u>: <mark>direction lastclick</mark>"],function(t,n){if(this.length){var r,a=this[0],i=t;if(void 0!==i){if(r=e(a).pagexy(),e.isNumeric(n)&&e.isNumeric(t)&&(i=[t,n]),e.isArray(i)&&(i=V(a,[i])[0]),!ft(i))try{i=e(i).pagexy()}catch(o){}return i?xe(Math.atan2(i.pageX-r.pageX,r.pageY-i.pageY)):NaN}return e.isWindow(a)||9===a.nodeType?0:te(a)}}),distance:Mn("distance",["<u>distance(obj)</u> Returns the distance from the turtle to another object: <mark>distance lastclick</mark>","<u>distance(x, y)</u> Returns the distance from the turtle to graphing coorindates: <mark>distance(100, 0)</mark>"],function(t,n){if(this.length){var r,a,i=this[0],o=e(i).pagexy();if(e.isNumeric(n)&&e.isNumeric(t)&&(t=[t,n]),e.isArray(t)&&(t=V(i,[t])[0]),!ft(t))try{t=e(t).pagexy()}catch(s){}return t?(r=t.pageX-o.pageX,a=t.pageY-o.pageY,Math.sqrt(r*r+a*a)):NaN}}),canvas:An("canvas",["<u>turtle.canvas()</u> The canvas for the turtle image. Draw on the turtle: <mark>c = turtle.canvas().getContext('2d'); c.fillStyle = red; c.fillRect(10, 10, 30, 30)</mark>"],function(){return this.filter("canvas").get(0)||this.find("canvas").get(0)}),imagedata:An("imagedata",["<u>imagedata()</u> Returns the image data for the turtle. <mark>imdat = imagedata(); write imdat.data.length, 'bytes'</mark>","<u>imagedata(imdat)</u> Sets the image data for the turtle. <mark>imagedata({width: 1, height:1, data:[255,0,0,255]});</mark>"],function(t){var n=this.canvas();if(!n){if(t)throw new Error("can only set imagedata on a canvas like a Sprite");var r=this.filter("img").get(0);if(!r)return;n=Ne(r.naturalWidth,r.naturalHeight),n.getContext("2d").drawImage(r,0,0)}var a=n.getContext("2d");if(!t)return a.getImageData(0,0,n.width,n.height);if(!(t instanceof ImageData)){if("object"!=typeof t||!e.isNumeric(t.width)||!e.isNumeric(t.height)||!(e.isArray(t.data)||t.data instanceof Uint8ClampedArray||t.data instanceof Uint8Array))return;for(var i=a.createImageData(Math.round(t.width),Math.round(t.height)),o=Math.min(t.data.length,i.data.length),s=0;o>s;++s)i.data[s]=t.data[s];t=i}if(t.width!=n.width||t.height!=n.height){var l=_(n);n.width=t.width,n.height=t.height;var u=_(n);It(n,l,u),e(n).css("turtleHull","auto"),a=n.getContext("2d")}a.putImageData(t,0,0)}),cell:An("cell",["<u>cell(r, c)</u> Row r and column c in a table. Use together with the table function: <mark>g = table 8, 8; g.cell(0,2).text 'hello'</mark>"],function(t,n){var r=this.find(e.isNumeric(t)?"tr:nth-of-type("+(t+1)+")":"tr");return r.find(e.isNumeric(n)?"td:nth-of-type("+(n+1)+")":"td")}),shown:Mn("shown",["<u>shown()</u> True if turtle is shown, false if hidden: <mark>do ht; write shown()</mark>"],function(){var e=this.get(0);return e&&!I(e)}),hidden:Mn("hidden",["<u>hidden()</u> True if turtle is hidden: <mark>do ht; write hidden()</mark>"],function(){var e=this.get(0);return!e||I(e)}),inside:Mn("inside",["<u>inside(obj)</u> True if the turtle is encircled by obj: <mark>inside(window)</mark>"],function(t){if(!t)return!1;if("string"==typeof t&&(t=e(t)),t.jquery){if(!t.length||I(t[0]))return!1;t=t[0]}for(var n,r=D(t),a=null,i=!1,o=!0,s=0;o&&s<this.length;++s){if(n=this[s],H(r,D(n)))return!1;a||(a=ee(t),i=$(a,r)),i&&z(r,D(n))||(o&=ft(n)?ie(n,a):he(a,ee(n)))}return!!o}),touches:Mn("touches",["<u>touches(obj)</u> True if the turtle touches obj: <mark>touches(lastclick)</mark>","<u>touches(color)</u> True if the turtle touches a drawn color: <mark>touches red</mark>"],function(t,n){if(!this.length||I(this[0]))return!1;if("function"==typeof t&&ar(t.helpname)&&(t=t.helpname),"color"==t||ar(t))return st(this[0],"color"==t?null:t);if(e.isNumeric(t)&&e.isNumeric(n)&&(t=[t,n]),e.isArray(t)&&2==t.length&&e.isNumeric(t[0])&&e.isNumeric(t[1])&&(t=V(this[0]||document.body,[t])[0]),!t)return!1;"string"==typeof t&&(t=e(t)),t.jquery||e.isArray(t)||(t=[t]);for(var r,a,i,o,s,l,u=!1,c=0;!u&&c<this.length;++c)if(i=this[c],o=D(i),0!=o.width)for(s=null,r=0;!u&&r<t.length;++r)a=t[r],l=D(a),H(o,l)||(0!=l.width||null!=a.pageX&&null!=a.pageY)&&(s||(s=ee(i)),u|=ft(a)?ie(a,s):ce(s,ee(a)));return!!u}),within:Mn("within",["<u>within(distance, obj)</u> Filters elements to those within distance of obj: <mark>$('.turtle').within(100, lastclick)</mark>"],function(e,t,n){return Ft(this,!0,e,t,n)}),notwithin:Mn("notwithin",["<u>within(distance, obj)</u> Filters elements to those further than distance of obj: <mark>$('.turtle').notwithin(100, lastclick)</mark>"],function(e,t,n){return Ft(this,!1,e,t,n)}),nearest:Mn("nearest",["<u>nearest(obj)</u> Filters elements to those nearest obj<mark>$('.turtle').neareest(lastclick)</mark>"],function(t,n){var r,a,i,o=[],s=1/0;if(r=e.isNumeric(r)&&e.isNumeric(n)?[t,n]:t,e.isArray(r)&&(r=V(this[0]||document.body,[r])[0]),!ft(r))try{r=e(r).pagexy()}catch(l){r=null}for(i=0;i<this.length;i++)if(a=D(this[i]),!o.length||!L(r,s,a)){var u=Z(this[i]),c=r.pageX-u.pageX,h=r.pageY-u.pageY,p=c*c+h*h;s>=p&&(s>p&&(s=p,o.length=0),o.push(this[i]))}return e(o)}),done:An("done",["<u>done(fn)</u> Calls fn when animation is complete. Use with await: <mark>await done defer()</mark>"],function(e){var t=this;return this.promise().done(function(){if(t){var n=t;Ia+=1,setTimeout(function(){Ia-=1,n.promise().done(e)},0)}else e.apply(this,arguments)})}),plan:An("plan",["<u>plan(fn)</u> Runs fn in the animation queue. For planning logic: <mark>write getxy(); fd 50; plan -> write getxy(); bk 50"],function(t,r,a){function i(i,o,s){var l=a?function(){r.apply(e(i),a)}:function(){r.call(e(i),o,i)},u=(s.length&&s[s.length-1],function(){var r=e.queue(this,t),a=[];"inprogress"===r[0]&&a.unshift(r.shift()),e.queue(i,t,a),l(),Array.prototype.push.apply(e.queue(i,t),r),n(i,t)});u.finish=l,e.queue(i,t,u)}e.isFunction(t)&&(a=r,r=t,t="fx");for(var o,s=this.length,l=0;s>l;++l){o=this[l],Un(o,t);var u=e.queue(o,t);u.length?i(o,l,u):a?r.apply(e(o),a):r.call(e(o),l,o)}return this})},li={},ui=0,ci=null,hi=null;Zn(si,"move","slide"),Zn(si,"direct","plan"),Zn(si,"enclosedby","inside"),Zn(si,"bearing","direction"),e.fn.extend(si);var pi="data:image/gif;base64,R0lGODlhKAAwAPIFAAAAAAFsOACSRTCuSICAgP///wAAAAAAACH5BAlkAAYAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAKAAwAAAD72i6zATEgBCAebHpzUnxhDAMAvhxKOoV3ziuZyo3RO26dTbvgXj/gsCO9ysOhENZz+gKJmcUkmA6PSKfSqrWieVtuU+KGNXbXofLEZgR/VHCgdua4isGz9mbmM6U7/94BmlyfUZ1fhqDhYuGgYqMkCOBgo+RfWsNlZZ3ewIpcZaIYaF6XaCkR6aokqqrk0qrqVinpK+fsbZkuK2ouRy0ob4bwJbCibthh6GYebGcY7/EsWqTbdNG1dd9jnXPyk2d38y0Z9Yub2yA6AvWPYk+zEnkv6xdCoPuw/X2gLqy9vJIGAN4b8pAgpQOIlzI8EkCACH5BAlkAAYALAAAAAAoADAAAAPuaLrMBMSAEIB5senNSfGEMAwC+HEo6hXfOK5nKjdE7bp1Nu+BeP+CwI73Kw6EQ1nP6AomZxSSYDo9Ip9KqtaJ5W25Xej3qqGYsdEfZbMcgZXtYpActzLMeLOP6c7f3nVNfEZ7TXSFg4lyZAYBio+LZYiQfHMbc3iTlG9ilGpdjp4ujESiI6RQpqegqkesqqhKrbEpoaa0KLaiuBy6nrxss6+3w7tomo+cDXmBnsoLza2nsb7SN2tl1nyozVOZTJhxysxnd9XYCrrAtT7KQaPruavBo2HQ8xrvffaN+GV5/JbE45fOG8Ek5Q4qXHgwAQA7",fi={click:1,dblclick:1,mouseup:1,mousedown:1,mousemove:1},di=null,gi=[],mi=!1,vi={interrupt:An("interrupt",["<u>interrupt()</u> Interrupts and aborts all turtle commands."],function(n){if("reset"==n)return void(Ra=!1);if("test"==n)return Ra?!1:Ai?!0:e.timers.length?!0:_i.length?!0:Ia?!0:Jn()?!0:e(":animated").length?!0:e(".turtle").filter(function(){return e.queue(this).length>0}).length>0?!0:e(".turtleinput").filter(function(){return!e(this).prop("disabled")}).length>0?!0:Sn()?!0:!1;e(":animated,.turtle").clearQueue().stop(),nn(),e(".turtleinput").prop("disabled",!0),e(t).off(".turtleevent"),e("*").not("#_testpanel *").map(function(t,n){e._data(n,"events",null)}),Ra=!0,xr(null,null),kr();for(var r=e.timers.length-1;r>=0;--r)e.timers[r].anim&&e.timers[r].anim.elem&&e(e.timers[r].anim.elem).stop(!0,!0);var a=n?"'"+n+"'":"";throw new Error("interrupt("+a+") called")}),cs:Tn("cs",["<u>cs()</u> Clear screen. Erases both graphics canvas and body text: <mark>do cs</mark>"],function(){at()}),cg:Tn("cg",["<u>cg()</u> Clear graphics. Does not alter body text: <mark>do cg</mark>"],function(){at("canvas labels")}),ct:Tn("ct",["<u>ct()</u> Clear text. Does not alter graphics canvas: <mark>do ct</mark>"],function(){at("text")}),canvas:An("canvas",["<u>canvas()</u> Returns the raw turtle canvas. <mark>c = canvas().getContext('2d'); c.fillStyle = red; c.fillRect(100,100,200,200)</mark>"],function(){return Ye()}),sizexy:An("sizexy",["<u>sizexy()</u> Get the document pixel [width, height]. <mark>[w, h] = sizexy(); canvas('2d').fillRect(0, 0, w, h)</mark>"],Ee),forever:An("forever",["<u>forever(fn)</u> Calls fn repeatedly, forever. <mark>forever -> fd 2; rt 2</mark>","<u>forever(fps, fn)</u> Calls fn repeating fps per second. <mark>forever 2, -> fd 25; dot blue</mark>"],br),stop:An("stop",["<u>stop()</u> stops the current forever loop. <mark>forever -> fd 10; if not inside window then stop()</mark>","<u>stop(fn)</u> stops the forever loop corresponding to fn.","Use <u>break</u> to stop a <u>for</u> or <u>while</u> loop."],wr),tick:An("tick",["<u>tick(fps, fn)</u> Calls fn fps times per second until <u>tick</u> is called again: <mark>c = 10; tick 1, -> c and write(c--) or tick()</mark>"],function(t,n){if(Jn()){var r=e(di);r.plan(function(){xr(t,n)})}else xr(t,n)}),speed:Tn("speed",["<u>speed(mps)</u> Sets default turtle speed in moves per second: <mark>speed Infinity</mark>"],function(e){Mr(e)}),say:An("say",['<u>say(words)</u> Say something. Use English words.<mark>say "Let\'s go!"</mark>'],function(t){if(di){var n=e(di);n.say.call(n,t)}else{var r=wn(null,"say",arguments,0);r.appear(null),Bn(t,function(){r.resolve(null)}),r.exit()}}),play:An("play",['<u>play(notes)</u> Play notes. Notes are specified in <a href="http://abcnotation.com/" target="_blank">ABC notation</a>.  <mark>play "de[dBFA]2[cGEC]4"</mark>'],function(){if(di){var t=e(di);t.play.apply(t,arguments)}else{var n=wn(null,"play",arguments,0);n.appear(null);var r=Kt(),a=e.makeArray(n.args);a.push(function(){n.resolve(null)}),r.play.apply(r,a),n.exit()}}),tone:An("tone",["<u>tone(freq)</u> Immediately sound a tone. <u>tone(freq, 0)</u> Stop sounding the tone. <u>tone(freq, v, secs)</u> Play a tone with a volume and duration. Frequency may be a number in Hz or a letter pitch. <mark>tone 440, 5</mark>"],function(){if(di){var t=e(di);t.tone.apply(t,arguments)}else{var n=Kt();n.play.apply(n)}}),silence:An("silence",["<u>silence()</u> Immediately silences sound from play() or tone()."],function(){if(di){var t=e(di);t.silence()}else{var n=Kt();n.silence()}}),sync:An("sync",["<u>sync(t1, t2, t3,...)</u> Selected turtles wait for each other to stop."],fn),remove:An("remove",["<u>remove(t)</u> Remove selected turtles."],dn),done:An("done",["<u>done(fn)</u> Calls fn when animation is complete. Use with await: <mark>await done defer()</mark>"],function(t){var n=e(".turtle");return n.promise().done(function(){if(n){var e=n;Ia+=1,setTimeout(function(){Ia-=1,e.promise().done(t)},0)}else t.apply(this,arguments)})}),load:An("load",["<u>load(url, cb)</u> Loads data from the url and passes it to cb. <mark>load 'intro', (t) -> write 'intro contains', t</mark>"],function(t,n){var r;return e.ajax(Xt(t,"load"),{async:!!n,complete:function(a){try{if(r=a.responseObject=JSON.parse(a.responseText),"string"==typeof r.data&&"string"==typeof r.file){if(r=r.data,/\.json(?:$|\?|\#)/.test(t))try{r=JSON.parse(r)}catch(i){}}else e.isArray(r.list)&&"string"==typeof r.directory?r=r.list:r.error&&(r=null)}catch(i){null==r&&a&&a.responseText&&(r=a.responseText)}n&&n(r,a)}}),r}),save:An("save",["<u>save(url, data, cb)</u> Posts data to the url and calls when done. <mark>save 'intro', 'pen gold, 20\\nfd 100\\n'</mark>"],function(t,n,r){if(!t)throw new Error("Missing url for save");var a,i={};if(t=Xt(t,"save"),/\.json(?:$|\?|\#)/.test(t)&&(n=JSON.stringify(n,null,2)),"string"==typeof n||"number"==typeof n)i.data=n;else for(a in n)n.hasOwnProperty(a)&&("string"==typeof n[a]?i[a]=n[a]:i[a]=JSON.stringify(n[a]));if(i&&!i.key){var o=Nt();o&&o.key&&o.user==qt(t)&&(i.key=o.key)}e.ajax(Xt(t,"save"),{type:"POST",data:i,complete:function(e){var t;try{t=JSON.parse(e.responseText)}catch(n){null==t&&e&&e.responseText&&(t=e.responseText)}r&&r(t,e)}})}),append:Tn("append",["<u>append(html)</u> Appends text to the document without a new line. <mark>append 'try this twice...'</mark>"],function(t){e.fn.append.apply(e("body"),arguments)}),type:Tn("type",["<u>type(text)</u> Types preformatted text like a typewriter. <mark>type 'Hello!\n'</mark>"],qr),typebox:Tn("typebox",["<u>typebox(clr)</u> Draws a colored box as typewriter output. <mark>typebox red</mark>"],function(e,t){null!=t||null==e||ar(e)||(t=e,e=null),Xr(e,t)}),typeline:Tn("typebox",["<u>typeline()</u> Same as type '\\n'. <mark>typeline()</mark>"],function(e){qr((e||"")+"\n")}),write:Tn("write",["<u>write(html)</u> Writes a line of text. Arbitrary HTML may be written: <mark>write 'Hello, world!'</mark>"],Yr,function(){return Nr(Array.prototype.join.call(arguments," "),"div")}),read:Tn("read",["<u>read(fn)</u> Reads text or numeric input. Calls fn once: <mark>read (x) -> write x</mark>","<u>read(html, fn)</u> Prompts for input: <mark>read 'Your name?', (v) -> write 'Hello ' + v</mark>"],Yr,function(e,t){
return jr(e,t,0)}),readnum:Tn("readnum",["<u>readnum(html, fn)</u> Reads numeric input. Only numbers allowed: <mark>readnum 'Amount?', (v) -> write 'Tip: ' + (0.15 * v)</mark>"],Yr,function(e,t){return jr(e,t,"number")}),readstr:Tn("readstr",["<u>readstr(html, fn)</u> Reads text input. Never converts input to a number: <mark>readstr 'Enter code', (v) -> write v.length + ' long'</mark>"],Yr,function(e,t){return jr(e,t,"text")}),listen:Tn("listen",["<u>listen(html, fn)</u> Reads voice input, if the browser supports it:<mark>listen 'Say something', (v) -> write v</mark>"],Yr,function(e,t){return jr(e,t,"voice")}),menu:Tn("menu",["<u>menu(map)</u> shows a menu of choices and calls a function based on the user's choice: <mark>menu {A: (-> write 'chose A'), B: (-> write 'chose B')}</mark>"],Yr,Or),button:Tn("button",["<u>button(text, fn)</u> Writes a button. Calls fn whenever the button is clicked: <mark>button 'GO', -> fd 100</mark>"],Yr,Er),table:Tn("table",["<u>table(m, n)</u> Writes m rows and c columns. Access cells using <u>cell</u>: <mark>g = table 8, 8; g.cell(2,3).text 'hello'</mark>","<u>table(array)</u> Writes tabular data. Each nested array is a row: <mark>table [[1,2,3],[4,5,6]]</mark>"],Yr,Ir),img:Tn("img",["<u>img(url)</u> Writes an image with the given address. Any URL can be provided.  A name without slashes will be treated as '/img/name'.<mark>t = img 'tree'</mark>"],Yr,Rr),random:An("random",["<u>random(n)</u> Random non-negative integer less than n: <mark>write random 10</mark>","<u>random(list)</u> Random member of the list: <mark>write random ['a', 'b', 'c']</mark>","<u>random('position')</u> Random page position: <mark>moveto random 'position'</mark>","<u>random('color')</u> Random color: <mark>pen random 'color'</mark>"],yr),rgb:An("rgb",["<u>rgb(r,g,b)</u> Makes a color out of red, green, and blue parts. <mark>pen rgb(150,88,255)</mark>"],function(e,t,n){return Fr("rgb",[Math.max(0,Math.min(255,Math.floor(e))),Math.max(0,Math.min(255,Math.floor(t))),Math.max(0,Math.min(255,Math.floor(n)))])}),hatch:function(t,n){return e(document).hatch(t,n)},rgba:An("rgba",["<u>rgba(r,g,b,a)</u> Makes a color out of red, green, blue, and alpha. <mark>pen rgba(150,88,255,0.5)</mark>"],function(e,t,n,r){return Fr("rgba",[Math.max(0,Math.min(255,Math.floor(e))),Math.max(0,Math.min(255,Math.floor(t))),Math.max(0,Math.min(255,Math.floor(n))),r])}),hsl:An("hsl",["<u>hsl(h,s,l)</u> Makes a color out of hue, saturation, and lightness. <mark>pen hsl(120,0.65,0.75)</mark>"],function(e,t,n){return Fr("hsl",[e,(100*t).toFixed(0)+"%",(100*n).toFixed()+"%"])}),hsla:An("hsla",["<u>hsla(h,s,l,a)</u> Makes a color out of hue, saturation, lightness, alpha. <mark>pen hsla(120,0.65,0.75,0.5)</mark>"],function(e,t,n,r){return Fr("hsla",[e,(100*t).toFixed(0)+"%",(100*n).toFixed(0)+"%",r])}),click:_n("click",["<u>click(fn)</u> Calls fn(event) whenever the mouse is clicked. <mark>click (e) -> moveto e; label 'clicked'</mark>"]),dblclick:_n("dblclick",["<u>dblclick(fn)</u> Calls fn(event) whenever the mouse is double-clicked. <mark>dblclick (e) -> moveto e; label 'double'</mark>"]),mouseup:_n("mouseup",["<u>mouseup(fn)</u> Calls fn(event) whenever the mouse is released. <mark>mouseup (e) -> moveto e; label 'up'</mark>"]),mousedown:_n("mousedown",["<u>mousedown(fn)</u> Calls fn(event) whenever the mouse is pressed. <mark>mousedown (e) -> moveto e; label 'down'</mark>"]),mousemove:_n("mousemove",["<u>mousemove(fn)</u> Calls fn(event) whenever the mouse is moved. <mark>mousemove (e) -> write 'at ', e.x, ',', e.y</mark>"]),keydown:_n("keydown",["<u>keydown(fn)</u> Calls fn(event) whenever a key is pushed down. <mark>keydown (e) -> write 'down ' + e.key</mark>"]),keyup:_n("keyup",["<u>keyup(fn)</u> Calls fn(event) whenever a key is released. <mark>keyup (e) -> write 'up ' + e.key</mark>"]),keypress:_n("keypress",["<u>keypress(fn)</u> Calls fn(event) whenever a character key is pressed. <mark>keypress (e) -> write 'press ' + e.key</mark>"]),send:An("send",["<u>send(name)</u> Sends a message to be received by recv. <mark>send 'go'; recv 'go', -> fd 100</mark>"],function(e){var t=arguments,n=Array.prototype.slice.call(t,1),r=bi.sent[e];r||(r=bi.sent[e]=[]),r.push(n),Kn(e)}),recv:An("recv",["<u>recv(name, fn)</u> Calls fn once when a sent message is received. <mark>recv 'go', (-> fd 100); send 'go'</mark>"],function(e,t){var n=bi.waiting[e];n||(n=bi.waiting[e]=[]),n.push(t),Kn(e)}),abs:An("abs",["<u>abs(x)</u> The absolute value of x. <mark>see abs -5</mark>"],Math.abs),acos:An("acos",["<u>acos(x)</u> Trigonometric arccosine, in radians. <mark>see acos 0.5</mark>"],Math.acos),asin:An("asin",["<u>asin(y)</u> Trigonometric arcsine, in radians. <mark>see asin 0.5</mark>"],Math.asin),atan:An("atan",["<u>atan(y, x = 1)</u> Trigonometric arctangent, in radians. <mark>see atan 0.5</mark>"],function(e,t){return Math.atan2(e,void 0==t?1:t)}),cos:An("cos",["<u>cos(radians)</u> Trigonometric cosine, in radians. <mark>see cos 0</mark>"],Math.cos),sin:An("sin",["<u>sin(radians)</u> Trigonometric sine, in radians. <mark>see sin 0</mark>"],Math.sin),tan:An("tan",["<u>tan(radians)</u> Trigonometric tangent, in radians. <mark>see tan 0</mark>"],Math.tan),acosd:An("acosd",["<u>acosd(x)</u> Trigonometric arccosine, in degrees. <mark>see acosd 0.5</mark>"],function(e){switch(e){case 1:return 0;case.5:return 60;case 0:return 90;case-.5:return 120;case-1:return 180}return 180*Math.acos(e)/Math.PI}),asind:An("asind",["<u>asind(x)</u> Trigonometric arcsine, in degrees. <mark>see asind 0.5</mark>"],function(e){switch(e){case 1:return 90;case.5:return 30;case 0:return 0;case-.5:return-30;case-1:return-90}return 180*Math.asin(e)/Math.PI}),atand:An("atand",["<u>atand(y, x = 1)</u> Trigonometric arctangent, in degrees. <mark>see atand -1, 0/mark>"],function(e,t){return void 0==t&&(t=1),0==e?0==t?NaN:t>0?0:180:0==t?e>0?1/0:-(1/0):Math.abs(e)==Math.abs(t)?e>0?t>0?45:135:t>0?-45:-135:180*Math.atan2(e,t)/Math.PI}),cosd:An("cosd",["<u>cosd(degrees)</u> Trigonometric cosine, in degrees. <mark>see cosd 45</mark>"],function(e){if(e=we(e,360),e%30===0)switch(0>e?e+360:e){case 0:return 1;case 60:return.5;case 90:return 0;case 120:return-.5;case 180:return-1;case 240:return-.5;case 270:return 0;case 300:return.5}return Math.cos(e/180*Math.PI)}),sind:An("sind",["<u>sind(degrees)</u> Trigonometric sine, in degrees. <mark>see sind 45</mark>"],function(e){if(e=we(e,360),e%30===0)switch(0>e?e+360:e){case 0:return 0;case 30:return.5;case 90:return 1;case 150:return.5;case 180:return 0;case 210:return-.5;case 270:return-1;case 330:return-.5}return Math.sin(e/180*Math.PI)}),tand:An("tand",["<u>tand(degrees)</u> Trigonometric tangent, in degrees. <mark>see tand 45</mark>"],function(e){if(e=we(e,360),e%45===0)switch(0>e?e+360:e){case 0:return 0;case 45:return 1;case 90:return 1/0;case 135:return-1;case 180:return 0;case 225:return 1;case 270:return-(1/0);case 315:return-1}return Math.tan(e/180*Math.PI)}),ceil:An("ceil",["<u>ceil(x)</u> Round up. <mark>see ceil 1.9</mark>"],Math.ceil),floor:An("floor",["<u>floor(x)</u> Round down. <mark>see floor 1.9</mark>"],Math.floor),round:An("round",["<u>round(x)</u> Round to the nearest integer. <mark>see round 1.9</mark>"],Math.round),exp:An("exp",["<u>exp(x)</u> Raise e to the power x. <mark>see exp 2</mark>"],Math.exp),ln:An("ln",["<u>ln(x)</u> The natural logarithm of x. <mark>see ln 2</mark>"],Math.log),log10:An("log10",["<u>log10(x)</u> The base 10 logarithm of x. <mark>see log10 0.01</mark>"],function(e){return Ge(Math.log(e)*Math.LOG10E)}),pow:An("pow",["<u>pow(x, y)</u> Raise x to the power y. <mark>see pow 4, 1.5</mark>"],function(e,t){return Ge(Math.pow(e,t))}),sqrt:An("sqrt",["<u>sqrt(x)</u> The square root of x. <mark>see sqrt 25</mark>"],Math.sqrt),max:An("max",["<u>max(x, y, ...)</u> The maximum of a set of values. <mark>see max -5, 2, 1</mark>"],Math.max),min:An("min",["<u>min(x, y, ...)</u> The minimum of a set of values. <mark>see min 2, -5, 1</mark>"],Math.min),Pencil:An("Pencil",["<u>new Pencil(canvas)</u> Make an invisble pencil for drawing on a canvas. <mark>s = new Sprite; p = new Pencil(s); p.pen red; p.fd 100; remove p</mark>"],Qa),Turtle:An("Turtle",["<u>new Turtle(color)</u> Make a new turtle. <mark>t = new Turtle; t.fd 100</mark>"],Ua),Piano:An("Piano",["<u>new Piano(keys)</u> Make a new piano. <mark>t = new Piano 88; t.play 'edcdeee'</mark>"],Va),Webcam:An("Webcam",["<u>new Webcam(options)</u> Make a new webcam. <mark>v = new Webcam; v.plan -> pic = new Sprite v</mark>"],Ga),Sprite:An("Sprite",["<u>new Sprite({width:w,height:h,color:c})</u> Make a new sprite to <mark>drawon</mark>. <mark>s = new Sprite({width:50,height:50,color:blue}); s.fd 100</mark>"],Ba),loadscript:An("loadscript",["<u>loadscript(url, callback)</u> Loads Javascript or Coffeescript from the given URL, calling callback when done."],function(n,r){t.CoffeeScript&&/\.(?:coffee|cs)$/.test(n)?CoffeeScript.load(n,r):e.getScript(n,r)}),pressed:An("pressed",["<u>pressed('control')</u> Tests if a specific key is pressed. <mark>if pressed 'a' then write 'a was pressed'</mark>","<u>pressed.list()</u> Returns a list of pressed keys, by name. <mark>write 'Pressed keys: ' + pressed.list().join(',')</mark>"],Ka),help:mn},yi={finish:{helptext:["<u>finish()</u> Finishes turtle animation. Does not pause for effect: <mark>do finish</mark>"]}},bi={sent:{},waiting:{},pollTimer:null};Zn(vi,"defaultspeed","speed"),vi.save.loginCookie=Nt;var ki={},wi=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","transparent"];!function(){for(var e=["none","erase","path","up","down","color","position","normal","touch"],t=e.concat(wi),n=0;n<t.length;n++)vi.hasOwnProperty(t[n])||(vi[t[n]]=t[n]);vi.PI=Math.PI,vi.E=Math.E,vi.print=vi.write,yi.colors={helptext:["Defined colors: "+wi.join(" ")]},yi.see={helptext:["<u>see(v)</u> Shows the value of v in the test panel: <mark>see document</mark>"]},yi["if"]=yi["else"]=yi.then={helptext:["<u>if</u> <u>then</u> <u>else</u> Tests a condition: <mark>if 1 <= (new Date).getDay() <= 5 then write 'Working hard!' else write 'Happy weekend!'</mark>"]},yi.await=yi.defer={helptext:['<u>await</u> <u>defer</u> Waits for results from an asynchronous event; from <a href="http://maxtaco.github.io/coffee-script/" target="_blank">Iced CoffeeScript</a>: <mark>await readnum defer n</mark>']}}(),e.turtle=function(n,r){var a=!1;if(1==arguments.length&&"object"==typeof n&&n&&!n.hasOwnProperty("length")&&(r=n,n="turtle"),n=n||"turtle",r=r||{},"turtle"in r&&(n=r.turtle),rr(),"htmlscript"in r&&!r.htmlscript||e('script[type="text/html"]').each(function(){e(this).replaceWith(e(this).html().replace(/^\x3c!\[CDATA\[\n?|\]\]\x3e$/g,""))}),!Ha.ctx&&"subpixel"in r&&(Ha.subpixel=parseInt(r.subpixel)),e.turtle.hangtime="hangtime"in r?parseFloat(r.hangtime):2e4,r.events!==!1&&_r(r.eventprefix),r.pressed!==!1&&(Gt(),Ka.enable(!0)),r.see!==!1&&($r(),a=!0,t.addEventListener?t.addEventListener("error",Hi):t.onerror=Hi,t.debug=Hi,Zn(t,"log","debug")),r.queuehide!==!1&&Qn(),r.functions!==!1&&(t.printpage=t.print,e.extend(t,vi)),Mr("defaultspeed"in r?r.defaultspeed:1),en())try{tn()}catch(i){}var o=null,s=!1;if(n&&(o=e("#"+n),o.length||(e("body").length||(document.write("<body>"),s=!0),o=new Ua(n))),o&&!o.length&&(o=null),o&&1===o.length&&r.global!==!1){var l={css:1,fadeIn:1,fadeOut:1,fadeTo:1,fadeToggle:1,animate:1,toggle:1,finish:1,promise:1,direct:1,show:1,hide:1},u=e.extend({},si,l);gi.push.apply(gi,nr(o,u)),di=o[0],o.css({zIndex:1})}if(r.ids!==!1&&(Tr(r.idprefix),o&&n&&(t[n]=o)),r.panel!==!1){var c={title:"test panel (type help for help)",abbreviate:[void 0,ki],consolehook:er};if(o&&c.abbreviate.push(o),r.title&&(c.title=r.title),r.panelheight&&(c.height=r.panelheight),Hi.init(c),a)return t.CoffeeScript?"see.init(eval(see.cs))":Hi.here}return e("#"+n)},e.extend(e.turtle,vi),e.turtle.colors=wi;e.cleanData;e.cleanData=function(n){for(var r,a=0;void 0!==(r=n[a]);a++){var i=e.data(r,"turtleData");i&&i.stream&&i.stream.stop(),r.id&&t[r.id]&&t[r.id].jquery&&1===t[r.id].length&&t[r.id][0]===r&&delete t[r.id],r===di&&rr()}};var xi={},Mi={turtle:function(e){return e||(e="mediumseagreen"),{url:sr(e),css:{width:20,height:24,transformOrigin:"10px 13px",turtleHull:"-8 -5 -8 6 -2 -13 2 -13 8 6 8 -5 0 9",opacity:.67,backgroundImage:"url("+pi+")",backgroundSize:"cover"}}},pointer:function(e){return e||(e="gray"),{url:lr(e),css:{width:20,height:24,transformOrigin:"10px 18px",turtleHull:"-10 6 0 -18 10 6",opacity:.67}}},radius:function(e){return e||(e="gray"),{url:ur(e),css:{width:20,height:20,transformOrigin:"10px 10px",turtleHull:"-10 0 -7 7 0 10 7 7 10 0 7 -7 0 -10 -7 -7",opacity:1}}},dot:function(e){return e||(e="black"),{url:cr(e,24),css:{width:12,height:12,transformOrigin:"6px 6px",turtleHull:"-6 0 -4 4 0 6 4 4 6 0 4 -4 0 -6 -4 -4",opacity:1}}},point:function(e){return e||(e="black"),{url:cr(e,6),css:{width:3,height:3,transformOrigin:"1.5px 1.5px",turtleHull:"-1.5 0 -1 1 0 1.5 1 1 1.5 0 1 -1 0 -1.5 -1 -1",opacity:1}}},pencil:function(e){return e||(e="dodgerblue"),{url:hr(e),css:{width:20,height:24,transformOrigin:"10px 24px",turtleHull:"0 0 -3 -6 -3 -24 3 -6 3 -24",opacity:1}}}},Ti={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},_i=[],Si=[],Ai=null,Ci=0,Pi=null,qi={autoScrollTimer:null,bottomSeen:0},Xi="data:image/svg+xml,<svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20260%20400%22><path%20d=%22M180,210c0,26-22,48-48,48h-12c-26,0-48-22-48-48v-138c0-26,22-48,48-48h12c26,0,48,22,48,48zm51,-31h-9c-5,0-9,4-9,9v8c0,50-37,91-87,91c-50,0-87-41-87-91v-8c0-5-4-9-9-9h-9c-5,0-9,4-9,9v8c0,59,40,107,96,116v37h-34c-5,0-9,4-9,9v18c0,5,4,9,9,9h105c5,0,9-4,9-9v-18c0-5-5-9-9-9h-34v-37c56-9,96-58,96-116v-8c0-5-4-9-9-9%22/></svg>",Yi={init:function(){if(!this.ide){try{parent&&parent.ide&&parent.ide.bindframe&&parent.ide.bindframe(t,parent)&&(this.ide=parent.ide,this.attached=!0)}catch(e){}this.attached&&t.addEventListener&&t.addEventListener("error",function(e){Yi.reportEvent("error",[e])})}},attached:!1,ide:null,reportEvent:function(e,t){this.ide&&this.ide.reportEvent(e,t)},nextId:function(){return this.ide?this.ide.nextId():0}};Yi.init(),function(){function n(e){return e.toFixed(1).replace(/\.0$/,"")}function r(e){return'<code style="font-weight:bold;color:blue">'+e+"</code>"}function a(t,n){return t&&(t=t.get(0))&&n&&n.target&&(t==n.target||e.contains(t,n.target))}if(Yi.ide){var i,o,s,l,u=e("<samp>").css({position:"fixed",zIndex:1e6-1,fontFamily:"sans-serif",display:"none",background:"#ff8",border:"1px solid dimgray",padding:"1px",cursor:"move",fontSize:12}).appendTo("body"),c=null,h=null,p=null,f=0,d=0,g=0,m=0;e(t).on("mousedown mouseup mousemove keydown",function(v){if("keydown"==v.type){if(v.which<27)return;h&&h.remove(),h=c=p=null}if("mousedown"==v.type)if(h)if(p)h&&h.remove(),h=c=p=null;else if(c)h.css({cursor:"default"}),p=v;else{e.turtle.interrupt("reset");var y=e(".turtle").within("touch",v);c=y.length?y.eq(0):v}else if(a(u,v)){var b=Ee();p=c=null,h=e('<canvas width="'+b[0]+'" height="'+b[1]+'">').css({position:"absolute",top:0,left:0,cursor:"crosshair",zIndex:1e6}).appendTo("body")}if(h){var k,w,x,M,T,_,S=h.canvas(),A=S.getContext("2d"),C=!1,P=p||v;if(c&&"function"==typeof c.pagexy){var q=c.getxy(),X=c.pagexy();X.x=q[0],X.y=q[1],C=!0,T=c.direction(),k=["getxy is "+n(X.x)+", "+n(X.y),"direction is "+n(T)]}else X=c||P,k=[r("moveto "+n(X.x)+", "+n(X.y))];if(k.unshift(p?'<span style="color:green">click to close</span>':c?'<span style="color:red">click to measure</span>':'<span style="color:red">click on point</span>'),w=P.x-X.x,x=P.y-X.y,M=Math.sqrt(w*w+x*x),_=Math.atan2(w,x)/Math.PI*180,c){if(A.save(),A.clearRect(f-10,d-10,g-f+20,m-d+20),f=g=X.pageX,d=m=X.pageY,A.fillStyle="red",A.beginPath(),A.arc(X.pageX,X.pageY,4,0,2*Math.PI,!1),A.closePath(),A.fill(),M>0){if(C){A.strokeStyle="black",A.fillStyle="black",s=(T-90)/180*Math.PI,l=(_-90)/180*Math.PI,i=X.pageX+100*Math.cos(s),o=X.pageY+100*Math.sin(s),$n(A,2,X.pageX,X.pageY,i,o),f=Math.min(i,f),d=Math.min(o,d),g=Math.max(i,g),m=Math.max(o,m);var Y=(360+_-T)%360;A.beginPath(),180>=Y?(k.push(r("rt "+n(Y))),M>=20&&A.arc(X.pageX,X.pageY,20,s,l)):(k.push(r("lt "+n(360-Y))),M>=20&&A.arc(X.pageX,X.pageY,20,l,s)),A.stroke(),f=Math.min(X.pageX-20,f),d=Math.min(X.pageY-20,d),g=Math.max(X.pageX+20,g),m=Math.max(X.pageY+20,m)}else k.push(r("turnto "+n(_)));k.push(r("fd "+n(M))),k.push("end at "+n(P.x)+", "+n(P.y)),A.strokeStyle="red",A.fillStyle="red",$n(A,2,X.pageX,X.pageY,P.pageX,P.pageY),f=Math.min(P.pageX,f),d=Math.min(P.pageY,d),g=Math.max(P.pageX,g),m=Math.max(P.pageY,m)}A.restore()}u.css({left:0,top:0}).html(k.join("<br>")).show();var N={left:"",top:"",right:"",bottom:""};P.pageX+5<X.pageX?N.left=Math.max(P.pageX-e(t).scrollLeft()-u.outerWidth()-5,2):N.left=Math.min(P.pageX-e(t).scrollLeft()+5,e(document).width()-u.outerWidth()-2),P.pageY+5<X.pageY?N.top=Math.max(P.pageY-e(t).scrollTop()-u.outerHeight()-5,2):N.top=Math.min(P.pageY-e(t).scrollTop()+5,e(document).height()-u.outerHeight()-2),u.css(N)}else k=[],a(u,v)&&k.push('<span style="color:red">click to use</span>'),null!=v.x&&k.push(v.x+", "+v.y),u.html(k.join("<br>")).css({left:"",top:"",right:0,bottom:0}).show()})}}();var Ni=null,Oi="see",Ei="0.2",ji=Br(Oi),Ri="position:relative;display:block;font-family:monospace;font-size:16px;word-break:break-all;margin-bottom:3px;padding-left:1em;",Ii=5,Fi=!1,Di="body",Li="auto";try{t.self!==t.top&&screen.width>=800&&screen.height>=600&&parent&&parent.ide&&(Li=parent.ide.getOptions().panel)}catch(Wi){}var Hi,zi=Li,$i="",Bi=null,Qi="_loghistory",Ui=50,Gi="",Vi={"":{e:t.eval,t:t},top:{e:t.eval,t:t}},Zi=t.CoffeeScript,Ji="(function(){return eval(arguments[0]);})",Ki="[_$a-zA-Z-][_$a-zA-Z0-9-]*",eo=new RegExp("^\\s*var\\s+(?:"+Ki+"\\s*,\\s*)*"+Ki+"\\s*;\\s*"),to="input._log:focus{outline:none;}samp._logcaret{position:absolute;left:0;font-size:120%;}samp._logcaret:before{content: '>'}label._log > span:first-of-type:hover{text-decoration:underline;}samp._log > label._log,samp_.log > span > label._log{display:inline-block;vertical-align:top;}label._log > span:first-of-type{margin-left:2em;text-indent:-1em;}label._log > ul{display:none;padding-left:14px;margin:0;}label._log > span:before{content:'';font-size:70%;font-style:normal;display:inline-block;width:0;text-align:center;}label._log > span:first-of-type:before{content:'\\0025B6';}label._log > ul > li{display:block;white-space:pre-line;margin-left:2em;text-indent:-1em}label._log > ul > li > samp{margin-left:-1em;text-indent:0;white-space:pre;}label._log > input[type=checkbox]:checked ~ span{margin-left:2em;text-indent:-1em;}label._log > input[type=checkbox]:checked ~ span:first-of-type:before{content:'\\0025BC';}label._log > input[type=checkbox]:checked ~ span:before{content:'';}label._log,label._log > input[type=checkbox]:checked ~ ul{display:block;}label._log > span:first-of-type,label._log > input[type=checkbox]:checked ~ span{display:inline-block;}label._log > input[type=checkbox],label._log > input[type=checkbox]:checked ~ span > span{display:none;}",no=!1,ro={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\x0B":"\\v","'":"\\'",'"':'\\"',"\\":"\\\\"},ao=null,io=[];Hi=function(){Bi&&"function"==typeof Bi.log&&Bi.log.apply(t.console,arguments);var e=Array.prototype.slice.call(arguments);for(io.push('<samp class="_log">');e.length;){var n=e.shift();"String"==Zr(n)?io.push(ua(n)):io.push(fa(n,Ii,io)),e.length&&io.push(" ")}io.push("</samp>"),ma()};var oo=!1,so=!1,lo=null,uo=[{}.undefined],co=null,ho=null}}},{}],2:[function(e,t,n){t.exports=function(){if(null==window.jQuery)throw new Error("jQuery was not found");e("./jquery-turtle")(window.jQuery,window)}},{"./jquery-turtle":1}]},{},[2])(2)});